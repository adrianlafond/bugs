"use strict";(()=>{var lp=Object.create;var Ga=Object.defineProperty;var cp=Object.getOwnPropertyDescriptor;var up=Object.getOwnPropertyNames;var dp=Object.getPrototypeOf,fp=Object.prototype.hasOwnProperty;var mt=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),pp=(e,t)=>{for(var r in t)Ga(e,r,{get:t[r],enumerable:!0})},mp=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of up(t))!fp.call(e,s)&&s!==r&&Ga(e,s,{get:()=>t[s],enumerable:!(i=cp(t,s))||i.enumerable});return e};var xt=(e,t,r)=>(r=e!=null?lp(dp(e)):{},mp(t||!e||!e.__esModule?Ga(r,"default",{value:e,enumerable:!0}):r,e));var hc=mt((oy,za)=>{"use strict";var _p=Object.prototype.hasOwnProperty,ae="~";function Ss(){}Object.create&&(Ss.prototype=Object.create(null),new Ss().__proto__||(ae=!1));function yp(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function ac(e,t,r,i,s){if(typeof r!="function")throw new TypeError("The listener must be a function");var n=new yp(r,i||e,s),o=ae?ae+t:t;return e._events[o]?e._events[o].fn?e._events[o]=[e._events[o],n]:e._events[o].push(n):(e._events[o]=n,e._eventsCount++),e}function ro(e,t){--e._eventsCount===0?e._events=new Ss:delete e._events[t]}function te(){this._events=new Ss,this._eventsCount=0}te.prototype.eventNames=function(){var t=[],r,i;if(this._eventsCount===0)return t;for(i in r=this._events)_p.call(r,i)&&t.push(ae?i.slice(1):i);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(r)):t};te.prototype.listeners=function(t){var r=ae?ae+t:t,i=this._events[r];if(!i)return[];if(i.fn)return[i.fn];for(var s=0,n=i.length,o=new Array(n);s<n;s++)o[s]=i[s].fn;return o};te.prototype.listenerCount=function(t){var r=ae?ae+t:t,i=this._events[r];return i?i.fn?1:i.length:0};te.prototype.emit=function(t,r,i,s,n,o){var a=ae?ae+t:t;if(!this._events[a])return!1;var h=this._events[a],l=arguments.length,c,u;if(h.fn){switch(h.once&&this.removeListener(t,h.fn,void 0,!0),l){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,r),!0;case 3:return h.fn.call(h.context,r,i),!0;case 4:return h.fn.call(h.context,r,i,s),!0;case 5:return h.fn.call(h.context,r,i,s,n),!0;case 6:return h.fn.call(h.context,r,i,s,n,o),!0}for(u=1,c=new Array(l-1);u<l;u++)c[u-1]=arguments[u];h.fn.apply(h.context,c)}else{var d=h.length,f;for(u=0;u<d;u++)switch(h[u].once&&this.removeListener(t,h[u].fn,void 0,!0),l){case 1:h[u].fn.call(h[u].context);break;case 2:h[u].fn.call(h[u].context,r);break;case 3:h[u].fn.call(h[u].context,r,i);break;case 4:h[u].fn.call(h[u].context,r,i,s);break;default:if(!c)for(f=1,c=new Array(l-1);f<l;f++)c[f-1]=arguments[f];h[u].fn.apply(h[u].context,c)}}return!0};te.prototype.on=function(t,r,i){return ac(this,t,r,i,!1)};te.prototype.once=function(t,r,i){return ac(this,t,r,i,!0)};te.prototype.removeListener=function(t,r,i,s){var n=ae?ae+t:t;if(!this._events[n])return this;if(!r)return ro(this,n),this;var o=this._events[n];if(o.fn)o.fn===r&&(!s||o.once)&&(!i||o.context===i)&&ro(this,n);else{for(var a=0,h=[],l=o.length;a<l;a++)(o[a].fn!==r||s&&!o[a].once||i&&o[a].context!==i)&&h.push(o[a]);h.length?this._events[n]=h.length===1?h[0]:h:ro(this,n)}return this};te.prototype.removeAllListeners=function(t){var r;return t?(r=ae?ae+t:t,this._events[r]&&ro(this,r)):(this._events=new Ss,this._eventsCount=0),this};te.prototype.off=te.prototype.removeListener;te.prototype.addListener=te.prototype.on;te.prefixed=ae;te.EventEmitter=te;typeof za<"u"&&(za.exports=te)});var fc=mt((ay,Ya)=>{"use strict";Ya.exports=no;Ya.exports.default=no;function no(e,t,r){r=r||2;var i=t&&t.length,s=i?t[0]*r:e.length,n=cc(e,0,s,r,!0),o=[];if(!n||n.next===n.prev)return o;var a,h,l,c,u,d,f;if(i&&(n=Ep(e,t,n,r)),e.length>80*r){a=l=e[0],h=c=e[1];for(var p=r;p<s;p+=r)u=e[p],d=e[p+1],u<a&&(a=u),d<h&&(h=d),u>l&&(l=u),d>c&&(c=d);f=Math.max(l-a,c-h),f=f!==0?32767/f:0}return As(n,o,r,a,h,f,0),o}function cc(e,t,r,i,s){var n,o;if(s===ja(e,t,r,i)>0)for(n=t;n<r;n+=i)o=lc(n,e[n],e[n+1],o);else for(n=r-i;n>=t;n-=i)o=lc(n,e[n],e[n+1],o);return o&&oo(o,o.next)&&(Is(o),o=o.next),o}function Jr(e,t){if(!e)return e;t||(t=e);var r=e,i;do if(i=!1,!r.steiner&&(oo(r,r.next)||vt(r.prev,r,r.next)===0)){if(Is(r),r=t=r.prev,r===r.next)break;i=!0}else r=r.next;while(i||r!==t);return t}function As(e,t,r,i,s,n,o){if(e){!o&&n&&Rp(e,i,s,n);for(var a=e,h,l;e.prev!==e.next;){if(h=e.prev,l=e.next,n?bp(e,i,s,n):vp(e)){t.push(h.i/r|0),t.push(e.i/r|0),t.push(l.i/r|0),Is(e),e=l.next,a=l.next;continue}if(e=l,e===a){o?o===1?(e=Tp(Jr(e),t,r),As(e,t,r,i,s,n,2)):o===2&&wp(e,t,r,i,s,n):As(Jr(e),t,r,i,s,n,1);break}}}}function vp(e){var t=e.prev,r=e,i=e.next;if(vt(t,r,i)>=0)return!1;for(var s=t.x,n=r.x,o=i.x,a=t.y,h=r.y,l=i.y,c=s<n?s<o?s:o:n<o?n:o,u=a<h?a<l?a:l:h<l?h:l,d=s>n?s>o?s:o:n>o?n:o,f=a>h?a>l?a:l:h>l?h:l,p=i.next;p!==t;){if(p.x>=c&&p.x<=d&&p.y>=u&&p.y<=f&&Ii(s,a,n,h,o,l,p.x,p.y)&&vt(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function bp(e,t,r,i){var s=e.prev,n=e,o=e.next;if(vt(s,n,o)>=0)return!1;for(var a=s.x,h=n.x,l=o.x,c=s.y,u=n.y,d=o.y,f=a<h?a<l?a:l:h<l?h:l,p=c<u?c<d?c:d:u<d?u:d,g=a>h?a>l?a:l:h>l?h:l,_=c>u?c>d?c:d:u>d?u:d,y=Wa(f,p,t,r,i),T=Wa(g,_,t,r,i),x=e.prevZ,v=e.nextZ;x&&x.z>=y&&v&&v.z<=T;){if(x.x>=f&&x.x<=g&&x.y>=p&&x.y<=_&&x!==s&&x!==o&&Ii(a,c,h,u,l,d,x.x,x.y)&&vt(x.prev,x,x.next)>=0||(x=x.prevZ,v.x>=f&&v.x<=g&&v.y>=p&&v.y<=_&&v!==s&&v!==o&&Ii(a,c,h,u,l,d,v.x,v.y)&&vt(v.prev,v,v.next)>=0))return!1;v=v.nextZ}for(;x&&x.z>=y;){if(x.x>=f&&x.x<=g&&x.y>=p&&x.y<=_&&x!==s&&x!==o&&Ii(a,c,h,u,l,d,x.x,x.y)&&vt(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;v&&v.z<=T;){if(v.x>=f&&v.x<=g&&v.y>=p&&v.y<=_&&v!==s&&v!==o&&Ii(a,c,h,u,l,d,v.x,v.y)&&vt(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function Tp(e,t,r){var i=e;do{var s=i.prev,n=i.next.next;!oo(s,n)&&uc(s,i,i.next,n)&&Ps(s,n)&&Ps(n,s)&&(t.push(s.i/r|0),t.push(i.i/r|0),t.push(n.i/r|0),Is(i),Is(i.next),i=e=n),i=i.next}while(i!==e);return Jr(i)}function wp(e,t,r,i,s,n){var o=e;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&Bp(o,a)){var h=dc(o,a);o=Jr(o,o.next),h=Jr(h,h.next),As(o,t,r,i,s,n,0),As(h,t,r,i,s,n,0);return}a=a.next}o=o.next}while(o!==e)}function Ep(e,t,r,i){var s=[],n,o,a,h,l;for(n=0,o=t.length;n<o;n++)a=t[n]*i,h=n<o-1?t[n+1]*i:e.length,l=cc(e,a,h,i,!1),l===l.next&&(l.steiner=!0),s.push(Mp(l));for(s.sort(Sp),n=0;n<s.length;n++)r=Ap(s[n],r);return r}function Sp(e,t){return e.x-t.x}function Ap(e,t){var r=Pp(e,t);if(!r)return t;var i=dc(r,e);return Jr(i,i.next),Jr(r,r.next)}function Pp(e,t){var r=t,i=e.x,s=e.y,n=-1/0,o;do{if(s<=r.y&&s>=r.next.y&&r.next.y!==r.y){var a=r.x+(s-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=i&&a>n&&(n=a,o=r.x<r.next.x?r:r.next,a===i))return o}r=r.next}while(r!==t);if(!o)return null;var h=o,l=o.x,c=o.y,u=1/0,d;r=o;do i>=r.x&&r.x>=l&&i!==r.x&&Ii(s<c?i:n,s,l,c,s<c?n:i,s,r.x,r.y)&&(d=Math.abs(s-r.y)/(i-r.x),Ps(r,e)&&(d<u||d===u&&(r.x>o.x||r.x===o.x&&Ip(o,r)))&&(o=r,u=d)),r=r.next;while(r!==h);return o}function Ip(e,t){return vt(e.prev,e,t.prev)<0&&vt(t.next,e,e.next)<0}function Rp(e,t,r,i){var s=e;do s.z===0&&(s.z=Wa(s.x,s.y,t,r,i)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==e);s.prevZ.nextZ=null,s.prevZ=null,Cp(s)}function Cp(e){var t,r,i,s,n,o,a,h,l=1;do{for(r=e,e=null,n=null,o=0;r;){for(o++,i=r,a=0,t=0;t<l&&(a++,i=i.nextZ,!!i);t++);for(h=l;a>0||h>0&&i;)a!==0&&(h===0||!i||r.z<=i.z)?(s=r,r=r.nextZ,a--):(s=i,i=i.nextZ,h--),n?n.nextZ=s:e=s,s.prevZ=n,n=s;r=i}n.nextZ=null,l*=2}while(o>1);return e}function Wa(e,t,r,i,s){return e=(e-r)*s|0,t=(t-i)*s|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function Mp(e){var t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function Ii(e,t,r,i,s,n,o,a){return(s-o)*(t-a)>=(e-o)*(n-a)&&(e-o)*(i-a)>=(r-o)*(t-a)&&(r-o)*(n-a)>=(s-o)*(i-a)}function Bp(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!Dp(e,t)&&(Ps(e,t)&&Ps(t,e)&&Op(e,t)&&(vt(e.prev,e,t.prev)||vt(e,t.prev,t))||oo(e,t)&&vt(e.prev,e,e.next)>0&&vt(t.prev,t,t.next)>0)}function vt(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function oo(e,t){return e.x===t.x&&e.y===t.y}function uc(e,t,r,i){var s=so(vt(e,t,r)),n=so(vt(e,t,i)),o=so(vt(r,i,e)),a=so(vt(r,i,t));return!!(s!==n&&o!==a||s===0&&io(e,r,t)||n===0&&io(e,i,t)||o===0&&io(r,e,i)||a===0&&io(r,t,i))}function io(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function so(e){return e>0?1:e<0?-1:0}function Dp(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&uc(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function Ps(e,t){return vt(e.prev,e,e.next)<0?vt(e,t,e.next)>=0&&vt(e,e.prev,t)>=0:vt(e,t,e.prev)<0||vt(e,e.next,t)<0}function Op(e,t){var r=e,i=!1,s=(e.x+t.x)/2,n=(e.y+t.y)/2;do r.y>n!=r.next.y>n&&r.next.y!==r.y&&s<(r.next.x-r.x)*(n-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next;while(r!==e);return i}function dc(e,t){var r=new $a(e.i,e.x,e.y),i=new $a(t.i,t.x,t.y),s=e.next,n=t.prev;return e.next=t,t.prev=e,r.next=s,s.prev=r,i.next=r,r.prev=i,n.next=i,i.prev=n,i}function lc(e,t,r,i){var s=new $a(e,t,r);return i?(s.next=i.next,s.prev=i,i.next.prev=s,i.next=s):(s.prev=s,s.next=s),s}function Is(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function $a(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}no.deviation=function(e,t,r,i){var s=t&&t.length,n=s?t[0]*r:e.length,o=Math.abs(ja(e,0,n,r));if(s)for(var a=0,h=t.length;a<h;a++){var l=t[a]*r,c=a<h-1?t[a+1]*r:e.length;o-=Math.abs(ja(e,l,c,r))}var u=0;for(a=0;a<i.length;a+=3){var d=i[a]*r,f=i[a+1]*r,p=i[a+2]*r;u+=Math.abs((e[d]-e[p])*(e[f+1]-e[d+1])-(e[d]-e[f])*(e[p+1]-e[d+1]))}return o===0&&u===0?0:Math.abs((u-o)/o)};function ja(e,t,r,i){for(var s=0,n=t,o=r-i;n<r;n+=i)s+=(e[o]-e[n])*(e[n+1]+e[o+1]),o=n;return s}no.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},i=0,s=0;s<e.length;s++){for(var n=0;n<e[s].length;n++)for(var o=0;o<t;o++)r.vertices.push(e[s][n][o]);s>0&&(i+=e[s-1].length,r.holes.push(i))}return r}});var pc=mt((Ri,Ci)=>{(function(e){var t=typeof Ri=="object"&&Ri&&!Ri.nodeType&&Ri,r=typeof Ci=="object"&&Ci&&!Ci.nodeType&&Ci,i=typeof global=="object"&&global;(i.global===i||i.window===i||i.self===i)&&(e=i);var s,n=2147483647,o=36,a=1,h=26,l=38,c=700,u=72,d=128,f="-",p=/^xn--/,g=/[^\x20-\x7E]/,_=/[\x2E\u3002\uFF0E\uFF61]/g,y={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},T=o-a,x=Math.floor,v=String.fromCharCode,N;function k(G){throw new RangeError(y[G])}function B(G,m){for(var b=G.length,E=[];b--;)E[b]=m(G[b]);return E}function R(G,m){var b=G.split("@"),E="";b.length>1&&(E=b[0]+"@",G=b[1]),G=G.replace(_,".");var M=G.split("."),D=B(M,m).join(".");return E+D}function U(G){for(var m=[],b=0,E=G.length,M,D;b<E;)M=G.charCodeAt(b++),M>=55296&&M<=56319&&b<E?(D=G.charCodeAt(b++),(D&64512)==56320?m.push(((M&1023)<<10)+(D&1023)+65536):(m.push(M),b--)):m.push(M);return m}function C(G){return B(G,function(m){var b="";return m>65535&&(m-=65536,b+=v(m>>>10&1023|55296),m=56320|m&1023),b+=v(m),b}).join("")}function F(G){return G-48<10?G-22:G-65<26?G-65:G-97<26?G-97:o}function K(G,m){return G+22+75*(G<26)-((m!=0)<<5)}function A(G,m,b){var E=0;for(G=b?x(G/c):G>>1,G+=x(G/m);G>T*h>>1;E+=o)G=x(G/T);return x(E+(T+1)*G/(G+l))}function I(G){var m=[],b=G.length,E,M=0,D=d,X=u,Z,J,nt,ot,at,wt,At,Pt,qt;for(Z=G.lastIndexOf(f),Z<0&&(Z=0),J=0;J<Z;++J)G.charCodeAt(J)>=128&&k("not-basic"),m.push(G.charCodeAt(J));for(nt=Z>0?Z+1:0;nt<b;){for(ot=M,at=1,wt=o;nt>=b&&k("invalid-input"),At=F(G.charCodeAt(nt++)),(At>=o||At>x((n-M)/at))&&k("overflow"),M+=At*at,Pt=wt<=X?a:wt>=X+h?h:wt-X,!(At<Pt);wt+=o)qt=o-Pt,at>x(n/qt)&&k("overflow"),at*=qt;E=m.length+1,X=A(M-ot,E,ot==0),x(M/E)>n-D&&k("overflow"),D+=x(M/E),M%=E,m.splice(M++,0,D)}return C(m)}function it(G){var m,b,E,M,D,X,Z,J,nt,ot,at,wt=[],At,Pt,qt,Zr;for(G=U(G),At=G.length,m=d,b=0,D=u,X=0;X<At;++X)at=G[X],at<128&&wt.push(v(at));for(E=M=wt.length,M&&wt.push(f);E<At;){for(Z=n,X=0;X<At;++X)at=G[X],at>=m&&at<Z&&(Z=at);for(Pt=E+1,Z-m>x((n-b)/Pt)&&k("overflow"),b+=(Z-m)*Pt,m=Z,X=0;X<At;++X)if(at=G[X],at<m&&++b>n&&k("overflow"),at==m){for(J=b,nt=o;ot=nt<=D?a:nt>=D+h?h:nt-D,!(J<ot);nt+=o)Zr=J-ot,qt=o-ot,wt.push(v(K(ot+Zr%qt,0))),J=x(Zr/qt);wt.push(v(K(J,0))),D=A(b,Pt,E==M),b=0,++E}++b,++m}return wt.join("")}function Y(G){return R(G,function(m){return p.test(m)?I(m.slice(4).toLowerCase()):m})}function et(G){return R(G,function(m){return g.test(m)?"xn--"+it(m):m})}if(s={version:"1.4.1",ucs2:{decode:U,encode:C},decode:I,encode:it,toASCII:et,toUnicode:Y},typeof define=="function"&&typeof define.amd=="object"&&define.amd)define("punycode",function(){return s});else if(t&&r)if(Ci.exports==t)r.exports=s;else for(N in s)s.hasOwnProperty(N)&&(t[N]=s[N]);else e.punycode=s})(Ri)});var gc=mt((hy,mc)=>{"use strict";mc.exports=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},r=Symbol("test"),i=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(i)!=="[object Symbol]")return!1;var s=42;t[r]=s;for(r in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var n=Object.getOwnPropertySymbols(t);if(n.length!==1||n[0]!==r||!Object.prototype.propertyIsEnumerable.call(t,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(t,r);if(o.value!==s||o.enumerable!==!0)return!1}return!0}});var yc=mt((ly,_c)=>{"use strict";var xc=typeof Symbol<"u"&&Symbol,Fp=gc();_c.exports=function(){return typeof xc!="function"||typeof Symbol!="function"||typeof xc("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:Fp()}});var Tc=mt((cy,bc)=>{"use strict";var vc={foo:{}},Lp=Object;bc.exports=function(){return{__proto__:vc}.foo===vc.foo&&!({__proto__:null}instanceof Lp)}});var Ec=mt((uy,wc)=>{"use strict";var Np="Function.prototype.bind called on incompatible ",qa=Array.prototype.slice,Up=Object.prototype.toString,Gp="[object Function]";wc.exports=function(t){var r=this;if(typeof r!="function"||Up.call(r)!==Gp)throw new TypeError(Np+r);for(var i=qa.call(arguments,1),s,n=function(){if(this instanceof s){var c=r.apply(this,i.concat(qa.call(arguments)));return Object(c)===c?c:this}else return r.apply(t,i.concat(qa.call(arguments)))},o=Math.max(0,r.length-i.length),a=[],h=0;h<o;h++)a.push("$"+h);if(s=Function("binder","return function ("+a.join(",")+"){ return binder.apply(this,arguments); }")(n),r.prototype){var l=function(){};l.prototype=r.prototype,s.prototype=new l,l.prototype=null}return s}});var ao=mt((dy,Sc)=>{"use strict";var kp=Ec();Sc.exports=Function.prototype.bind||kp});var Pc=mt((fy,Ac)=>{"use strict";var Hp=ao();Ac.exports=Hp.call(Function.call,Object.prototype.hasOwnProperty)});var co=mt((py,Bc)=>{"use strict";var ht,Oi=SyntaxError,Mc=Function,Di=TypeError,Ka=function(e){try{return Mc('"use strict"; return ('+e+").constructor;")()}catch{}},Qr=Object.getOwnPropertyDescriptor;if(Qr)try{Qr({},"")}catch{Qr=null}var Za=function(){throw new Di},Xp=Qr?function(){try{return arguments.callee,Za}catch{try{return Qr(arguments,"callee").get}catch{return Za}}}():Za,Mi=yc()(),Vp=Tc()(),Ht=Object.getPrototypeOf||(Vp?function(e){return e.__proto__}:null),Bi={},zp=typeof Uint8Array>"u"||!Ht?ht:Ht(Uint8Array),ti={"%AggregateError%":typeof AggregateError>"u"?ht:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?ht:ArrayBuffer,"%ArrayIteratorPrototype%":Mi&&Ht?Ht([][Symbol.iterator]()):ht,"%AsyncFromSyncIteratorPrototype%":ht,"%AsyncFunction%":Bi,"%AsyncGenerator%":Bi,"%AsyncGeneratorFunction%":Bi,"%AsyncIteratorPrototype%":Bi,"%Atomics%":typeof Atomics>"u"?ht:Atomics,"%BigInt%":typeof BigInt>"u"?ht:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?ht:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?ht:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?ht:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?ht:Float32Array,"%Float64Array%":typeof Float64Array>"u"?ht:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?ht:FinalizationRegistry,"%Function%":Mc,"%GeneratorFunction%":Bi,"%Int8Array%":typeof Int8Array>"u"?ht:Int8Array,"%Int16Array%":typeof Int16Array>"u"?ht:Int16Array,"%Int32Array%":typeof Int32Array>"u"?ht:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Mi&&Ht?Ht(Ht([][Symbol.iterator]())):ht,"%JSON%":typeof JSON=="object"?JSON:ht,"%Map%":typeof Map>"u"?ht:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Mi||!Ht?ht:Ht(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?ht:Promise,"%Proxy%":typeof Proxy>"u"?ht:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?ht:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?ht:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Mi||!Ht?ht:Ht(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?ht:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Mi&&Ht?Ht(""[Symbol.iterator]()):ht,"%Symbol%":Mi?Symbol:ht,"%SyntaxError%":Oi,"%ThrowTypeError%":Xp,"%TypedArray%":zp,"%TypeError%":Di,"%Uint8Array%":typeof Uint8Array>"u"?ht:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?ht:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?ht:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?ht:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?ht:WeakMap,"%WeakRef%":typeof WeakRef>"u"?ht:WeakRef,"%WeakSet%":typeof WeakSet>"u"?ht:WeakSet};if(Ht)try{null.error}catch(e){Ic=Ht(Ht(e)),ti["%Error.prototype%"]=Ic}var Ic,Wp=function e(t){var r;if(t==="%AsyncFunction%")r=Ka("async function () {}");else if(t==="%GeneratorFunction%")r=Ka("function* () {}");else if(t==="%AsyncGeneratorFunction%")r=Ka("async function* () {}");else if(t==="%AsyncGenerator%"){var i=e("%AsyncGeneratorFunction%");i&&(r=i.prototype)}else if(t==="%AsyncIteratorPrototype%"){var s=e("%AsyncGenerator%");s&&Ht&&(r=Ht(s.prototype))}return ti[t]=r,r},Rc={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Rs=ao(),ho=Pc(),$p=Rs.call(Function.call,Array.prototype.concat),jp=Rs.call(Function.apply,Array.prototype.splice),Cc=Rs.call(Function.call,String.prototype.replace),lo=Rs.call(Function.call,String.prototype.slice),Yp=Rs.call(Function.call,RegExp.prototype.exec),qp=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Kp=/\\(\\)?/g,Zp=function(t){var r=lo(t,0,1),i=lo(t,-1);if(r==="%"&&i!=="%")throw new Oi("invalid intrinsic syntax, expected closing `%`");if(i==="%"&&r!=="%")throw new Oi("invalid intrinsic syntax, expected opening `%`");var s=[];return Cc(t,qp,function(n,o,a,h){s[s.length]=a?Cc(h,Kp,"$1"):o||n}),s},Jp=function(t,r){var i=t,s;if(ho(Rc,i)&&(s=Rc[i],i="%"+s[0]+"%"),ho(ti,i)){var n=ti[i];if(n===Bi&&(n=Wp(i)),typeof n>"u"&&!r)throw new Di("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:s,name:i,value:n}}throw new Oi("intrinsic "+t+" does not exist!")};Bc.exports=function(t,r){if(typeof t!="string"||t.length===0)throw new Di("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof r!="boolean")throw new Di('"allowMissing" argument must be a boolean');if(Yp(/^%?[^%]*%?$/,t)===null)throw new Oi("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var i=Zp(t),s=i.length>0?i[0]:"",n=Jp("%"+s+"%",r),o=n.name,a=n.value,h=!1,l=n.alias;l&&(s=l[0],jp(i,$p([0,1],l)));for(var c=1,u=!0;c<i.length;c+=1){var d=i[c],f=lo(d,0,1),p=lo(d,-1);if((f==='"'||f==="'"||f==="`"||p==='"'||p==="'"||p==="`")&&f!==p)throw new Oi("property names with quotes must have matching quotes");if((d==="constructor"||!u)&&(h=!0),s+="."+d,o="%"+s+"%",ho(ti,o))a=ti[o];else if(a!=null){if(!(d in a)){if(!r)throw new Di("base intrinsic for "+t+" exists, but the property is not available.");return}if(Qr&&c+1>=i.length){var g=Qr(a,d);u=!!g,u&&"get"in g&&!("originalValue"in g.get)?a=g.get:a=a[d]}else u=ho(a,d),a=a[d];u&&!h&&(ti[o]=a)}}return a}});var Uc=mt((my,uo)=>{"use strict";var Ja=ao(),Fi=co(),Fc=Fi("%Function.prototype.apply%"),Lc=Fi("%Function.prototype.call%"),Nc=Fi("%Reflect.apply%",!0)||Ja.call(Lc,Fc),Dc=Fi("%Object.getOwnPropertyDescriptor%",!0),ei=Fi("%Object.defineProperty%",!0),Qp=Fi("%Math.max%");if(ei)try{ei({},"a",{value:1})}catch{ei=null}uo.exports=function(t){var r=Nc(Ja,Lc,arguments);if(Dc&&ei){var i=Dc(r,"length");i.configurable&&ei(r,"length",{value:1+Qp(0,t.length-(arguments.length-1))})}return r};var Oc=function(){return Nc(Ja,Fc,arguments)};ei?ei(uo.exports,"apply",{value:Oc}):uo.exports.apply=Oc});var Xc=mt((gy,Hc)=>{"use strict";var Gc=co(),kc=Uc(),tm=kc(Gc("String.prototype.indexOf"));Hc.exports=function(t,r){var i=Gc(t,!!r);return typeof i=="function"&&tm(t,".prototype.")>-1?kc(i):i}});var Vc=mt(()=>{});var lu=mt((yy,hu)=>{var hh=typeof Map=="function"&&Map.prototype,Qa=Object.getOwnPropertyDescriptor&&hh?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,po=hh&&Qa&&typeof Qa.get=="function"?Qa.get:null,zc=hh&&Map.prototype.forEach,lh=typeof Set=="function"&&Set.prototype,th=Object.getOwnPropertyDescriptor&&lh?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,mo=lh&&th&&typeof th.get=="function"?th.get:null,Wc=lh&&Set.prototype.forEach,em=typeof WeakMap=="function"&&WeakMap.prototype,Ms=em?WeakMap.prototype.has:null,rm=typeof WeakSet=="function"&&WeakSet.prototype,Bs=rm?WeakSet.prototype.has:null,im=typeof WeakRef=="function"&&WeakRef.prototype,$c=im?WeakRef.prototype.deref:null,sm=Boolean.prototype.valueOf,nm=Object.prototype.toString,om=Function.prototype.toString,am=String.prototype.match,ch=String.prototype.slice,Er=String.prototype.replace,hm=String.prototype.toUpperCase,jc=String.prototype.toLowerCase,ru=RegExp.prototype.test,Yc=Array.prototype.concat,qe=Array.prototype.join,lm=Array.prototype.slice,qc=Math.floor,ih=typeof BigInt=="function"?BigInt.prototype.valueOf:null,eh=Object.getOwnPropertySymbols,sh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Li=typeof Symbol=="function"&&typeof Symbol.iterator=="object",ee=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Li||"symbol")?Symbol.toStringTag:null,iu=Object.prototype.propertyIsEnumerable,Kc=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function Zc(e,t){if(e===1/0||e===-1/0||e!==e||e&&e>-1e3&&e<1e3||ru.call(/e/,t))return t;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof e=="number"){var i=e<0?-qc(-e):qc(e);if(i!==e){var s=String(i),n=ch.call(t,s.length+1);return Er.call(s,r,"$&_")+"."+Er.call(Er.call(n,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Er.call(t,r,"$&_")}var nh=Vc(),Jc=nh.custom,Qc=nu(Jc)?Jc:null;hu.exports=function e(t,r,i,s){var n=r||{};if(wr(n,"quoteStyle")&&n.quoteStyle!=="single"&&n.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(wr(n,"maxStringLength")&&(typeof n.maxStringLength=="number"?n.maxStringLength<0&&n.maxStringLength!==1/0:n.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var o=wr(n,"customInspect")?n.customInspect:!0;if(typeof o!="boolean"&&o!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(wr(n,"indent")&&n.indent!==null&&n.indent!=="	"&&!(parseInt(n.indent,10)===n.indent&&n.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(wr(n,"numericSeparator")&&typeof n.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var a=n.numericSeparator;if(typeof t>"u")return"undefined";if(t===null)return"null";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="string")return au(t,n);if(typeof t=="number"){if(t===0)return 1/0/t>0?"0":"-0";var h=String(t);return a?Zc(t,h):h}if(typeof t=="bigint"){var l=String(t)+"n";return a?Zc(t,l):l}var c=typeof n.depth>"u"?5:n.depth;if(typeof i>"u"&&(i=0),i>=c&&c>0&&typeof t=="object")return oh(t)?"[Array]":"[Object]";var u=Pm(n,i);if(typeof s>"u")s=[];else if(ou(s,t)>=0)return"[Circular]";function d(A,I,it){if(I&&(s=lm.call(s),s.push(I)),it){var Y={depth:n.depth};return wr(n,"quoteStyle")&&(Y.quoteStyle=n.quoteStyle),e(A,Y,i+1,s)}return e(A,n,i+1,s)}if(typeof t=="function"&&!tu(t)){var f=_m(t),p=fo(t,d);return"[Function"+(f?": "+f:" (anonymous)")+"]"+(p.length>0?" { "+qe.call(p,", ")+" }":"")}if(nu(t)){var g=Li?Er.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):sh.call(t);return typeof t=="object"&&!Li?Cs(g):g}if(Em(t)){for(var _="<"+jc.call(String(t.nodeName)),y=t.attributes||[],T=0;T<y.length;T++)_+=" "+y[T].name+"="+su(cm(y[T].value),"double",n);return _+=">",t.childNodes&&t.childNodes.length&&(_+="..."),_+="</"+jc.call(String(t.nodeName))+">",_}if(oh(t)){if(t.length===0)return"[]";var x=fo(t,d);return u&&!Am(x)?"["+ah(x,u)+"]":"[ "+qe.call(x,", ")+" ]"}if(dm(t)){var v=fo(t,d);return!("cause"in Error.prototype)&&"cause"in t&&!iu.call(t,"cause")?"{ ["+String(t)+"] "+qe.call(Yc.call("[cause]: "+d(t.cause),v),", ")+" }":v.length===0?"["+String(t)+"]":"{ ["+String(t)+"] "+qe.call(v,", ")+" }"}if(typeof t=="object"&&o){if(Qc&&typeof t[Qc]=="function"&&nh)return nh(t,{depth:c-i});if(o!=="symbol"&&typeof t.inspect=="function")return t.inspect()}if(ym(t)){var N=[];return zc&&zc.call(t,function(A,I){N.push(d(I,t,!0)+" => "+d(A,t))}),eu("Map",po.call(t),N,u)}if(Tm(t)){var k=[];return Wc&&Wc.call(t,function(A){k.push(d(A,t))}),eu("Set",mo.call(t),k,u)}if(vm(t))return rh("WeakMap");if(wm(t))return rh("WeakSet");if(bm(t))return rh("WeakRef");if(pm(t))return Cs(d(Number(t)));if(gm(t))return Cs(d(ih.call(t)));if(mm(t))return Cs(sm.call(t));if(fm(t))return Cs(d(String(t)));if(!um(t)&&!tu(t)){var B=fo(t,d),R=Kc?Kc(t)===Object.prototype:t instanceof Object||t.constructor===Object,U=t instanceof Object?"":"null prototype",C=!R&&ee&&Object(t)===t&&ee in t?ch.call(Sr(t),8,-1):U?"Object":"",F=R||typeof t.constructor!="function"?"":t.constructor.name?t.constructor.name+" ":"",K=F+(C||U?"["+qe.call(Yc.call([],C||[],U||[]),": ")+"] ":"");return B.length===0?K+"{}":u?K+"{"+ah(B,u)+"}":K+"{ "+qe.call(B,", ")+" }"}return String(t)};function su(e,t,r){var i=(r.quoteStyle||t)==="double"?'"':"'";return i+e+i}function cm(e){return Er.call(String(e),/"/g,"&quot;")}function oh(e){return Sr(e)==="[object Array]"&&(!ee||!(typeof e=="object"&&ee in e))}function um(e){return Sr(e)==="[object Date]"&&(!ee||!(typeof e=="object"&&ee in e))}function tu(e){return Sr(e)==="[object RegExp]"&&(!ee||!(typeof e=="object"&&ee in e))}function dm(e){return Sr(e)==="[object Error]"&&(!ee||!(typeof e=="object"&&ee in e))}function fm(e){return Sr(e)==="[object String]"&&(!ee||!(typeof e=="object"&&ee in e))}function pm(e){return Sr(e)==="[object Number]"&&(!ee||!(typeof e=="object"&&ee in e))}function mm(e){return Sr(e)==="[object Boolean]"&&(!ee||!(typeof e=="object"&&ee in e))}function nu(e){if(Li)return e&&typeof e=="object"&&e instanceof Symbol;if(typeof e=="symbol")return!0;if(!e||typeof e!="object"||!sh)return!1;try{return sh.call(e),!0}catch{}return!1}function gm(e){if(!e||typeof e!="object"||!ih)return!1;try{return ih.call(e),!0}catch{}return!1}var xm=Object.prototype.hasOwnProperty||function(e){return e in this};function wr(e,t){return xm.call(e,t)}function Sr(e){return nm.call(e)}function _m(e){if(e.name)return e.name;var t=am.call(om.call(e),/^function\s*([\w$]+)/);return t?t[1]:null}function ou(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0,i=e.length;r<i;r++)if(e[r]===t)return r;return-1}function ym(e){if(!po||!e||typeof e!="object")return!1;try{po.call(e);try{mo.call(e)}catch{return!0}return e instanceof Map}catch{}return!1}function vm(e){if(!Ms||!e||typeof e!="object")return!1;try{Ms.call(e,Ms);try{Bs.call(e,Bs)}catch{return!0}return e instanceof WeakMap}catch{}return!1}function bm(e){if(!$c||!e||typeof e!="object")return!1;try{return $c.call(e),!0}catch{}return!1}function Tm(e){if(!mo||!e||typeof e!="object")return!1;try{mo.call(e);try{po.call(e)}catch{return!0}return e instanceof Set}catch{}return!1}function wm(e){if(!Bs||!e||typeof e!="object")return!1;try{Bs.call(e,Bs);try{Ms.call(e,Ms)}catch{return!0}return e instanceof WeakSet}catch{}return!1}function Em(e){return!e||typeof e!="object"?!1:typeof HTMLElement<"u"&&e instanceof HTMLElement?!0:typeof e.nodeName=="string"&&typeof e.getAttribute=="function"}function au(e,t){if(e.length>t.maxStringLength){var r=e.length-t.maxStringLength,i="... "+r+" more character"+(r>1?"s":"");return au(ch.call(e,0,t.maxStringLength),t)+i}var s=Er.call(Er.call(e,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,Sm);return su(s,"single",t)}function Sm(e){var t=e.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return r?"\\"+r:"\\x"+(t<16?"0":"")+hm.call(t.toString(16))}function Cs(e){return"Object("+e+")"}function rh(e){return e+" { ? }"}function eu(e,t,r,i){var s=i?ah(r,i):qe.call(r,", ");return e+" ("+t+") {"+s+"}"}function Am(e){for(var t=0;t<e.length;t++)if(ou(e[t],`
`)>=0)return!1;return!0}function Pm(e,t){var r;if(e.indent==="	")r="	";else if(typeof e.indent=="number"&&e.indent>0)r=qe.call(Array(e.indent+1)," ");else return null;return{base:r,prev:qe.call(Array(t+1),r)}}function ah(e,t){if(e.length===0)return"";var r=`
`+t.prev+t.base;return r+qe.call(e,","+r)+`
`+t.prev}function fo(e,t){var r=oh(e),i=[];if(r){i.length=e.length;for(var s=0;s<e.length;s++)i[s]=wr(e,s)?t(e[s],e):""}var n=typeof eh=="function"?eh(e):[],o;if(Li){o={};for(var a=0;a<n.length;a++)o["$"+n[a]]=n[a]}for(var h in e)wr(e,h)&&(r&&String(Number(h))===h&&h<e.length||Li&&o["$"+h]instanceof Symbol||(ru.call(/[^\w$]/,h)?i.push(t(h,e)+": "+t(e[h],e)):i.push(h+": "+t(e[h],e))));if(typeof eh=="function")for(var l=0;l<n.length;l++)iu.call(e,n[l])&&i.push("["+t(n[l])+"]: "+t(e[n[l]],e));return i}});var uu=mt((vy,cu)=>{"use strict";var uh=co(),Ni=Xc(),Im=lu(),Rm=uh("%TypeError%"),go=uh("%WeakMap%",!0),xo=uh("%Map%",!0),Cm=Ni("WeakMap.prototype.get",!0),Mm=Ni("WeakMap.prototype.set",!0),Bm=Ni("WeakMap.prototype.has",!0),Dm=Ni("Map.prototype.get",!0),Om=Ni("Map.prototype.set",!0),Fm=Ni("Map.prototype.has",!0),dh=function(e,t){for(var r=e,i;(i=r.next)!==null;r=i)if(i.key===t)return r.next=i.next,i.next=e.next,e.next=i,i},Lm=function(e,t){var r=dh(e,t);return r&&r.value},Nm=function(e,t,r){var i=dh(e,t);i?i.value=r:e.next={key:t,next:e.next,value:r}},Um=function(e,t){return!!dh(e,t)};cu.exports=function(){var t,r,i,s={assert:function(n){if(!s.has(n))throw new Rm("Side channel does not contain "+Im(n))},get:function(n){if(go&&n&&(typeof n=="object"||typeof n=="function")){if(t)return Cm(t,n)}else if(xo){if(r)return Dm(r,n)}else if(i)return Lm(i,n)},has:function(n){if(go&&n&&(typeof n=="object"||typeof n=="function")){if(t)return Bm(t,n)}else if(xo){if(r)return Fm(r,n)}else if(i)return Um(i,n);return!1},set:function(n,o){go&&n&&(typeof n=="object"||typeof n=="function")?(t||(t=new go),Mm(t,n,o)):xo?(r||(r=new xo),Om(r,n,o)):(i||(i={key:{},next:null}),Nm(i,n,o))}};return s}});var _o=mt((by,du)=>{"use strict";var Gm=String.prototype.replace,km=/%20/g,fh={RFC1738:"RFC1738",RFC3986:"RFC3986"};du.exports={default:fh.RFC3986,formatters:{RFC1738:function(e){return Gm.call(e,km,"+")},RFC3986:function(e){return String(e)}},RFC1738:fh.RFC1738,RFC3986:fh.RFC3986}});var mh=mt((Ty,pu)=>{"use strict";var Hm=_o(),ph=Object.prototype.hasOwnProperty,ri=Array.isArray,Ke=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),Xm=function(t){for(;t.length>1;){var r=t.pop(),i=r.obj[r.prop];if(ri(i)){for(var s=[],n=0;n<i.length;++n)typeof i[n]<"u"&&s.push(i[n]);r.obj[r.prop]=s}}},fu=function(t,r){for(var i=r&&r.plainObjects?Object.create(null):{},s=0;s<t.length;++s)typeof t[s]<"u"&&(i[s]=t[s]);return i},Vm=function e(t,r,i){if(!r)return t;if(typeof r!="object"){if(ri(t))t.push(r);else if(t&&typeof t=="object")(i&&(i.plainObjects||i.allowPrototypes)||!ph.call(Object.prototype,r))&&(t[r]=!0);else return[t,r];return t}if(!t||typeof t!="object")return[t].concat(r);var s=t;return ri(t)&&!ri(r)&&(s=fu(t,i)),ri(t)&&ri(r)?(r.forEach(function(n,o){if(ph.call(t,o)){var a=t[o];a&&typeof a=="object"&&n&&typeof n=="object"?t[o]=e(a,n,i):t.push(n)}else t[o]=n}),t):Object.keys(r).reduce(function(n,o){var a=r[o];return ph.call(n,o)?n[o]=e(n[o],a,i):n[o]=a,n},s)},zm=function(t,r){return Object.keys(r).reduce(function(i,s){return i[s]=r[s],i},t)},Wm=function(e,t,r){var i=e.replace(/\+/g," ");if(r==="iso-8859-1")return i.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(i)}catch{return i}},$m=function(t,r,i,s,n){if(t.length===0)return t;var o=t;if(typeof t=="symbol"?o=Symbol.prototype.toString.call(t):typeof t!="string"&&(o=String(t)),i==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(c){return"%26%23"+parseInt(c.slice(2),16)+"%3B"});for(var a="",h=0;h<o.length;++h){var l=o.charCodeAt(h);if(l===45||l===46||l===95||l===126||l>=48&&l<=57||l>=65&&l<=90||l>=97&&l<=122||n===Hm.RFC1738&&(l===40||l===41)){a+=o.charAt(h);continue}if(l<128){a=a+Ke[l];continue}if(l<2048){a=a+(Ke[192|l>>6]+Ke[128|l&63]);continue}if(l<55296||l>=57344){a=a+(Ke[224|l>>12]+Ke[128|l>>6&63]+Ke[128|l&63]);continue}h+=1,l=65536+((l&1023)<<10|o.charCodeAt(h)&1023),a+=Ke[240|l>>18]+Ke[128|l>>12&63]+Ke[128|l>>6&63]+Ke[128|l&63]}return a},jm=function(t){for(var r=[{obj:{o:t},prop:"o"}],i=[],s=0;s<r.length;++s)for(var n=r[s],o=n.obj[n.prop],a=Object.keys(o),h=0;h<a.length;++h){var l=a[h],c=o[l];typeof c=="object"&&c!==null&&i.indexOf(c)===-1&&(r.push({obj:o,prop:l}),i.push(c))}return Xm(r),t},Ym=function(t){return Object.prototype.toString.call(t)==="[object RegExp]"},qm=function(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))},Km=function(t,r){return[].concat(t,r)},Zm=function(t,r){if(ri(t)){for(var i=[],s=0;s<t.length;s+=1)i.push(r(t[s]));return i}return r(t)};pu.exports={arrayToObject:fu,assign:zm,combine:Km,compact:jm,decode:Wm,encode:$m,isBuffer:qm,isRegExp:Ym,maybeMap:Zm,merge:Vm}});var vu=mt((wy,yu)=>{"use strict";var xu=uu(),yo=mh(),Ds=_o(),Jm=Object.prototype.hasOwnProperty,mu={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,r){return t+"["+r+"]"},repeat:function(t){return t}},lr=Array.isArray,Qm=Array.prototype.push,_u=function(e,t){Qm.apply(e,lr(t)?t:[t])},tg=Date.prototype.toISOString,gu=Ds.default,re={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:yo.encode,encodeValuesOnly:!1,format:gu,formatter:Ds.formatters[gu],indices:!1,serializeDate:function(t){return tg.call(t)},skipNulls:!1,strictNullHandling:!1},eg=function(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"},gh={},rg=function e(t,r,i,s,n,o,a,h,l,c,u,d,f,p,g,_){for(var y=t,T=_,x=0,v=!1;(T=T.get(gh))!==void 0&&!v;){var N=T.get(t);if(x+=1,typeof N<"u"){if(N===x)throw new RangeError("Cyclic object value");v=!0}typeof T.get(gh)>"u"&&(x=0)}if(typeof h=="function"?y=h(r,y):y instanceof Date?y=u(y):i==="comma"&&lr(y)&&(y=yo.maybeMap(y,function(Y){return Y instanceof Date?u(Y):Y})),y===null){if(n)return a&&!p?a(r,re.encoder,g,"key",d):r;y=""}if(eg(y)||yo.isBuffer(y)){if(a){var k=p?r:a(r,re.encoder,g,"key",d);return[f(k)+"="+f(a(y,re.encoder,g,"value",d))]}return[f(r)+"="+f(String(y))]}var B=[];if(typeof y>"u")return B;var R;if(i==="comma"&&lr(y))p&&a&&(y=yo.maybeMap(y,a)),R=[{value:y.length>0?y.join(",")||null:void 0}];else if(lr(h))R=h;else{var U=Object.keys(y);R=l?U.sort(l):U}for(var C=s&&lr(y)&&y.length===1?r+"[]":r,F=0;F<R.length;++F){var K=R[F],A=typeof K=="object"&&typeof K.value<"u"?K.value:y[K];if(!(o&&A===null)){var I=lr(y)?typeof i=="function"?i(C,K):C:C+(c?"."+K:"["+K+"]");_.set(t,x);var it=xu();it.set(gh,_),_u(B,e(A,I,i,s,n,o,i==="comma"&&p&&lr(y)?null:a,h,l,c,u,d,f,p,g,it))}}return B},ig=function(t){if(!t)return re;if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");var r=t.charset||re.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var i=Ds.default;if(typeof t.format<"u"){if(!Jm.call(Ds.formatters,t.format))throw new TypeError("Unknown format option provided.");i=t.format}var s=Ds.formatters[i],n=re.filter;return(typeof t.filter=="function"||lr(t.filter))&&(n=t.filter),{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:re.addQueryPrefix,allowDots:typeof t.allowDots>"u"?re.allowDots:!!t.allowDots,charset:r,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:re.charsetSentinel,delimiter:typeof t.delimiter>"u"?re.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:re.encode,encoder:typeof t.encoder=="function"?t.encoder:re.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:re.encodeValuesOnly,filter:n,format:i,formatter:s,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:re.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:re.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:re.strictNullHandling}};yu.exports=function(e,t){var r=e,i=ig(t),s,n;typeof i.filter=="function"?(n=i.filter,r=n("",r)):lr(i.filter)&&(n=i.filter,s=n);var o=[];if(typeof r!="object"||r===null)return"";var a;t&&t.arrayFormat in mu?a=t.arrayFormat:t&&"indices"in t?a=t.indices?"indices":"repeat":a="indices";var h=mu[a];if(t&&"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var l=h==="comma"&&t&&t.commaRoundTrip;s||(s=Object.keys(r)),i.sort&&s.sort(i.sort);for(var c=xu(),u=0;u<s.length;++u){var d=s[u];i.skipNulls&&r[d]===null||_u(o,rg(r[d],d,h,l,i.strictNullHandling,i.skipNulls,i.encode?i.encoder:null,i.filter,i.sort,i.allowDots,i.serializeDate,i.format,i.formatter,i.encodeValuesOnly,i.charset,c))}var f=o.join(i.delimiter),p=i.addQueryPrefix===!0?"?":"";return i.charsetSentinel&&(i.charset==="iso-8859-1"?p+="utf8=%26%2310003%3B&":p+="utf8=%E2%9C%93&"),f.length>0?p+f:""}});var wu=mt((Ey,Tu)=>{"use strict";var Ui=mh(),xh=Object.prototype.hasOwnProperty,sg=Array.isArray,Xt={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:Ui.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},ng=function(e){return e.replace(/&#(\d+);/g,function(t,r){return String.fromCharCode(parseInt(r,10))})},bu=function(e,t){return e&&typeof e=="string"&&t.comma&&e.indexOf(",")>-1?e.split(","):e},og="utf8=%26%2310003%3B",ag="utf8=%E2%9C%93",hg=function(t,r){var i={__proto__:null},s=r.ignoreQueryPrefix?t.replace(/^\?/,""):t,n=r.parameterLimit===1/0?void 0:r.parameterLimit,o=s.split(r.delimiter,n),a=-1,h,l=r.charset;if(r.charsetSentinel)for(h=0;h<o.length;++h)o[h].indexOf("utf8=")===0&&(o[h]===ag?l="utf-8":o[h]===og&&(l="iso-8859-1"),a=h,h=o.length);for(h=0;h<o.length;++h)if(h!==a){var c=o[h],u=c.indexOf("]="),d=u===-1?c.indexOf("="):u+1,f,p;d===-1?(f=r.decoder(c,Xt.decoder,l,"key"),p=r.strictNullHandling?null:""):(f=r.decoder(c.slice(0,d),Xt.decoder,l,"key"),p=Ui.maybeMap(bu(c.slice(d+1),r),function(g){return r.decoder(g,Xt.decoder,l,"value")})),p&&r.interpretNumericEntities&&l==="iso-8859-1"&&(p=ng(p)),c.indexOf("[]=")>-1&&(p=sg(p)?[p]:p),xh.call(i,f)?i[f]=Ui.combine(i[f],p):i[f]=p}return i},lg=function(e,t,r,i){for(var s=i?t:bu(t,r),n=e.length-1;n>=0;--n){var o,a=e[n];if(a==="[]"&&r.parseArrays)o=[].concat(s);else{o=r.plainObjects?Object.create(null):{};var h=a.charAt(0)==="["&&a.charAt(a.length-1)==="]"?a.slice(1,-1):a,l=parseInt(h,10);!r.parseArrays&&h===""?o={0:s}:!isNaN(l)&&a!==h&&String(l)===h&&l>=0&&r.parseArrays&&l<=r.arrayLimit?(o=[],o[l]=s):h!=="__proto__"&&(o[h]=s)}s=o}return s},cg=function(t,r,i,s){if(t){var n=i.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,o=/(\[[^[\]]*])/,a=/(\[[^[\]]*])/g,h=i.depth>0&&o.exec(n),l=h?n.slice(0,h.index):n,c=[];if(l){if(!i.plainObjects&&xh.call(Object.prototype,l)&&!i.allowPrototypes)return;c.push(l)}for(var u=0;i.depth>0&&(h=a.exec(n))!==null&&u<i.depth;){if(u+=1,!i.plainObjects&&xh.call(Object.prototype,h[1].slice(1,-1))&&!i.allowPrototypes)return;c.push(h[1])}return h&&c.push("["+n.slice(h.index)+"]"),lg(c,r,i,s)}},ug=function(t){if(!t)return Xt;if(t.decoder!==null&&t.decoder!==void 0&&typeof t.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=typeof t.charset>"u"?Xt.charset:t.charset;return{allowDots:typeof t.allowDots>"u"?Xt.allowDots:!!t.allowDots,allowPrototypes:typeof t.allowPrototypes=="boolean"?t.allowPrototypes:Xt.allowPrototypes,allowSparse:typeof t.allowSparse=="boolean"?t.allowSparse:Xt.allowSparse,arrayLimit:typeof t.arrayLimit=="number"?t.arrayLimit:Xt.arrayLimit,charset:r,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:Xt.charsetSentinel,comma:typeof t.comma=="boolean"?t.comma:Xt.comma,decoder:typeof t.decoder=="function"?t.decoder:Xt.decoder,delimiter:typeof t.delimiter=="string"||Ui.isRegExp(t.delimiter)?t.delimiter:Xt.delimiter,depth:typeof t.depth=="number"||t.depth===!1?+t.depth:Xt.depth,ignoreQueryPrefix:t.ignoreQueryPrefix===!0,interpretNumericEntities:typeof t.interpretNumericEntities=="boolean"?t.interpretNumericEntities:Xt.interpretNumericEntities,parameterLimit:typeof t.parameterLimit=="number"?t.parameterLimit:Xt.parameterLimit,parseArrays:t.parseArrays!==!1,plainObjects:typeof t.plainObjects=="boolean"?t.plainObjects:Xt.plainObjects,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:Xt.strictNullHandling}};Tu.exports=function(e,t){var r=ug(t);if(e===""||e===null||typeof e>"u")return r.plainObjects?Object.create(null):{};for(var i=typeof e=="string"?hg(e,r):e,s=r.plainObjects?Object.create(null):{},n=Object.keys(i),o=0;o<n.length;++o){var a=n[o],h=cg(a,i[a],r,typeof e=="string");s=Ui.merge(s,h,r)}return r.allowSparse===!0?s:Ui.compact(s)}});var Su=mt((Sy,Eu)=>{"use strict";var dg=vu(),fg=wu(),pg=_o();Eu.exports={formats:pg,parse:fg,stringify:dg}});var Ru=mt(ki=>{"use strict";var mg=pc();function De(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var gg=/^([a-z0-9.+-]+:)/i,xg=/:[0-9]*$/,_g=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,yg=["<",">",'"',"`"," ","\r",`
`,"	"],vg=["{","}","|","\\","^","`"].concat(yg),_h=["'"].concat(vg),Au=["%","/","?",";","#"].concat(_h),Pu=["/","?","#"],bg=255,Iu=/^[+a-z0-9A-Z_-]{0,63}$/,Tg=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,wg={javascript:!0,"javascript:":!0},yh={javascript:!0,"javascript:":!0},Gi={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},vh=Su();function Os(e,t,r){if(e&&typeof e=="object"&&e instanceof De)return e;var i=new De;return i.parse(e,t,r),i}De.prototype.parse=function(e,t,r){if(typeof e!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var i=e.indexOf("?"),s=i!==-1&&i<e.indexOf("#")?"?":"#",n=e.split(s),o=/\\/g;n[0]=n[0].replace(o,"/"),e=n.join(s);var a=e;if(a=a.trim(),!r&&e.split("#").length===1){var h=_g.exec(a);if(h)return this.path=a,this.href=a,this.pathname=h[1],h[2]?(this.search=h[2],t?this.query=vh.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var l=gg.exec(a);if(l){l=l[0];var c=l.toLowerCase();this.protocol=c,a=a.substr(l.length)}if(r||l||a.match(/^\/\/[^@/]+@[^@/]+/)){var u=a.substr(0,2)==="//";u&&!(l&&yh[l])&&(a=a.substr(2),this.slashes=!0)}if(!yh[l]&&(u||l&&!Gi[l])){for(var d=-1,f=0;f<Pu.length;f++){var p=a.indexOf(Pu[f]);p!==-1&&(d===-1||p<d)&&(d=p)}var g,_;d===-1?_=a.lastIndexOf("@"):_=a.lastIndexOf("@",d),_!==-1&&(g=a.slice(0,_),a=a.slice(_+1),this.auth=decodeURIComponent(g)),d=-1;for(var f=0;f<Au.length;f++){var p=a.indexOf(Au[f]);p!==-1&&(d===-1||p<d)&&(d=p)}d===-1&&(d=a.length),this.host=a.slice(0,d),a=a.slice(d),this.parseHost(),this.hostname=this.hostname||"";var y=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!y)for(var T=this.hostname.split(/\./),f=0,x=T.length;f<x;f++){var v=T[f];if(v&&!v.match(Iu)){for(var N="",k=0,B=v.length;k<B;k++)v.charCodeAt(k)>127?N+="x":N+=v[k];if(!N.match(Iu)){var R=T.slice(0,f),U=T.slice(f+1),C=v.match(Tg);C&&(R.push(C[1]),U.unshift(C[2])),U.length&&(a="/"+U.join(".")+a),this.hostname=R.join(".");break}}}this.hostname.length>bg?this.hostname="":this.hostname=this.hostname.toLowerCase(),y||(this.hostname=mg.toASCII(this.hostname));var F=this.port?":"+this.port:"",K=this.hostname||"";this.host=K+F,this.href+=this.host,y&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!wg[c])for(var f=0,x=_h.length;f<x;f++){var A=_h[f];if(a.indexOf(A)!==-1){var I=encodeURIComponent(A);I===A&&(I=escape(A)),a=a.split(A).join(I)}}var it=a.indexOf("#");it!==-1&&(this.hash=a.substr(it),a=a.slice(0,it));var Y=a.indexOf("?");if(Y!==-1?(this.search=a.substr(Y),this.query=a.substr(Y+1),t&&(this.query=vh.parse(this.query)),a=a.slice(0,Y)):t&&(this.search="",this.query={}),a&&(this.pathname=a),Gi[c]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var F=this.pathname||"",et=this.search||"";this.path=F+et}return this.href=this.format(),this};function Eg(e){return typeof e=="string"&&(e=Os(e)),e instanceof De?e.format():De.prototype.format.call(e)}De.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",i=this.hash||"",s=!1,n="";this.host?s=e+this.host:this.hostname&&(s=e+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(s+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(n=vh.stringify(this.query));var o=this.search||n&&"?"+n||"";return t&&t.substr(-1)!==":"&&(t+=":"),this.slashes||(!t||Gi[t])&&s!==!1?(s="//"+(s||""),r&&r.charAt(0)!=="/"&&(r="/"+r)):s||(s=""),i&&i.charAt(0)!=="#"&&(i="#"+i),o&&o.charAt(0)!=="?"&&(o="?"+o),r=r.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),o=o.replace("#","%23"),t+s+r+o+i};function Sg(e,t){return Os(e,!1,!0).resolve(t)}De.prototype.resolve=function(e){return this.resolveObject(Os(e,!1,!0)).format()};function Ag(e,t){return e?Os(e,!1,!0).resolveObject(t):t}De.prototype.resolveObject=function(e){if(typeof e=="string"){var t=new De;t.parse(e,!1,!0),e=t}for(var r=new De,i=Object.keys(this),s=0;s<i.length;s++){var n=i[s];r[n]=this[n]}if(r.hash=e.hash,e.href==="")return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var o=Object.keys(e),a=0;a<o.length;a++){var h=o[a];h!=="protocol"&&(r[h]=e[h])}return Gi[r.protocol]&&r.hostname&&!r.pathname&&(r.pathname="/",r.path=r.pathname),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!Gi[e.protocol]){for(var l=Object.keys(e),c=0;c<l.length;c++){var u=l[c];r[u]=e[u]}return r.href=r.format(),r}if(r.protocol=e.protocol,!e.host&&!yh[e.protocol]){for(var x=(e.pathname||"").split("/");x.length&&!(e.host=x.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),x[0]!==""&&x.unshift(""),x.length<2&&x.unshift(""),r.pathname=x.join("/")}else r.pathname=e.pathname;if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var d=r.pathname||"",f=r.search||"";r.path=d+f}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var p=r.pathname&&r.pathname.charAt(0)==="/",g=e.host||e.pathname&&e.pathname.charAt(0)==="/",_=g||p||r.host&&e.pathname,y=_,T=r.pathname&&r.pathname.split("/")||[],x=e.pathname&&e.pathname.split("/")||[],v=r.protocol&&!Gi[r.protocol];if(v&&(r.hostname="",r.port=null,r.host&&(T[0]===""?T[0]=r.host:T.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(x[0]===""?x[0]=e.host:x.unshift(e.host)),e.host=null),_=_&&(x[0]===""||T[0]==="")),g)r.host=e.host||e.host===""?e.host:r.host,r.hostname=e.hostname||e.hostname===""?e.hostname:r.hostname,r.search=e.search,r.query=e.query,T=x;else if(x.length)T||(T=[]),T.pop(),T=T.concat(x),r.search=e.search,r.query=e.query;else if(e.search!=null){if(v){r.host=T.shift(),r.hostname=r.host;var N=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;N&&(r.auth=N.shift(),r.hostname=N.shift(),r.host=r.hostname)}return r.search=e.search,r.query=e.query,(r.pathname!==null||r.search!==null)&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!T.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var k=T.slice(-1)[0],B=(r.host||e.host||T.length>1)&&(k==="."||k==="..")||k==="",R=0,U=T.length;U>=0;U--)k=T[U],k==="."?T.splice(U,1):k===".."?(T.splice(U,1),R++):R&&(T.splice(U,1),R--);if(!_&&!y)for(;R--;R)T.unshift("..");_&&T[0]!==""&&(!T[0]||T[0].charAt(0)!=="/")&&T.unshift(""),B&&T.join("/").substr(-1)!=="/"&&T.push("");var C=T[0]===""||T[0]&&T[0].charAt(0)==="/";if(v){r.hostname=C?"":T.length?T.shift():"",r.host=r.hostname;var N=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;N&&(r.auth=N.shift(),r.hostname=N.shift(),r.host=r.hostname)}return _=_||r.host&&T.length,_&&!C&&T.unshift(""),T.length>0?r.pathname=T.join("/"):(r.pathname=null,r.path=null),(r.pathname!==null||r.search!==null)&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r};De.prototype.parseHost=function(){var e=this.host,t=xg.exec(e);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)};ki.parse=Os;ki.resolve=Sg;ki.resolveObject=Ag;ki.format=Eg;ki.Url=De});var Lf=mt((Hl,Xl)=>{(function(e,t){typeof Hl=="object"&&typeof Xl<"u"?Xl.exports=t():typeof define=="function"&&define.amd?define(t):e.page=t()})(Hl,function(){"use strict";var e=Array.isArray||function(m){return Object.prototype.toString.call(m)=="[object Array]"},t=T,r=a,i=h,s=l,n=y,o=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^()])+)\\))?|\\(((?:\\\\.|[^()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function a(m){for(var b=[],E=0,M=0,D="",X;(X=o.exec(m))!=null;){var Z=X[0],J=X[1],nt=X.index;if(D+=m.slice(M,nt),M=nt+Z.length,J){D+=J[1];continue}D&&(b.push(D),D="");var ot=X[2],at=X[3],wt=X[4],At=X[5],Pt=X[6],qt=X[7],Zr=Pt==="+"||Pt==="*",qn=Pt==="?"||Pt==="*",Kn=ot||"/",Ua=wt||At||(qt?".*":"[^"+Kn+"]+?");b.push({name:at||E++,prefix:ot||"",delimiter:Kn,optional:qn,repeat:Zr,pattern:u(Ua)})}return M<m.length&&(D+=m.substr(M)),D&&b.push(D),b}function h(m){return l(a(m))}function l(m){for(var b=new Array(m.length),E=0;E<m.length;E++)typeof m[E]=="object"&&(b[E]=new RegExp("^"+m[E].pattern+"$"));return function(M){for(var D="",X=M||{},Z=0;Z<m.length;Z++){var J=m[Z];if(typeof J=="string"){D+=J;continue}var nt=X[J.name],ot;if(nt==null){if(J.optional)continue;throw new TypeError('Expected "'+J.name+'" to be defined')}if(e(nt)){if(!J.repeat)throw new TypeError('Expected "'+J.name+'" to not repeat, but received "'+nt+'"');if(nt.length===0){if(J.optional)continue;throw new TypeError('Expected "'+J.name+'" to not be empty')}for(var at=0;at<nt.length;at++){if(ot=encodeURIComponent(nt[at]),!b[Z].test(ot))throw new TypeError('Expected all "'+J.name+'" to match "'+J.pattern+'", but received "'+ot+'"');D+=(at===0?J.prefix:J.delimiter)+ot}continue}if(ot=encodeURIComponent(nt),!b[Z].test(ot))throw new TypeError('Expected "'+J.name+'" to match "'+J.pattern+'", but received "'+ot+'"');D+=J.prefix+ot}return D}}function c(m){return m.replace(/([.+*?=^!:${}()[\]|\/])/g,"\\$1")}function u(m){return m.replace(/([=!:$\/()])/g,"\\$1")}function d(m,b){return m.keys=b,m}function f(m){return m.sensitive?"":"i"}function p(m,b){var E=m.source.match(/\((?!\?)/g);if(E)for(var M=0;M<E.length;M++)b.push({name:M,prefix:null,delimiter:null,optional:!1,repeat:!1,pattern:null});return d(m,b)}function g(m,b,E){for(var M=[],D=0;D<m.length;D++)M.push(T(m[D],b,E).source);var X=new RegExp("(?:"+M.join("|")+")",f(E));return d(X,b)}function _(m,b,E){for(var M=a(m),D=y(M,E),X=0;X<M.length;X++)typeof M[X]!="string"&&b.push(M[X]);return d(D,b)}function y(m,b){b=b||{};for(var E=b.strict,M=b.end!==!1,D="",X=m[m.length-1],Z=typeof X=="string"&&/\/$/.test(X),J=0;J<m.length;J++){var nt=m[J];if(typeof nt=="string")D+=c(nt);else{var ot=c(nt.prefix),at=nt.pattern;nt.repeat&&(at+="(?:"+ot+at+")*"),nt.optional?ot?at="(?:"+ot+"("+at+"))?":at="("+at+")?":at=ot+"("+at+")",D+=at}}return E||(D=(Z?D.slice(0,-2):D)+"(?:\\/(?=$))?"),M?D+="$":D+=E&&Z?"":"(?=\\/|$)",new RegExp("^"+D,f(b))}function T(m,b,E){return b=b||[],e(b)?E||(E={}):(E=b,b=[]),m instanceof RegExp?p(m,b,E):e(m)?g(m,b,E):_(m,b,E)}t.parse=r,t.compile=i,t.tokensToFunction=s,t.tokensToRegExp=n;var x=typeof document<"u",v=typeof window<"u",N=typeof history<"u",k=typeof process<"u",B=x&&document.ontouchstart?"touchstart":"click",R=v&&!!(window.history.location||window.location);function U(){this.callbacks=[],this.exits=[],this.current="",this.len=0,this._decodeURLComponents=!0,this._base="",this._strict=!1,this._running=!1,this._hashbang=!1,this.clickHandler=this.clickHandler.bind(this),this._onpopstate=this._onpopstate.bind(this)}U.prototype.configure=function(m){var b=m||{};this._window=b.window||v&&window,this._decodeURLComponents=b.decodeURLComponents!==!1,this._popstate=b.popstate!==!1&&v,this._click=b.click!==!1&&x,this._hashbang=!!b.hashbang;var E=this._window;this._popstate?E.addEventListener("popstate",this._onpopstate,!1):v&&E.removeEventListener("popstate",this._onpopstate,!1),this._click?E.document.addEventListener(B,this.clickHandler,!1):x&&E.document.removeEventListener(B,this.clickHandler,!1),this._hashbang&&v&&!N?E.addEventListener("hashchange",this._onpopstate,!1):v&&E.removeEventListener("hashchange",this._onpopstate,!1)},U.prototype.base=function(m){if(arguments.length===0)return this._base;this._base=m},U.prototype._getBase=function(){var m=this._base;if(m)return m;var b=v&&this._window&&this._window.location;return v&&this._hashbang&&b&&b.protocol==="file:"&&(m=b.pathname),m},U.prototype.strict=function(m){if(arguments.length===0)return this._strict;this._strict=m},U.prototype.start=function(m){var b=m||{};if(this.configure(b),b.dispatch!==!1){this._running=!0;var E;if(R){var M=this._window,D=M.location;this._hashbang&&~D.hash.indexOf("#!")?E=D.hash.substr(2)+D.search:this._hashbang?E=D.search+D.hash:E=D.pathname+D.search+D.hash}this.replace(E,null,!0,b.dispatch)}},U.prototype.stop=function(){if(this._running){this.current="",this.len=0,this._running=!1;var m=this._window;this._click&&m.document.removeEventListener(B,this.clickHandler,!1),v&&m.removeEventListener("popstate",this._onpopstate,!1),v&&m.removeEventListener("hashchange",this._onpopstate,!1)}},U.prototype.show=function(m,b,E,M){var D=new I(m,b,this),X=this.prevContext;return this.prevContext=D,this.current=D.path,E!==!1&&this.dispatch(D,X),D.handled!==!1&&M!==!1&&D.pushState(),D},U.prototype.back=function(m,b){var E=this;if(this.len>0){var M=this._window;N&&M.history.back(),this.len--}else setTimeout(m?function(){E.show(m,b)}:function(){E.show(E._getBase(),b)})},U.prototype.redirect=function(m,b){var E=this;typeof m=="string"&&typeof b=="string"&&F.call(this,m,function(M){setTimeout(function(){E.replace(b)},0)}),typeof m=="string"&&typeof b>"u"&&setTimeout(function(){E.replace(m)},0)},U.prototype.replace=function(m,b,E,M){var D=new I(m,b,this),X=this.prevContext;return this.prevContext=D,this.current=D.path,D.init=E,D.save(),M!==!1&&this.dispatch(D,X),D},U.prototype.dispatch=function(m,b){var E=0,M=0,D=this;function X(){var J=D.exits[M++];if(!J)return Z();J(b,X)}function Z(){var J=D.callbacks[E++];if(m.path!==D.current){m.handled=!1;return}if(!J)return K.call(D,m);J(m,Z)}b?X():Z()},U.prototype.exit=function(m,b){if(typeof m=="function")return this.exit("*",m);for(var E=new it(m,null,this),M=1;M<arguments.length;++M)this.exits.push(E.middleware(arguments[M]))},U.prototype.clickHandler=function(m){if(this._which(m)===1&&!(m.metaKey||m.ctrlKey||m.shiftKey)&&!m.defaultPrevented){var b=m.target,E=m.path||(m.composedPath?m.composedPath():null);if(E){for(var M=0;M<E.length;M++)if(E[M].nodeName&&E[M].nodeName.toUpperCase()==="A"&&E[M].href){b=E[M];break}}for(;b&&b.nodeName.toUpperCase()!=="A";)b=b.parentNode;if(!(!b||b.nodeName.toUpperCase()!=="A")){var D=typeof b.href=="object"&&b.href.constructor.name==="SVGAnimatedString";if(!(b.hasAttribute("download")||b.getAttribute("rel")==="external")){var X=b.getAttribute("href");if(!(!this._hashbang&&this._samePath(b)&&(b.hash||X==="#"))&&!(X&&X.indexOf("mailto:")>-1)&&!(D?b.target.baseVal:b.target)&&!(!D&&!this.sameOrigin(b.href))){var Z=D?b.href.baseVal:b.pathname+b.search+(b.hash||"");Z=Z[0]!=="/"?"/"+Z:Z,k&&Z.match(/^\/[a-zA-Z]:\//)&&(Z=Z.replace(/^\/[a-zA-Z]:\//,"/"));var J=Z,nt=this._getBase();Z.indexOf(nt)===0&&(Z=Z.substr(nt.length)),this._hashbang&&(Z=Z.replace("#!","")),!(nt&&J===Z&&(!R||this._window.location.protocol!=="file:"))&&(m.preventDefault(),this.show(J))}}}}},U.prototype._onpopstate=function(){var m=!1;return v?(x&&document.readyState==="complete"?m=!0:window.addEventListener("load",function(){setTimeout(function(){m=!0},0)}),function(E){if(m){var M=this;if(E.state){var D=E.state.path;M.replace(D,E.state)}else if(R){var X=M._window.location;M.show(X.pathname+X.search+X.hash,void 0,void 0,!1)}}}):function(){}}(),U.prototype._which=function(m){return m=m||v&&this._window.event,m.which==null?m.button:m.which},U.prototype._toURL=function(m){var b=this._window;if(typeof URL=="function"&&R)return new URL(m,b.location.toString());if(x){var E=b.document.createElement("a");return E.href=m,E}},U.prototype.sameOrigin=function(m){if(!m||!R)return!1;var b=this._toURL(m),E=this._window,M=E.location;return M.protocol===b.protocol&&M.hostname===b.hostname&&(M.port===b.port||M.port===""&&(b.port==80||b.port==443))},U.prototype._samePath=function(m){if(!R)return!1;var b=this._window,E=b.location;return m.pathname===E.pathname&&m.search===E.search},U.prototype._decodeURLEncodedURIComponent=function(m){return typeof m!="string"?m:this._decodeURLComponents?decodeURIComponent(m.replace(/\+/g," ")):m};function C(){var m=new U;function b(){return F.apply(m,arguments)}return b.callbacks=m.callbacks,b.exits=m.exits,b.base=m.base.bind(m),b.strict=m.strict.bind(m),b.start=m.start.bind(m),b.stop=m.stop.bind(m),b.show=m.show.bind(m),b.back=m.back.bind(m),b.redirect=m.redirect.bind(m),b.replace=m.replace.bind(m),b.dispatch=m.dispatch.bind(m),b.exit=m.exit.bind(m),b.configure=m.configure.bind(m),b.sameOrigin=m.sameOrigin.bind(m),b.clickHandler=m.clickHandler.bind(m),b.create=C,Object.defineProperty(b,"len",{get:function(){return m.len},set:function(E){m.len=E}}),Object.defineProperty(b,"current",{get:function(){return m.current},set:function(E){m.current=E}}),b.Context=I,b.Route=it,b}function F(m,b){if(typeof m=="function")return F.call(this,"*",m);if(typeof b=="function")for(var E=new it(m,null,this),M=1;M<arguments.length;++M)this.callbacks.push(E.middleware(arguments[M]));else typeof m=="string"?this[typeof b=="string"?"redirect":"show"](m,b):this.start(m)}function K(m){if(!m.handled){var b,E=this,M=E._window;E._hashbang?b=R&&this._getBase()+M.location.hash.replace("#!",""):b=R&&M.location.pathname+M.location.search,b!==m.canonicalPath&&(E.stop(),m.handled=!1,R&&(M.location.href=m.canonicalPath))}}function A(m){return m.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function I(m,b,E){var M=this.page=E||F,D=M._window,X=M._hashbang,Z=M._getBase();m[0]==="/"&&m.indexOf(Z)!==0&&(m=Z+(X?"#!":"")+m);var J=m.indexOf("?");this.canonicalPath=m;var nt=new RegExp("^"+A(Z));if(this.path=m.replace(nt,"")||"/",X&&(this.path=this.path.replace("#!","")||"/"),this.title=x&&D.document.title,this.state=b||{},this.state.path=m,this.querystring=~J?M._decodeURLEncodedURIComponent(m.slice(J+1)):"",this.pathname=M._decodeURLEncodedURIComponent(~J?m.slice(0,J):m),this.params={},this.hash="",!X){if(!~this.path.indexOf("#"))return;var ot=this.path.split("#");this.path=this.pathname=ot[0],this.hash=M._decodeURLEncodedURIComponent(ot[1])||"",this.querystring=this.querystring.split("#")[0]}}I.prototype.pushState=function(){var m=this.page,b=m._window,E=m._hashbang;m.len++,N&&b.history.pushState(this.state,this.title,E&&this.path!=="/"?"#!"+this.path:this.canonicalPath)},I.prototype.save=function(){var m=this.page;N&&m._window.history.replaceState(this.state,this.title,m._hashbang&&this.path!=="/"?"#!"+this.path:this.canonicalPath)};function it(m,b,E){var M=this.page=E||Y,D=b||{};D.strict=D.strict||M._strict,this.path=m==="*"?"(.*)":m,this.method="GET",this.regexp=t(this.path,this.keys=[],D)}it.prototype.middleware=function(m){var b=this;return function(E,M){if(b.match(E.path,E.params))return E.routePath=b.path,m(E,M);M()}},it.prototype.match=function(m,b){var E=this.keys,M=m.indexOf("?"),D=~M?m.slice(0,M):m,X=this.regexp.exec(decodeURIComponent(D));if(!X)return!1;delete b[0];for(var Z=1,J=X.length;Z<J;++Z){var nt=E[Z-1],ot=this.page._decodeURLEncodedURIComponent(X[Z]);(ot!==void 0||!hasOwnProperty.call(b,nt.name))&&(b[nt.name]=ot)}return!0};var Y=C(),et=Y,G=Y;return et.default=G,et})});var Nf=mt(Vl=>{"use strict";Object.defineProperty(Vl,"__esModule",{value:!0});var I_=function(){function e(){}return e.toRadians=function(t){return t*Math.PI/180},e.toDegrees=function(t){return t*180/Math.PI},e.delta=function(t,r){return e.normalize(t-r)},e.interpolate=function(t,r,i){var s=e.normalize(t),n=e.normalize(r),o=n-s;if(Math.abs(o)>Math.PI){var a=Math.PI*2*(n>s?-1:1);o=n+a-s}return e.normalize(s+o*i)},e.normalize=function(t){var r=t%(Math.PI*2);return r<0&&(r+=Math.PI*2),r},e}();Vl.default=I_});var Wl=mt(zl=>{"use strict";Object.defineProperty(zl,"__esModule",{value:!0});var R_=function(){function e(t,r){t===void 0&&(t=0),r===void 0&&(r=0),this.x=t,this.y=r}return Object.defineProperty(e.prototype,"data",{get:function(){return{x:this.x,y:this.y}},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},e.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},e.prototype.toString=function(){return JSON.stringify(this.data)},e.distance=function(t,r){return Math.sqrt((t.x-r.x)*(t.x-r.x)+(t.y-r.y)*(t.y-r.y))},e.radians=function(t,r){return Math.atan2(r.y-t.y,r.x-t.x)},e}();zl.default=R_});var Gf=mt($l=>{"use strict";Object.defineProperty($l,"__esModule",{value:!0});var Uf=Wl(),C_=function(){function e(t,r,i){t===void 0&&(t=0),r===void 0&&(r=0),i===void 0&&(i=0),this.model={},t instanceof Uf.default?(this.model.point=t.clone(),this.model.radians=r):(this.model.point=new Uf.default(t,r),this.model.radians=i)}return Object.defineProperty(e.prototype,"point",{get:function(){return this.model.point.clone()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this.model.point.x},set:function(t){this.model.point.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.model.point.y},set:function(t){this.model.point.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"radians",{get:function(){return this.model.radians},set:function(t){this.model.radians=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){var t=this,r=t.x,i=t.y,s=t.radians;return{x:r,y:i,radians:s}},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return new e(this.point,this.radians)},e.prototype.toString=function(){return JSON.stringify(this.data)},e}();$l.default=C_});var Mt=mt(Yr=>{"use strict";Object.defineProperty(Yr,"__esModule",{value:!0});Yr.Vector=Yr.Point=Yr.Angle=void 0;var M_=Nf();Yr.Angle=M_.default;var B_=Wl();Yr.Point=B_.default;var D_=Gf();Yr.Vector=D_.default});var we=(e=>(e[e.WEBGL_LEGACY=0]="WEBGL_LEGACY",e[e.WEBGL=1]="WEBGL",e[e.WEBGL2=2]="WEBGL2",e))(we||{}),ka=(e=>(e[e.UNKNOWN=0]="UNKNOWN",e[e.WEBGL=1]="WEBGL",e[e.CANVAS=2]="CANVAS",e))(ka||{}),Jn=(e=>(e[e.COLOR=16384]="COLOR",e[e.DEPTH=256]="DEPTH",e[e.STENCIL=1024]="STENCIL",e))(Jn||{}),q=(e=>(e[e.NORMAL=0]="NORMAL",e[e.ADD=1]="ADD",e[e.MULTIPLY=2]="MULTIPLY",e[e.SCREEN=3]="SCREEN",e[e.OVERLAY=4]="OVERLAY",e[e.DARKEN=5]="DARKEN",e[e.LIGHTEN=6]="LIGHTEN",e[e.COLOR_DODGE=7]="COLOR_DODGE",e[e.COLOR_BURN=8]="COLOR_BURN",e[e.HARD_LIGHT=9]="HARD_LIGHT",e[e.SOFT_LIGHT=10]="SOFT_LIGHT",e[e.DIFFERENCE=11]="DIFFERENCE",e[e.EXCLUSION=12]="EXCLUSION",e[e.HUE=13]="HUE",e[e.SATURATION=14]="SATURATION",e[e.COLOR=15]="COLOR",e[e.LUMINOSITY=16]="LUMINOSITY",e[e.NORMAL_NPM=17]="NORMAL_NPM",e[e.ADD_NPM=18]="ADD_NPM",e[e.SCREEN_NPM=19]="SCREEN_NPM",e[e.NONE=20]="NONE",e[e.SRC_OVER=0]="SRC_OVER",e[e.SRC_IN=21]="SRC_IN",e[e.SRC_OUT=22]="SRC_OUT",e[e.SRC_ATOP=23]="SRC_ATOP",e[e.DST_OVER=24]="DST_OVER",e[e.DST_IN=25]="DST_IN",e[e.DST_OUT=26]="DST_OUT",e[e.DST_ATOP=27]="DST_ATOP",e[e.ERASE=26]="ERASE",e[e.SUBTRACT=28]="SUBTRACT",e[e.XOR=29]="XOR",e))(q||{}),me=(e=>(e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e))(me||{}),L=(e=>(e[e.RGBA=6408]="RGBA",e[e.RGB=6407]="RGB",e[e.RG=33319]="RG",e[e.RED=6403]="RED",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.ALPHA=6406]="ALPHA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e))(L||{}),ar=(e=>(e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e))(ar||{}),z=(e=>(e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.BYTE=5120]="BYTE",e[e.SHORT=5122]="SHORT",e[e.INT=5124]="INT",e[e.FLOAT=5126]="FLOAT",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.HALF_FLOAT=36193]="HALF_FLOAT",e))(z||{}),Qn=(e=>(e[e.FLOAT=0]="FLOAT",e[e.INT=1]="INT",e[e.UINT=2]="UINT",e))(Qn||{}),Me=(e=>(e[e.NEAREST=0]="NEAREST",e[e.LINEAR=1]="LINEAR",e))(Me||{}),Ee=(e=>(e[e.CLAMP=33071]="CLAMP",e[e.REPEAT=10497]="REPEAT",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e))(Ee||{}),Kt=(e=>(e[e.OFF=0]="OFF",e[e.POW2=1]="POW2",e[e.ON=2]="ON",e[e.ON_MANUAL=3]="ON_MANUAL",e))(Kt||{}),Bt=(e=>(e[e.NPM=0]="NPM",e[e.UNPACK=1]="UNPACK",e[e.PMA=2]="PMA",e[e.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",e[e.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",e[e.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",e))(Bt||{}),Se=(e=>(e[e.NO=0]="NO",e[e.YES=1]="YES",e[e.AUTO=2]="AUTO",e[e.BLEND=0]="BLEND",e[e.CLEAR=1]="CLEAR",e[e.BLIT=2]="BLIT",e))(Se||{}),to=(e=>(e[e.AUTO=0]="AUTO",e[e.MANUAL=1]="MANUAL",e))(to||{}),oe=(e=>(e.LOW="lowp",e.MEDIUM="mediump",e.HIGH="highp",e))(oe||{}),Et=(e=>(e[e.NONE=0]="NONE",e[e.SCISSOR=1]="SCISSOR",e[e.STENCIL=2]="STENCIL",e[e.SPRITE=3]="SPRITE",e[e.COLOR=4]="COLOR",e))(Et||{});var dt=(e=>(e[e.NONE=0]="NONE",e[e.LOW=2]="LOW",e[e.MEDIUM=4]="MEDIUM",e[e.HIGH=8]="HIGH",e))(dt||{}),ge=(e=>(e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e))(ge||{});var Ha={createCanvas:(e,t)=>{let r=document.createElement("canvas");return r.width=e,r.height=t,r},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(e,t)=>fetch(e,t),parseXML:e=>new DOMParser().parseFromString(e,"text/xml")};var w={ADAPTER:Ha,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var Xa=/iPhone/i,Kl=/iPod/i,Zl=/iPad/i,Jl=/\biOS-universal(?:.+)Mac\b/i,Va=/\bAndroid(?:.+)Mobile\b/i,Ql=/Android/i,Pi=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,eo=/Silk/i,hr=/Windows Phone/i,tc=/\bWindows(?:.+)ARM\b/i,ec=/BlackBerry/i,rc=/BB10/i,ic=/Opera Mini/i,sc=/\b(CriOS|Chrome)(?:.+)Mobile/i,nc=/Mobile(?:.+)Firefox\b/i,oc=function(e){return typeof e<"u"&&e.platform==="MacIntel"&&typeof e.maxTouchPoints=="number"&&e.maxTouchPoints>1&&typeof MSStream>"u"};function gp(e){return function(t){return t.test(e)}}function Es(e){var t={userAgent:"",platform:"",maxTouchPoints:0};!e&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof e=="string"?t.userAgent=e:e&&e.userAgent&&(t={userAgent:e.userAgent,platform:e.platform,maxTouchPoints:e.maxTouchPoints||0});var r=t.userAgent,i=r.split("[FBAN");typeof i[1]<"u"&&(r=i[0]),i=r.split("Twitter"),typeof i[1]<"u"&&(r=i[0]);var s=gp(r),n={apple:{phone:s(Xa)&&!s(hr),ipod:s(Kl),tablet:!s(Xa)&&(s(Zl)||oc(t))&&!s(hr),universal:s(Jl),device:(s(Xa)||s(Kl)||s(Zl)||s(Jl)||oc(t))&&!s(hr)},amazon:{phone:s(Pi),tablet:!s(Pi)&&s(eo),device:s(Pi)||s(eo)},android:{phone:!s(hr)&&s(Pi)||!s(hr)&&s(Va),tablet:!s(hr)&&!s(Pi)&&!s(Va)&&(s(eo)||s(Ql)),device:!s(hr)&&(s(Pi)||s(eo)||s(Va)||s(Ql))||s(/\bokhttp\b/i)},windows:{phone:s(hr),tablet:s(tc),device:s(hr)||s(tc)},other:{blackberry:s(ec),blackberry10:s(rc),opera:s(ic),firefox:s(nc),chrome:s(sc),device:s(ec)||s(rc)||s(ic)||s(nc)||s(sc)},any:!1,phone:!1,tablet:!1};return n.any=n.apple.device||n.android.device||n.windows.device||n.other.device,n.phone=n.apple.phone||n.android.phone||n.windows.phone,n.tablet=n.apple.tablet||n.android.tablet||n.windows.tablet,n}var xp=Es.default??Es,Be=xp(globalThis.navigator);var O={};pp(O,{BaseTextureCache:()=>he,BoundingBox:()=>Vi,CanvasRenderTarget:()=>So,DATA_URI:()=>wo,EventEmitter:()=>Ir.default,ProgramCache:()=>ks,TextureCache:()=>zt,clearTextureCache:()=>sd,correctBlendMode:()=>qu,createIndicesForQuads:()=>Qu,decomposeDataUri:()=>hd,deprecation:()=>rt,destroyTextureCache:()=>id,determineCrossOrigin:()=>Io,earcut:()=>ld.default,getBufferType:()=>Ar,getCanvasBoundingBox:()=>Ao,getResolutionOfUrl:()=>Hs,hex2rgb:()=>Wu,hex2string:()=>$u,interleaveTypedArrays:()=>td,isMobile:()=>Be,isPow2:()=>Us,isWebGLSupported:()=>bo,log2:()=>Gs,nextPow2:()=>Pr,path:()=>bh,premultiplyBlendMode:()=>Ns,premultiplyRgba:()=>Ku,premultiplyTint:()=>Zu,premultiplyTintToRgba:()=>Ju,removeItems:()=>Eo,rgb2hex:()=>Yu,sayHello:()=>Bu,sign:()=>ed,skipHello:()=>Mu,string2hex:()=>ju,trimCanvas:()=>ad,uid:()=>Ze,url:()=>vo});w.RETINA_PREFIX=/@([0-9\.]+)x/;w.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var Ir=xt(hc(),1),ld=xt(fc(),1);var Hi=xt(Ru(),1),vo={parse:Hi.parse,format:Hi.format,resolve:Hi.resolve};function Ne(e){if(typeof e!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(e)}`)}function Fs(e){return e.split("?")[0].split("#")[0]}function Pg(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Ig(e,t,r){return e.replace(new RegExp(Pg(t),"g"),r)}function Rg(e,t){let r="",i=0,s=-1,n=0,o=-1;for(let a=0;a<=e.length;++a){if(a<e.length)o=e.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(s===a-1||n===1))if(s!==a-1&&n===2){if(r.length<2||i!==2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){let h=r.lastIndexOf("/");if(h!==r.length-1){h===-1?(r="",i=0):(r=r.slice(0,h),i=r.length-1-r.lastIndexOf("/")),s=a,n=0;continue}}else if(r.length===2||r.length===1){r="",i=0,s=a,n=0;continue}}t&&(r.length>0?r+="/..":r="..",i=2)}else r.length>0?r+=`/${e.slice(s+1,a)}`:r=e.slice(s+1,a),i=a-s-1;s=a,n=0}else o===46&&n!==-1?++n:n=-1}return r}var bh={toPosix(e){return Ig(e,"\\","/")},isUrl(e){return/^https?:/.test(this.toPosix(e))},isDataUrl(e){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(e)},hasProtocol(e){return/^[^/:]+:\//.test(this.toPosix(e))},getProtocol(e){Ne(e),e=this.toPosix(e);let t="",r=/^file:\/\/\//.exec(e),i=/^[^/:]+:\/\//.exec(e),s=/^[^/:]+:\//.exec(e);if(r||i||s){let n=r?.[0]||i?.[0]||s?.[0];t=n,e=e.slice(n.length)}return t},toAbsolute(e,t,r){if(this.isDataUrl(e))return e;let i=Fs(this.toPosix(t??w.ADAPTER.getBaseUrl())),s=Fs(this.toPosix(r??this.rootname(i)));return Ne(e),e=this.toPosix(e),e.startsWith("/")?bh.join(s,e.slice(1)):this.isAbsolute(e)?e:this.join(i,e)},normalize(e){if(e=this.toPosix(e),Ne(e),e.length===0)return".";let t="",r=e.startsWith("/");this.hasProtocol(e)&&(t=this.rootname(e),e=e.slice(t.length));let i=e.endsWith("/");return e=Rg(e,!1),e.length>0&&i&&(e+="/"),r?`/${e}`:t+e},isAbsolute(e){return Ne(e),e=this.toPosix(e),this.hasProtocol(e)?!0:e.startsWith("/")},join(...e){if(e.length===0)return".";let t;for(let r=0;r<e.length;++r){let i=e[r];if(Ne(i),i.length>0)if(t===void 0)t=i;else{let s=e[r-1]??"";this.extname(s)?t+=`/../${i}`:t+=`/${i}`}}return t===void 0?".":this.normalize(t)},dirname(e){if(Ne(e),e.length===0)return".";e=this.toPosix(e);let t=e.charCodeAt(0),r=t===47,i=-1,s=!0,n=this.getProtocol(e),o=e;e=e.slice(n.length);for(let a=e.length-1;a>=1;--a)if(t=e.charCodeAt(a),t===47){if(!s){i=a;break}}else s=!1;return i===-1?r?"/":this.isUrl(o)?n+e:n:r&&i===1?"//":n+e.slice(0,i)},rootname(e){Ne(e),e=this.toPosix(e);let t="";if(e.startsWith("/")?t="/":t=this.getProtocol(e),this.isUrl(e)){let r=e.indexOf("/",t.length);r!==-1?t=e.slice(0,r):t=e,t.endsWith("/")||(t+="/")}return t},basename(e,t){Ne(e),t&&Ne(t),e=Fs(this.toPosix(e));let r=0,i=-1,s=!0,n;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";let o=t.length-1,a=-1;for(n=e.length-1;n>=0;--n){let h=e.charCodeAt(n);if(h===47){if(!s){r=n+1;break}}else a===-1&&(s=!1,a=n+1),o>=0&&(h===t.charCodeAt(o)?--o===-1&&(i=n):(o=-1,i=a))}return r===i?i=a:i===-1&&(i=e.length),e.slice(r,i)}for(n=e.length-1;n>=0;--n)if(e.charCodeAt(n)===47){if(!s){r=n+1;break}}else i===-1&&(s=!1,i=n+1);return i===-1?"":e.slice(r,i)},extname(e){Ne(e),e=Fs(this.toPosix(e));let t=-1,r=0,i=-1,s=!0,n=0;for(let o=e.length-1;o>=0;--o){let a=e.charCodeAt(o);if(a===47){if(!s){r=o+1;break}continue}i===-1&&(s=!1,i=o+1),a===46?t===-1?t=o:n!==1&&(n=1):t!==-1&&(n=-1)}return t===-1||i===-1||n===0||n===1&&t===i-1&&t===r+1?"":e.slice(t,i)},parse(e){Ne(e);let t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;e=Fs(this.toPosix(e));let r=e.charCodeAt(0),i=this.isAbsolute(e),s,n="";t.root=this.rootname(e),i||this.hasProtocol(e)?s=1:s=0;let o=-1,a=0,h=-1,l=!0,c=e.length-1,u=0;for(;c>=s;--c){if(r=e.charCodeAt(c),r===47){if(!l){a=c+1;break}continue}h===-1&&(l=!1,h=c+1),r===46?o===-1?o=c:u!==1&&(u=1):o!==-1&&(u=-1)}return o===-1||h===-1||u===0||u===1&&o===h-1&&o===a+1?h!==-1&&(a===0&&i?t.base=t.name=e.slice(1,h):t.base=t.name=e.slice(a,h)):(a===0&&i?(t.name=e.slice(1,o),t.base=e.slice(1,h)):(t.name=e.slice(a,o),t.base=e.slice(a,h)),t.ext=e.slice(o,h)),t.dir=this.dirname(e),n&&(t.dir=n+t.dir),t},sep:"/",delimiter:":"};var Cu={};function rt(e,t,r=3){if(Cu[t])return;let i=new Error().stack;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${e}`):(i=i.split(`
`).splice(r).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${e}`),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${e}`),console.warn(i))),Cu[t]=!0}function Mu(){rt("7.0.0","skipHello is deprecated, please use settings.RENDER_OPTIONS.hello")}function Bu(){rt("7.0.0",`sayHello is deprecated, please use Renderer's "hello" option`)}var Th;function bo(){return typeof Th>"u"&&(Th=function(){let t={stencil:!0,failIfMajorPerformanceCaveat:w.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!w.ADAPTER.getWebGLRenderingContext())return!1;let r=w.ADAPTER.createCanvas(),i=r.getContext("webgl",t)||r.getContext("experimental-webgl",t),s=!!i?.getContextAttributes()?.stencil;if(i){let n=i.getExtension("WEBGL_lose_context");n&&n.loseContext()}return i=null,s}catch{return!1}}()),Th}var Cg={grad:.9,turn:360,rad:360/(2*Math.PI)},cr=function(e){return typeof e=="string"?e.length>0:typeof e=="number"},Vt=function(e,t,r){return t===void 0&&(t=0),r===void 0&&(r=Math.pow(10,t)),Math.round(r*e)/r+0},Oe=function(e,t,r){return t===void 0&&(t=0),r===void 0&&(r=1),e>r?r:e>t?e:t},ku=function(e){return(e=isFinite(e)?e%360:0)>0?e:e+360},Du=function(e){return{r:Oe(e.r,0,255),g:Oe(e.g,0,255),b:Oe(e.b,0,255),a:Oe(e.a)}},wh=function(e){return{r:Vt(e.r),g:Vt(e.g),b:Vt(e.b),a:Vt(e.a,3)}},Mg=/^#([0-9a-f]{3,8})$/i,To=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},Hu=function(e){var t=e.r,r=e.g,i=e.b,s=e.a,n=Math.max(t,r,i),o=n-Math.min(t,r,i),a=o?n===t?(r-i)/o:n===r?2+(i-t)/o:4+(t-r)/o:0;return{h:60*(a<0?a+6:a),s:n?o/n*100:0,v:n/255*100,a:s}},Xu=function(e){var t=e.h,r=e.s,i=e.v,s=e.a;t=t/360*6,r/=100,i/=100;var n=Math.floor(t),o=i*(1-r),a=i*(1-(t-n)*r),h=i*(1-(1-t+n)*r),l=n%6;return{r:255*[i,a,o,o,h,i][l],g:255*[h,i,i,a,o,o][l],b:255*[o,o,h,i,i,a][l],a:s}},Ou=function(e){return{h:ku(e.h),s:Oe(e.s,0,100),l:Oe(e.l,0,100),a:Oe(e.a)}},Fu=function(e){return{h:Vt(e.h),s:Vt(e.s),l:Vt(e.l),a:Vt(e.a,3)}},Lu=function(e){return Xu((r=(t=e).s,{h:t.h,s:(r*=((i=t.l)<50?i:100-i)/100)>0?2*r/(i+r)*100:0,v:i+r,a:t.a}));var t,r,i},Ls=function(e){return{h:(t=Hu(e)).h,s:(s=(200-(r=t.s))*(i=t.v)/100)>0&&s<200?r*i/100/(s<=100?s:200-s)*100:0,l:s/2,a:t.a};var t,r,i,s},Bg=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Dg=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Og=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Fg=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Ah={string:[[function(e){var t=Mg.exec(e);return t?(e=t[1]).length<=4?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:e.length===4?Vt(parseInt(e[3]+e[3],16)/255,2):1}:e.length===6||e.length===8?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:e.length===8?Vt(parseInt(e.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(e){var t=Og.exec(e)||Fg.exec(e);return t?t[2]!==t[4]||t[4]!==t[6]?null:Du({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(e){var t=Bg.exec(e)||Dg.exec(e);if(!t)return null;var r,i,s=Ou({h:(r=t[1],i=t[2],i===void 0&&(i="deg"),Number(r)*(Cg[i]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return Lu(s)},"hsl"]],object:[[function(e){var t=e.r,r=e.g,i=e.b,s=e.a,n=s===void 0?1:s;return cr(t)&&cr(r)&&cr(i)?Du({r:Number(t),g:Number(r),b:Number(i),a:Number(n)}):null},"rgb"],[function(e){var t=e.h,r=e.s,i=e.l,s=e.a,n=s===void 0?1:s;if(!cr(t)||!cr(r)||!cr(i))return null;var o=Ou({h:Number(t),s:Number(r),l:Number(i),a:Number(n)});return Lu(o)},"hsl"],[function(e){var t=e.h,r=e.s,i=e.v,s=e.a,n=s===void 0?1:s;if(!cr(t)||!cr(r)||!cr(i))return null;var o=function(a){return{h:ku(a.h),s:Oe(a.s,0,100),v:Oe(a.v,0,100),a:Oe(a.a)}}({h:Number(t),s:Number(r),v:Number(i),a:Number(n)});return Xu(o)},"hsv"]]},Nu=function(e,t){for(var r=0;r<t.length;r++){var i=t[r][0](e);if(i)return[i,t[r][1]]}return[null,void 0]},Lg=function(e){return typeof e=="string"?Nu(e.trim(),Ah.string):typeof e=="object"&&e!==null?Nu(e,Ah.object):[null,void 0]};var Eh=function(e,t){var r=Ls(e);return{h:r.h,s:Oe(r.s+100*t,0,100),l:r.l,a:r.a}},Sh=function(e){return(299*e.r+587*e.g+114*e.b)/1e3/255},Uu=function(e,t){var r=Ls(e);return{h:r.h,s:r.s,l:Oe(r.l+100*t,0,100),a:r.a}},Ph=function(){function e(t){this.parsed=Lg(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return e.prototype.isValid=function(){return this.parsed!==null},e.prototype.brightness=function(){return Vt(Sh(this.rgba),2)},e.prototype.isDark=function(){return Sh(this.rgba)<.5},e.prototype.isLight=function(){return Sh(this.rgba)>=.5},e.prototype.toHex=function(){return t=wh(this.rgba),r=t.r,i=t.g,s=t.b,o=(n=t.a)<1?To(Vt(255*n)):"","#"+To(r)+To(i)+To(s)+o;var t,r,i,s,n,o},e.prototype.toRgb=function(){return wh(this.rgba)},e.prototype.toRgbString=function(){return t=wh(this.rgba),r=t.r,i=t.g,s=t.b,(n=t.a)<1?"rgba("+r+", "+i+", "+s+", "+n+")":"rgb("+r+", "+i+", "+s+")";var t,r,i,s,n},e.prototype.toHsl=function(){return Fu(Ls(this.rgba))},e.prototype.toHslString=function(){return t=Fu(Ls(this.rgba)),r=t.h,i=t.s,s=t.l,(n=t.a)<1?"hsla("+r+", "+i+"%, "+s+"%, "+n+")":"hsl("+r+", "+i+"%, "+s+"%)";var t,r,i,s,n},e.prototype.toHsv=function(){return t=Hu(this.rgba),{h:Vt(t.h),s:Vt(t.s),v:Vt(t.v),a:Vt(t.a,3)};var t},e.prototype.invert=function(){return Ue({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},e.prototype.saturate=function(t){return t===void 0&&(t=.1),Ue(Eh(this.rgba,t))},e.prototype.desaturate=function(t){return t===void 0&&(t=.1),Ue(Eh(this.rgba,-t))},e.prototype.grayscale=function(){return Ue(Eh(this.rgba,-1))},e.prototype.lighten=function(t){return t===void 0&&(t=.1),Ue(Uu(this.rgba,t))},e.prototype.darken=function(t){return t===void 0&&(t=.1),Ue(Uu(this.rgba,-t))},e.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},e.prototype.alpha=function(t){return typeof t=="number"?Ue({r:(r=this.rgba).r,g:r.g,b:r.b,a:t}):Vt(this.rgba.a,3);var r},e.prototype.hue=function(t){var r=Ls(this.rgba);return typeof t=="number"?Ue({h:t,s:r.s,l:r.l,a:r.a}):Vt(r.h)},e.prototype.isEqual=function(t){return this.toHex()===Ue(t).toHex()},e}(),Ue=function(e){return e instanceof Ph?e:new Ph(e)},Gu=[],Vu=function(e){e.forEach(function(t){Gu.indexOf(t)<0&&(t(Ph,Ah),Gu.push(t))})};function zu(e,t){var r={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},i={};for(var s in r)i[r[s]]=s;var n={};e.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,h,l=i[this.toHex()];if(l)return l;if(o?.closest){var c=this.toRgb(),u=1/0,d="black";if(!n.length)for(var f in r)n[f]=new e(r[f]).toRgb();for(var p in r){var g=(a=c,h=n[p],Math.pow(a.r-h.r,2)+Math.pow(a.g-h.g,2)+Math.pow(a.b-h.b,2));g<u&&(u=g,d=p)}return d}},t.string.push([function(o){var a=o.toLowerCase(),h=a==="transparent"?"#0000":r[a];return h?new e(h).toRgb():null},"name"])}Vu([zu]);var Xi=class{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof Xi)this._value=this.cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,e))&&(this.normalize(e),this._value=this.cloneSource(e))}}get value(){return this._value}cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}isSourceEqual(e,t){let r=typeof e;if(r!==typeof t)return!1;if(r==="number"||r==="string"||e instanceof Number)return e===t;if(Array.isArray(e)&&Array.isArray(t)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return e.length!==t.length?!1:e.every((s,n)=>s===t[n]);if(e!==null&&t!==null){let s=Object.keys(e),n=Object.keys(t);return s.length!==n.length?!1:s.every(o=>e[o]===t[o])}return e===t}toRgba(){let[e,t,r,i]=this._components;return{r:e,g:t,b:r,a:i}}toRgb(){let[e,t,r]=this._components;return{r:e,g:t,b:r}}toRgbaString(){let[e,t,r]=this.toUint8RgbArray();return`rgba(${e},${t},${r},${this.alpha})`}toUint8RgbArray(e){let[t,r,i]=this._components;return e=e??[],e[0]=Math.round(t*255),e[1]=Math.round(r*255),e[2]=Math.round(i*255),e}toRgbArray(e){e=e??[];let[t,r,i]=this._components;return e[0]=t,e[1]=r,e[2]=i,e}toNumber(){return this._int}toLittleEndianNumber(){let e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){let[t,r,i,s]=Xi.temp.setValue(e)._components;return this._components[0]*=t,this._components[1]*=r,this._components[2]*=i,this._components[3]*=s,this.refreshInt(),this._value=null,this}premultiply(e,t=!0){return t&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this.refreshInt(),this._value=null,this}toPremultiplied(e,t=!0){if(e===1)return(255<<24)+this._int;if(e===0)return t?0:this._int;let r=this._int>>16&255,i=this._int>>8&255,s=this._int&255;return t&&(r=r*e+.5|0,i=i*e+.5|0,s=s*e+.5|0),(e*255<<24)+(r<<16)+(i<<8)+s}toHex(){let e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){let t=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-t.length)+t}setAlpha(e){return this._components[3]=this._clamp(e),this}round(e){let[t,r,i]=this._components;return this._components[0]=Math.round(t*e)/e,this._components[1]=Math.round(r*e)/e,this._components[2]=Math.round(i*e)/e,this.refreshInt(),this._value=null,this}toArray(e){e=e??[];let[t,r,i,s]=this._components;return e[0]=t,e[1]=r,e[2]=i,e[3]=s,e}normalize(e){let t,r,i,s;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){let n=e;t=(n>>16&255)/255,r=(n>>8&255)/255,i=(n&255)/255,s=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[t,r,i,s=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[t,r,i,s=255]=e,t/=255,r/=255,i/=255,s/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){let o=Xi.HEX_PATTERN.exec(e);o&&(e=`#${o[2]}`)}let n=Ue(e);n.isValid()&&({r:t,g:r,b:i,a:s}=n.rgba,t/=255,r/=255,i/=255)}if(t!==void 0)this._components[0]=t,this._components[1]=r,this._components[2]=i,this._components[3]=s,this.refreshInt();else throw new Error(`Unable to convert color ${e}`)}refreshInt(){this._clamp(this._components);let[e,t,r]=this._components;this._int=(e*255<<16)+(t*255<<8)+(r*255|0)}_clamp(e,t=0,r=1){return typeof e=="number"?Math.min(Math.max(e,t),r):(e.forEach((i,s)=>{e[s]=Math.min(Math.max(i,t),r)}),e)}},tt=Xi;tt.shared=new Xi;tt.temp=new Xi;tt.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;function Wu(e,t=[]){return rt("7.2.0","utils.hex2rgb is deprecated, use Color#toRgbArray instead"),tt.shared.setValue(e).toRgbArray(t)}function $u(e){return rt("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),tt.shared.setValue(e).toHex()}function ju(e){return rt("7.2.0","utils.string2hex is deprecated, use Color#toNumber instead"),tt.shared.setValue(e).toNumber()}function Yu(e){return rt("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),tt.shared.setValue(e).toNumber()}function Ng(){let e=[],t=[];for(let i=0;i<32;i++)e[i]=i,t[i]=i;e[q.NORMAL_NPM]=q.NORMAL,e[q.ADD_NPM]=q.ADD,e[q.SCREEN_NPM]=q.SCREEN,t[q.NORMAL]=q.NORMAL_NPM,t[q.ADD]=q.ADD_NPM,t[q.SCREEN]=q.SCREEN_NPM;let r=[];return r.push(t),r.push(e),r}var Ns=Ng();function qu(e,t){return Ns[t?1:0][e]}function Ku(e,t,r,i=!0){return rt("7.2.0","utils.premultiplyRgba has moved to Color.premultiply"),tt.shared.setValue(e).premultiply(t,i).toArray(r??new Float32Array(4))}function Zu(e,t){return rt("7.2.0","utils.premultiplyTint has moved to Color.toPremultiplied"),tt.shared.setValue(e).toPremultiplied(t)}function Ju(e,t,r,i=!0){return rt("7.2.0","utils.premultiplyTintToRgba has moved to Color.premultiply"),tt.shared.setValue(e).premultiply(t,i).toArray(r??new Float32Array(4))}var wo=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function Qu(e,t=null){let r=e*6;if(t=t||new Uint16Array(r),t.length!==r)throw new Error(`Out buffer length is incorrect, got ${t.length} and expected ${r}`);for(let i=0,s=0;i<r;i+=6,s+=4)t[i+0]=s+0,t[i+1]=s+1,t[i+2]=s+2,t[i+3]=s+0,t[i+4]=s+2,t[i+5]=s+3;return t}function Ar(e){if(e.BYTES_PER_ELEMENT===4)return e instanceof Float32Array?"Float32Array":e instanceof Uint32Array?"Uint32Array":"Int32Array";if(e.BYTES_PER_ELEMENT===2){if(e instanceof Uint16Array)return"Uint16Array"}else if(e.BYTES_PER_ELEMENT===1&&e instanceof Uint8Array)return"Uint8Array";return null}var Ug={Float32Array,Uint32Array,Int32Array,Uint8Array};function td(e,t){let r=0,i=0,s={};for(let h=0;h<e.length;h++)i+=t[h],r+=e[h].length;let n=new ArrayBuffer(r*4),o=null,a=0;for(let h=0;h<e.length;h++){let l=t[h],c=e[h],u=Ar(c);s[u]||(s[u]=new Ug[u](n)),o=s[u];for(let d=0;d<c.length;d++){let f=(d/l|0)*i+a,p=d%l;o[f+p]=c[d]}a+=l}return new Float32Array(n)}function Pr(e){return e+=e===0?1:0,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e+1}function Us(e){return!(e&e-1)&&!!e}function Gs(e){let t=(e>65535?1:0)<<4;e>>>=t;let r=(e>255?1:0)<<3;return e>>>=r,t|=r,r=(e>15?1:0)<<2,e>>>=r,t|=r,r=(e>3?1:0)<<1,e>>>=r,t|=r,t|e>>1}function Eo(e,t,r){let i=e.length,s;if(t>=i||r===0)return;r=t+r>i?i-t:r;let n=i-r;for(s=t;s<n;++s)e[s]=e[s+r];e.length=n}function ed(e){return e===0?0:e<0?-1:1}var Gg=0;function Ze(){return++Gg}var rd=class{constructor(e,t,r,i){this.left=e,this.top=t,this.right=r,this.bottom=i}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}},Vi=rd;Vi.EMPTY=new rd(0,0,0,0);var ks={},zt=Object.create(null),he=Object.create(null);function id(){let e;for(e in zt)zt[e].destroy();for(e in he)he[e].destroy()}function sd(){let e;for(e in zt)delete zt[e];for(e in he)delete he[e]}var So=class{constructor(t,r,i){this._canvas=w.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=i||w.RESOLUTION,this.resize(t,r)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(t,r){this._checkDestroyed(),this._canvas.width=Math.round(t*this.resolution),this._canvas.height=Math.round(r*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(t){this._checkDestroyed(),this._canvas.width=Math.round(t)}get height(){return this._checkDestroyed(),this._canvas.height}set height(t){this._checkDestroyed(),this._canvas.height=Math.round(t)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}};function nd(e,t,r){for(let i=0,s=4*r*t;i<t;++i,s+=4)if(e[s+3]!==0)return!1;return!0}function od(e,t,r,i,s){let n=4*t;for(let o=i,a=i*n+4*r;o<=s;++o,a+=n)if(e[a+3]!==0)return!1;return!0}function Ao(e){let{width:t,height:r}=e,i=e.getContext("2d",{willReadFrequently:!0});if(i===null)throw new TypeError("Failed to get canvas 2D context");let n=i.getImageData(0,0,t,r).data,o=0,a=0,h=t-1,l=r-1;for(;a<r&&nd(n,t,a);)++a;if(a===r)return Vi.EMPTY;for(;nd(n,t,l);)--l;for(;od(n,t,o,a,l);)++o;for(;od(n,t,h,a,l);)--h;return++h,++l,new Vi(o,a,h,l)}function ad(e){let t=Ao(e),{width:r,height:i}=t,s=null;if(!t.isEmpty()){let n=e.getContext("2d");if(n===null)throw new TypeError("Failed to get canvas 2D context");s=n.getImageData(t.left,t.top,r,i)}return{width:r,height:i,data:s}}function hd(e){let t=wo.exec(e);if(t)return{mediaType:t[1]?t[1].toLowerCase():void 0,subType:t[2]?t[2].toLowerCase():void 0,charset:t[3]?t[3].toLowerCase():void 0,encoding:t[4]?t[4].toLowerCase():void 0,data:t[5]}}var Po;function Io(e,t=globalThis.location){if(e.startsWith("data:"))return"";t=t||globalThis.location,Po||(Po=document.createElement("a")),Po.href=e;let r=vo.parse(Po.href),i=!r.port&&t.port===""||r.port===t.port;return r.hostname!==t.hostname||!i||r.protocol!==t.protocol?"anonymous":""}function Hs(e,t=1){let r=w.RETINA_PREFIX?.exec(e);return r?parseFloat(r[1]):t}var S=(e=>(e.Renderer="renderer",e.Application="application",e.RendererSystem="renderer-webgl-system",e.RendererPlugin="renderer-webgl-plugin",e.CanvasRendererSystem="renderer-canvas-system",e.CanvasRendererPlugin="renderer-canvas-plugin",e.Asset="asset",e.LoadParser="load-parser",e.ResolveParser="resolve-parser",e.CacheParser="cache-parser",e.DetectionParser="detection-parser",e))(S||{}),Ih=e=>{if(typeof e=="function"||typeof e=="object"&&e.extension){if(!e.extension)throw new Error("Extension class must have an extension object");e={...typeof e.extension!="object"?{type:e.extension}:e.extension,ref:e}}if(typeof e=="object")e={...e};else throw new Error("Invalid extension type");return typeof e.type=="string"&&(e.type=[e.type]),e},cd=(e,t)=>Ih(e).priority??t,P={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...e){return e.map(Ih).forEach(t=>{t.type.forEach(r=>this._removeHandlers[r]?.(t))}),this},add(...e){return e.map(Ih).forEach(t=>{t.type.forEach(r=>{let i=this._addHandlers,s=this._queue;i[r]?i[r](t):(s[r]=s[r]||[],s[r].push(t))})}),this},handle(e,t,r){let i=this._addHandlers,s=this._removeHandlers;if(i[e]||s[e])throw new Error(`Extension type ${e} already has a handler`);i[e]=t,s[e]=r;let n=this._queue;return n[e]&&(n[e].forEach(o=>t(o)),delete n[e]),this},handleByMap(e,t){return this.handle(e,r=>{t[r.name]=r.ref},r=>{delete t[r.name]})},handleByList(e,t,r=-1){return this.handle(e,i=>{t.includes(i.ref)||(t.push(i.ref),t.sort((s,n)=>cd(n,r)-cd(s,r)))},i=>{let s=t.indexOf(i.ref);s!==-1&&t.splice(s,1)})}};var Rr=class{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}};var kg=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function Hg(e){let t="";for(let r=0;r<e;++r)r>0&&(t+=`
else `),r<e-1&&(t+=`if(test == ${r}.0){}`);return t}function Ro(e,t){if(e===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");let r=t.createShader(t.FRAGMENT_SHADER);for(;;){let i=kg.replace(/%forloop%/gi,Hg(e));if(t.shaderSource(r,i),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS))e=e/2|0;else break}return e}var Rh=0,Ch=1,Mh=2,Bh=3,Dh=4,Oh=5,Nt=class{constructor(){this.data=0,this.blendMode=q.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<Rh)}set blend(t){!!(this.data&1<<Rh)!==t&&(this.data^=1<<Rh)}get offsets(){return!!(this.data&1<<Ch)}set offsets(t){!!(this.data&1<<Ch)!==t&&(this.data^=1<<Ch)}get culling(){return!!(this.data&1<<Mh)}set culling(t){!!(this.data&1<<Mh)!==t&&(this.data^=1<<Mh)}get depthTest(){return!!(this.data&1<<Bh)}set depthTest(t){!!(this.data&1<<Bh)!==t&&(this.data^=1<<Bh)}get depthMask(){return!!(this.data&1<<Oh)}set depthMask(t){!!(this.data&1<<Oh)!==t&&(this.data^=1<<Oh)}get clockwiseFrontFace(){return!!(this.data&1<<Dh)}set clockwiseFrontFace(t){!!(this.data&1<<Dh)!==t&&(this.data^=1<<Dh)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==q.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){let t=new Nt;return t.depthTest=!1,t.blend=!0,t}};var zi=[];function Wi(e,t){if(!e)return null;let r="";if(typeof e=="string"){let i=/\.(\w{3,4})(?:$|\?|#)/i.exec(e);i&&(r=i[1].toLowerCase())}for(let i=zi.length-1;i>=0;--i){let s=zi[i];if(s.test&&s.test(e,r))return new s(e,t)}throw new Error("Unrecognized source type to auto-detect Resource")}var It=class{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,r,i,s,n,o,a,h){if(arguments.length>8)throw new Error("max arguments reached");let{name:l,items:c}=this;this._aliasCount++;for(let u=0,d=c.length;u<d;u++)c[u][l](t,r,i,s,n,o,a,h);return c===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){let r=this.items.indexOf(t);return r!==-1&&(this.ensureNonAliasedItems(),this.items.splice(r,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}};Object.defineProperties(It.prototype,{dispatch:{value:It.prototype.emit},run:{value:It.prototype.emit}});var Ae=class{constructor(t=0,r=0){this._width=t,this._height=r,this.destroyed=!1,this.internal=!1,this.onResize=new It("setRealSize"),this.onUpdate=new It("update"),this.onError=new It("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,r){(t!==this._width||r!==this._height)&&(this._width=t,this._height=r,this.onResize.emit(t,r))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,r,i){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,r){return!1}};var xe=class extends Ae{constructor(t,r){let{width:i,height:s}=r||{};if(!i||!s)throw new Error("BufferResource width or height invalid");super(i,s),this.data=t}upload(t,r,i){let s=t.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===Bt.UNPACK);let n=r.realWidth,o=r.realHeight;return i.width===n&&i.height===o?s.texSubImage2D(r.target,0,0,0,n,o,r.format,i.type,this.data):(i.width=n,i.height=o,s.texImage2D(r.target,0,i.internalFormat,n,o,0,r.format,i.type,this.data)),!0}dispose(){this.data=null}static test(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array}};var Xg={scaleMode:Me.NEAREST,format:L.RGBA,alphaMode:Bt.NPM},$i=class extends Ir.default{constructor(e=null,t=null){super(),t=Object.assign({},$i.defaultOptions,t);let{alphaMode:r,mipmap:i,anisotropicLevel:s,scaleMode:n,width:o,height:a,wrapMode:h,format:l,type:c,target:u,resolution:d,resourceOptions:f}=t;e&&!(e instanceof Ae)&&(e=Wi(e,f),e.internal=!0),this.resolution=d||w.RESOLUTION,this.width=Math.round((o||0)*this.resolution)/this.resolution,this.height=Math.round((a||0)*this.resolution)/this.resolution,this._mipmap=i,this.anisotropicLevel=s,this._wrapMode=h,this._scaleMode=n,this.format=l,this.type=c,this.target=u,this.alphaMode=r,this.uid=Ze(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=o>0&&a>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(e)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)}setStyle(e,t){let r;return e!==void 0&&e!==this.scaleMode&&(this.scaleMode=e,r=!0),t!==void 0&&t!==this.mipmap&&(this.mipmap=t,r=!0),r&&this.dirtyStyleId++,this}setSize(e,t,r){return r=r||this.resolution,this.setRealSize(e*r,t*r,r)}setRealSize(e,t,r){return this.resolution=r||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(t)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=Us(this.realWidth)&&Us(this.realHeight)}setResolution(e){let t=this.resolution;return t===e?this:(this.resolution=e,this.valid&&(this.width=Math.round(this.width*t)/e,this.height=Math.round(this.height*t)/e,this.emit("update",this)),this._refreshPOT(),this)}setResource(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(e){this.emit("error",this,e)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete he[this.cacheId],delete zt[this.cacheId],this.cacheId=null),this.dispose(),$i.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(e,t,r=w.STRICT_TEXTURE_CACHE){let i=typeof e=="string",s=null;if(i)s=e;else{if(!e._pixiId){let o=t?.pixiIdPrefix||"pixiid";e._pixiId=`${o}_${Ze()}`}s=e._pixiId}let n=he[s];if(i&&r&&!n)throw new Error(`The cacheId "${s}" does not exist in BaseTextureCache.`);return n||(n=new $i(e,t),n.cacheId=s,$i.addToCache(n,s)),n}static fromBuffer(e,t,r,i){e=e||new Float32Array(t*r*4);let s=new xe(e,{width:t,height:r}),n=e instanceof Float32Array?z.FLOAT:z.UNSIGNED_BYTE;return new $i(s,Object.assign({},Xg,{type:n},i))}static addToCache(e,t){t&&(e.textureCacheIds.includes(t)||e.textureCacheIds.push(t),he[t]&&he[t]!==e&&console.warn(`BaseTexture added to the cache with an id [${t}] that already had an entry`),he[t]=e)}static removeFromCache(e){if(typeof e=="string"){let t=he[e];if(t){let r=t.textureCacheIds.indexOf(e);return r>-1&&t.textureCacheIds.splice(r,1),delete he[e],t}}else if(e?.textureCacheIds){for(let t=0;t<e.textureCacheIds.length;++t)delete he[e.textureCacheIds[t]];return e.textureCacheIds.length=0,e}return null}},W=$i;W.defaultOptions={mipmap:Kt.POW2,anisotropicLevel:0,scaleMode:Me.LINEAR,wrapMode:Ee.CLAMP,alphaMode:Bt.UNPACK,target:ar.TEXTURE_2D,format:L.RGBA,type:z.UNSIGNED_BYTE};W._globalBatch=0;var Cr=class{constructor(){this.texArray=null,this.blend=0,this.type=me.TRIANGLES,this.start=0,this.size=0,this.data=null}};var Vg=0,ut=class{constructor(t,r=!0,i=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=r,this.id=Vg++,this.disposeRunner=new It("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?ge.ELEMENT_ARRAY_BUFFER:ge.ARRAY_BUFFER}get index(){return this.type===ge.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new ut(t)}};var Mr=class{constructor(t,r=0,i=!1,s=z.FLOAT,n,o,a,h=1){this.buffer=t,this.size=r,this.normalized=i,this.type=s,this.stride=n,this.start=o,this.instance=a,this.divisor=h}destroy(){this.buffer=null}static from(t,r,i,s,n){return new Mr(t,r,i,s,n)}};var zg={Float32Array,Uint32Array,Int32Array,Uint8Array};function ud(e,t){let r=0,i=0,s={};for(let h=0;h<e.length;h++)i+=t[h],r+=e[h].length;let n=new ArrayBuffer(r*4),o=null,a=0;for(let h=0;h<e.length;h++){let l=t[h],c=e[h],u=Ar(c);s[u]||(s[u]=new zg[u](n)),o=s[u];for(let d=0;d<c.length;d++){let f=(d/l|0)*i+a,p=d%l;o[f+p]=c[d]}a+=l}return new Float32Array(n)}var dd={5126:4,5123:2,5121:1},Wg=0,$g={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},ie=class{constructor(t=[],r={}){this.buffers=t,this.indexBuffer=null,this.attributes=r,this.glVertexArrayObjects={},this.id=Wg++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new It("disposeGeometry"),this.refCount=0}addAttribute(t,r,i=0,s=!1,n,o,a,h=!1){if(!r)throw new Error("You must pass a buffer when creating an attribute");r instanceof ut||(r instanceof Array&&(r=new Float32Array(r)),r=new ut(r));let l=t.split("|");if(l.length>1){for(let u=0;u<l.length;u++)this.addAttribute(l[u],r,i,s,n);return this}let c=this.buffers.indexOf(r);return c===-1&&(this.buffers.push(r),c=this.buffers.length-1),this.attributes[t]=new Mr(c,i,s,n,o,a,h),this.instanced=this.instanced||h,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof ut||(t instanceof Array&&(t=new Uint16Array(t)),t=new ut(t)),t.type=ge.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;let t=[],r=[],i=new ut,s;for(s in this.attributes){let n=this.attributes[s],o=this.buffers[n.buffer];t.push(o.data),r.push(n.size*dd[n.type]/4),n.buffer=0}for(i.data=ud(t,r),s=0;s<this.buffers.length;s++)this.buffers[s]!==this.indexBuffer&&this.buffers[s].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(let t in this.attributes){let r=this.attributes[t];return this.buffers[r.buffer].data.length/(r.stride/4||r.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){let t=new ie;for(let r=0;r<this.buffers.length;r++)t.buffers[r]=new ut(this.buffers[r].data.slice(0));for(let r in this.attributes){let i=this.attributes[r];t.attributes[r]=new Mr(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=ge.ELEMENT_ARRAY_BUFFER),t}static merge(t){let r=new ie,i=[],s=[],n=[],o;for(let a=0;a<t.length;a++){o=t[a];for(let h=0;h<o.buffers.length;h++)s[h]=s[h]||0,s[h]+=o.buffers[h].data.length,n[h]=0}for(let a=0;a<o.buffers.length;a++)i[a]=new $g[Ar(o.buffers[a].data)](s[a]),r.buffers[a]=new ut(i[a]);for(let a=0;a<t.length;a++){o=t[a];for(let h=0;h<o.buffers.length;h++)i[h].set(o.buffers[h].data,n[h]),n[h]+=o.buffers[h].data.length}if(r.attributes=o.attributes,o.indexBuffer){r.indexBuffer=r.buffers[o.buffers.indexOf(o.indexBuffer)],r.indexBuffer.type=ge.ELEMENT_ARRAY_BUFFER;let a=0,h=0,l=0,c=0;for(let u=0;u<o.buffers.length;u++)if(o.buffers[u]!==o.indexBuffer){c=u;break}for(let u in o.attributes){let d=o.attributes[u];(d.buffer|0)===c&&(h+=d.size*dd[d.type]/4)}for(let u=0;u<t.length;u++){let d=t[u].indexBuffer.data;for(let f=0;f<d.length;f++)r.indexBuffer.data[f+l]+=a;a+=t[u].buffers[c].data.length/h,l+=d.length}}return r}};var ii=class extends ie{constructor(t=!1){super(),this._buffer=new ut(null,t,!1),this._indexBuffer=new ut(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,z.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,z.FLOAT).addAttribute("aColor",this._buffer,4,!0,z.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,z.FLOAT).addIndex(this._indexBuffer)}};var Br=Math.PI*2,Fh=180/Math.PI,Lh=Math.PI/180,pt=(e=>(e[e.POLY=0]="POLY",e[e.RECT=1]="RECT",e[e.CIRC=2]="CIRC",e[e.ELIP=3]="ELIP",e[e.RREC=4]="RREC",e))(pt||{});var Q=class{constructor(t=0,r=0){this.x=0,this.y=0,this.x=t,this.y=r}clone(){return new Q(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,r=t){return this.x=t,this.y=r,this}toString(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`}};var Co=[new Q,new Q,new Q,new Q],$=class{constructor(t=0,r=0,i=0,s=0){this.x=Number(t),this.y=Number(r),this.width=Number(i),this.height=Number(s),this.type=pt.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new $(0,0,0,0)}clone(){return new $(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,r){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&r>=this.y&&r<this.y+this.height}intersects(t,r){if(!r){let R=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=R)return!1;let C=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>C}let i=this.left,s=this.right,n=this.top,o=this.bottom;if(s<=i||o<=n)return!1;let a=Co[0].set(t.left,t.top),h=Co[1].set(t.left,t.bottom),l=Co[2].set(t.right,t.top),c=Co[3].set(t.right,t.bottom);if(l.x<=a.x||h.y<=a.y)return!1;let u=Math.sign(r.a*r.d-r.b*r.c);if(u===0||(r.apply(a,a),r.apply(h,h),r.apply(l,l),r.apply(c,c),Math.max(a.x,h.x,l.x,c.x)<=i||Math.min(a.x,h.x,l.x,c.x)>=s||Math.max(a.y,h.y,l.y,c.y)<=n||Math.min(a.y,h.y,l.y,c.y)>=o))return!1;let d=u*(h.y-a.y),f=u*(a.x-h.x),p=d*i+f*n,g=d*s+f*n,_=d*i+f*o,y=d*s+f*o;if(Math.max(p,g,_,y)<=d*a.x+f*a.y||Math.min(p,g,_,y)>=d*c.x+f*c.y)return!1;let T=u*(a.y-l.y),x=u*(l.x-a.x),v=T*i+x*n,N=T*s+x*n,k=T*i+x*o,B=T*s+x*o;return!(Math.max(v,N,k,B)<=T*a.x+x*a.y||Math.min(v,N,k,B)>=T*c.x+x*c.y)}pad(t=0,r=t){return this.x-=t,this.y-=r,this.width+=t*2,this.height+=r*2,this}fit(t){let r=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),s=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=r,this.width=Math.max(i-r,0),this.y=s,this.height=Math.max(n-s,0),this}ceil(t=1,r=.001){let i=Math.ceil((this.x+this.width-r)*t)/t,s=Math.ceil((this.y+this.height-r)*t)/t;return this.x=Math.floor((this.x+r)*t)/t,this.y=Math.floor((this.y+r)*t)/t,this.width=i-this.x,this.height=s-this.y,this}enlarge(t){let r=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),s=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=r,this.width=i-r,this.y=s,this.height=n-s,this}toString(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}};var si=class{constructor(t=0,r=0,i=0){this.x=t,this.y=r,this.radius=i,this.type=pt.CIRC}clone(){return new si(this.x,this.y,this.radius)}contains(t,r){if(this.radius<=0)return!1;let i=this.radius*this.radius,s=this.x-t,n=this.y-r;return s*=s,n*=n,s+n<=i}getBounds(){return new $(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}toString(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}};var ni=class{constructor(t=0,r=0,i=0,s=0){this.x=t,this.y=r,this.width=i,this.height=s,this.type=pt.ELIP}clone(){return new ni(this.x,this.y,this.width,this.height)}contains(t,r){if(this.width<=0||this.height<=0)return!1;let i=(t-this.x)/this.width,s=(r-this.y)/this.height;return i*=i,s*=s,i+s<=1}getBounds(){return new $(this.x-this.width,this.y-this.height,this.width,this.height)}toString(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}};var Ge=class{constructor(...t){let r=Array.isArray(t[0])?t[0]:t;if(typeof r[0]!="number"){let i=[];for(let s=0,n=r.length;s<n;s++)i.push(r[s].x,r[s].y);r=i}this.points=r,this.type=pt.POLY,this.closeStroke=!0}clone(){let t=this.points.slice(),r=new Ge(t);return r.closeStroke=this.closeStroke,r}contains(t,r){let i=!1,s=this.points.length/2;for(let n=0,o=s-1;n<s;o=n++){let a=this.points[n*2],h=this.points[n*2+1],l=this.points[o*2],c=this.points[o*2+1];h>r!=c>r&&t<(l-a)*((r-h)/(c-h))+a&&(i=!i)}return i}toString(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((t,r)=>`${t}, ${r}`,"")}]`}};var oi=class{constructor(t=0,r=0,i=0,s=0,n=20){this.x=t,this.y=r,this.width=i,this.height=s,this.radius=n,this.type=pt.RREC}clone(){return new oi(this.x,this.y,this.width,this.height,this.radius)}contains(t,r){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&r>=this.y&&r<=this.y+this.height){let i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(r>=this.y+i&&r<=this.y+this.height-i||t>=this.x+i&&t<=this.x+this.width-i)return!0;let s=t-(this.x+i),n=r-(this.y+i),o=i*i;if(s*s+n*n<=o||(s=t-(this.x+this.width-i),s*s+n*n<=o)||(n=r-(this.y+this.height-i),s*s+n*n<=o)||(s=t-(this.x+i),s*s+n*n<=o))return!0}return!1}toString(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}};var st=class{constructor(t=1,r=0,i=0,s=1,n=0,o=0){this.array=null,this.a=t,this.b=r,this.c=i,this.d=s,this.tx=n,this.ty=o}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,r,i,s,n,o){return this.a=t,this.b=r,this.c=i,this.d=s,this.tx=n,this.ty=o,this}toArray(t,r){this.array||(this.array=new Float32Array(9));let i=r||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(t,r){r=r||new Q;let i=t.x,s=t.y;return r.x=this.a*i+this.c*s+this.tx,r.y=this.b*i+this.d*s+this.ty,r}applyInverse(t,r){r=r||new Q;let i=1/(this.a*this.d+this.c*-this.b),s=t.x,n=t.y;return r.x=this.d*i*s+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,r.y=this.a*i*n+-this.b*i*s+(-this.ty*this.a+this.tx*this.b)*i,r}translate(t,r){return this.tx+=t,this.ty+=r,this}scale(t,r){return this.a*=t,this.d*=r,this.c*=t,this.b*=r,this.tx*=t,this.ty*=r,this}rotate(t){let r=Math.cos(t),i=Math.sin(t),s=this.a,n=this.c,o=this.tx;return this.a=s*r-this.b*i,this.b=s*i+this.b*r,this.c=n*r-this.d*i,this.d=n*i+this.d*r,this.tx=o*r-this.ty*i,this.ty=o*i+this.ty*r,this}append(t){let r=this.a,i=this.b,s=this.c,n=this.d;return this.a=t.a*r+t.b*s,this.b=t.a*i+t.b*n,this.c=t.c*r+t.d*s,this.d=t.c*i+t.d*n,this.tx=t.tx*r+t.ty*s+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this}setTransform(t,r,i,s,n,o,a,h,l){return this.a=Math.cos(a+l)*n,this.b=Math.sin(a+l)*n,this.c=-Math.sin(a-h)*o,this.d=Math.cos(a-h)*o,this.tx=t-(i*this.a+s*this.c),this.ty=r-(i*this.b+s*this.d),this}prepend(t){let r=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){let i=this.a,s=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=s*t.a+this.d*t.c,this.d=s*t.b+this.d*t.d}return this.tx=r*t.a+this.ty*t.c+t.tx,this.ty=r*t.b+this.ty*t.d+t.ty,this}decompose(t){let r=this.a,i=this.b,s=this.c,n=this.d,o=t.pivot,a=-Math.atan2(-s,n),h=Math.atan2(i,r),l=Math.abs(a+h);return l<1e-5||Math.abs(Br-l)<1e-5?(t.rotation=h,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=a,t.skew.y=h),t.scale.x=Math.sqrt(r*r+i*i),t.scale.y=Math.sqrt(s*s+n*n),t.position.x=this.tx+(o.x*r+o.y*s),t.position.y=this.ty+(o.x*i+o.y*n),t}invert(){let t=this.a,r=this.b,i=this.c,s=this.d,n=this.tx,o=t*s-r*i;return this.a=s/o,this.b=-r/o,this.c=-i/o,this.d=t/o,this.tx=(i*this.ty-s*n)/o,this.ty=-(t*this.ty-r*n)/o,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){let t=new st;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}toString(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return new st}static get TEMP_MATRIX(){return new st}};var ai=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],hi=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],li=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],ci=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Nh=[],fd=[],Mo=Math.sign;function jg(){for(let e=0;e<16;e++){let t=[];Nh.push(t);for(let r=0;r<16;r++){let i=Mo(ai[e]*ai[r]+li[e]*hi[r]),s=Mo(hi[e]*ai[r]+ci[e]*hi[r]),n=Mo(ai[e]*li[r]+li[e]*ci[r]),o=Mo(hi[e]*li[r]+ci[e]*ci[r]);for(let a=0;a<16;a++)if(ai[a]===i&&hi[a]===s&&li[a]===n&&ci[a]===o){t.push(a);break}}}for(let e=0;e<16;e++){let t=new st;t.set(ai[e],hi[e],li[e],ci[e],0,0),fd.push(t)}}jg();var gt={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:e=>ai[e],uY:e=>hi[e],vX:e=>li[e],vY:e=>ci[e],inv:e=>e&8?e&15:-e&7,add:(e,t)=>Nh[e][t],sub:(e,t)=>Nh[e][gt.inv(t)],rotate180:e=>e^4,isVertical:e=>(e&3)===2,byDirection:(e,t)=>Math.abs(e)*2<=Math.abs(t)?t>=0?gt.S:gt.N:Math.abs(t)*2<=Math.abs(e)?e>0?gt.E:gt.W:t>0?e>0?gt.SE:gt.SW:e>0?gt.NE:gt.NW,matrixAppendRotationInv:(e,t,r=0,i=0)=>{let s=fd[gt.inv(t)];s.tx=r,s.ty=i,e.append(s)}};var _e=class{constructor(t,r,i=0,s=0){this._x=i,this._y=s,this.cb=t,this.scope=r}clone(t=this.cb,r=this.scope){return new _e(t,r,this._x,this._y)}set(t=0,r=t){return(this._x!==t||this._y!==r)&&(this._x=t,this._y=r,this.cb.call(this.scope)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[@pixi/math:ObservablePoint x=0 y=0 scope=${this.scope}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}};var pd=class{constructor(){this.worldTransform=new st,this.localTransform=new st,this.position=new _e(this.onChange,this,0,0),this.scale=new _e(this.onChange,this,1,1),this.pivot=new _e(this.onChange,this,0,0),this.skew=new _e(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}toString(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}updateLocalTransform(){let e=this.localTransform;this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(e){let t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==e._worldID){let r=e.worldTransform,i=this.worldTransform;i.a=t.a*r.a+t.b*r.c,i.b=t.a*r.b+t.b*r.d,i.c=t.c*r.a+t.d*r.c,i.d=t.c*r.b+t.d*r.d,i.tx=t.tx*r.a+t.ty*r.c+r.tx,i.ty=t.tx*r.b+t.ty*r.d+r.ty,this._parentID=e._worldID,this._worldID++}}setFromMatrix(e){e.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this.updateSkew())}},ui=pd;ui.IDENTITY=new pd;var md=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`;var gd=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function Bo(e,t,r){let i=e.createShader(t);return e.shaderSource(i,r),e.compileShader(i),i}function Uh(e){let t=new Array(e);for(let r=0;r<t.length;r++)t[r]=!1;return t}function Xs(e,t){switch(e){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return Uh(2*t);case"bvec3":return Uh(3*t);case"bvec4":return Uh(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var Je=[{test:e=>e.type==="float"&&e.size===1&&!e.isArray,code:e=>`
            if(uv["${e}"] !== ud["${e}"].value)
            {
                ud["${e}"].value = uv["${e}"]
                gl.uniform1f(ud["${e}"].location, uv["${e}"])
            }
            `},{test:(e,t)=>(e.type==="sampler2D"||e.type==="samplerCube"||e.type==="sampler2DArray")&&e.size===1&&!e.isArray&&(t==null||t.castToBaseTexture!==void 0),code:e=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${e}"], t);

            if(ud["${e}"].value !== t)
            {
                ud["${e}"].value = t;
                gl.uniform1i(ud["${e}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(e,t)=>e.type==="mat3"&&e.size===1&&!e.isArray&&t.a!==void 0,code:e=>`
            gl.uniformMatrix3fv(ud["${e}"].location, false, uv["${e}"].toArray(true));
            `,codeUbo:e=>`
                var ${e}_matrix = uv.${e}.toArray(true);

                data[offset] = ${e}_matrix[0];
                data[offset+1] = ${e}_matrix[1];
                data[offset+2] = ${e}_matrix[2];
        
                data[offset + 4] = ${e}_matrix[3];
                data[offset + 5] = ${e}_matrix[4];
                data[offset + 6] = ${e}_matrix[5];
        
                data[offset + 8] = ${e}_matrix[6];
                data[offset + 9] = ${e}_matrix[7];
                data[offset + 10] = ${e}_matrix[8];
            `},{test:(e,t)=>e.type==="vec2"&&e.size===1&&!e.isArray&&t.x!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${e}"].location, v.x, v.y);
                }`,codeUbo:e=>`
                v = uv.${e};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:e=>e.type==="vec2"&&e.size===1&&!e.isArray,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${e}"].location, v[0], v[1]);
                }
            `},{test:(e,t)=>e.type==="vec4"&&e.size===1&&!e.isArray&&t.width!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${e}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:e=>`
                    v = uv.${e};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(e,t)=>e.type==="vec4"&&e.size===1&&!e.isArray&&t.red!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${e}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:e=>`
                    v = uv.${e};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(e,t)=>e.type==="vec3"&&e.size===1&&!e.isArray&&t.red!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${e}"].location, v.red, v.green, v.blue)
                }`,codeUbo:e=>`
                    v = uv.${e};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:e=>e.type==="vec4"&&e.size===1&&!e.isArray,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${e}"].location, v[0], v[1], v[2], v[3])
                }`}];var Yg={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},qg={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function Gh(e,t){let r=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(let i in e.uniforms){let s=t[i];if(!s){e.uniforms[i]?.group&&(e.uniforms[i].ubo?r.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${i}, '${i}');
                    `):r.push(`
                        renderer.shader.syncUniformGroup(uv.${i}, syncData);
                    `));continue}let n=e.uniforms[i],o=!1;for(let a=0;a<Je.length;a++)if(Je[a].test(s,n)){r.push(Je[a].code(i,n)),o=!0;break}if(!o){let h=(s.size===1&&!s.isArray?Yg:qg)[s.type].replace("location",`ud["${i}"].location`);r.push(`
            cu = ud["${i}"];
            cv = cu.value;
            v = uv["${i}"];
            ${h};`)}}return new Function("ud","uv","renderer","syncData",r.join(`
`))}var xd={},Do=xd;function Oo(){if(Do===xd||Do?.isContextLost()){let e=w.ADAPTER.createCanvas(),t;w.PREFER_ENV>=we.WEBGL2&&(t=e.getContext("webgl2",{})),t||(t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),Do=t}return Do}var Fo;function kh(){if(!Fo){Fo=oe.MEDIUM;let e=Oo();e&&e.getShaderPrecisionFormat&&(Fo=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision?oe.HIGH:oe.MEDIUM)}return Fo}function _d(e,t){let r=e.getShaderSource(t).split(`
`).map((l,c)=>`${c}: ${l}`),i=e.getShaderInfoLog(t),s=i.split(`
`),n={},o=s.map(l=>parseFloat(l.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(l=>l&&!n[l]?(n[l]=!0,!0):!1),a=[""];o.forEach(l=>{r[l-1]=`%c${r[l-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});let h=r.join(`
`);a[0]=h,console.error(i),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function Hh(e,t,r,i){e.getProgramParameter(t,e.LINK_STATUS)||(e.getShaderParameter(r,e.COMPILE_STATUS)||_d(e,r),e.getShaderParameter(i,e.COMPILE_STATUS)||_d(e,i),console.error("PixiJS Error: Could not initialize shader."),e.getProgramInfoLog(t)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",e.getProgramInfoLog(t)))}var Kg={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Vs(e){return Kg[e]}var Lo=null,yd={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function zs(e,t){if(!Lo){let r=Object.keys(yd);Lo={};for(let i=0;i<r.length;++i){let s=r[i];Lo[e[s]]=yd[s]}}return Lo[t]}function No(e,t,r){if(e.substring(0,9)!=="precision"){let i=t;return t===oe.HIGH&&r!==oe.HIGH&&(i=oe.MEDIUM),`precision ${i} float;
${e}`}else if(r!==oe.HIGH&&e.substring(0,15)==="precision highp")return e.replace("precision highp","precision mediump");return e}var Ws;function Uo(){if(typeof Ws=="boolean")return Ws;try{Ws=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{Ws=!1}return Ws}var Zg=0,Go={},ji=class{constructor(e,t,r="pixi-shader",i={}){this.extra={},this.id=Zg++,this.vertexSrc=e||ji.defaultVertexSrc,this.fragmentSrc=t||ji.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=i,this.vertexSrc.substring(0,8)!=="#version"&&(r=r.replace(/\s+/g,"-"),Go[r]?(Go[r]++,r+=`-${Go[r]}`):Go[r]=1,this.vertexSrc=`#define SHADER_NAME ${r}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${r}
${this.fragmentSrc}`,this.vertexSrc=No(this.vertexSrc,ji.defaultVertexPrecision,oe.HIGH),this.fragmentSrc=No(this.fragmentSrc,ji.defaultFragmentPrecision,kh())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return gd}static get defaultFragmentSrc(){return md}static from(e,t,r){let i=e+t,s=ks[i];return s||(ks[i]=s=new ji(e,t,r)),s}},Wt=ji;Wt.defaultVertexPrecision=oe.HIGH;Wt.defaultFragmentPrecision=Be.apple.device?oe.HIGH:oe.MEDIUM;var Jg=0,Ut=class{constructor(t,r,i){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=Jg++,this.static=!!r,this.ubo=!!i,t instanceof ut?(this.buffer=t,this.buffer.type=ge.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new ut(new Float32Array(1)),this.buffer.type=ge.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,r,i){if(!this.ubo)this.uniforms[t]=new Ut(r,i);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(t,r,i){return new Ut(t,r,i)}static uboFrom(t,r){return new Ut(t,r??!0,!0)}};var Gt=class{constructor(t,r){this.uniformBindCount=0,this.program=t,r?r instanceof Ut?this.uniformGroup=r:this.uniformGroup=new Ut(r):this.uniformGroup=new Ut({}),this.disposeRunner=new It("disposeShader")}checkUniformExists(t,r){if(r.uniforms[t])return!0;for(let i in r.uniforms){let s=r.uniforms[i];if(s.group&&this.checkUniformExists(t,s))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,r,i){let s=Wt.from(t,r);return new Gt(s,i)}};var $s=class{constructor(t,r){if(this.vertexSrc=t,this.fragTemplate=r,this.programCache={},this.defaultGroupCache={},!r.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!r.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){let i=new Int32Array(t);for(let n=0;n<t;n++)i[n]=n;this.defaultGroupCache[t]=Ut.from({uSamplers:i},!0);let s=this.fragTemplate;s=s.replace(/%count%/gi,`${t}`),s=s.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new Wt(this.vertexSrc,s)}let r={tint:new Float32Array([1,1,1,1]),translationMatrix:new st,default:this.defaultGroupCache[t]};return new Gt(this.programCache[t],r)}generateSampleSrc(t){let r="";r+=`
`,r+=`
`;for(let i=0;i<t;i++)i>0&&(r+=`
else `),i<t-1&&(r+=`if(vTextureId < ${i}.5)`),r+=`
{`,r+=`
	color = texture2D(uSamplers[${i}], vTextureCoord);`,r+=`
}`;return r+=`
`,r+=`
`,r}};var Dr=class{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}};function vd(){return!Be.apple.device}function bd(e){let t=!0,r=w.ADAPTER.getNavigator();if(Be.tablet||Be.phone){if(Be.apple.device){let i=r.userAgent.match(/OS (\d+)_(\d+)?/);i&&parseInt(i[1],10)<11&&(t=!1)}if(Be.android.device){let i=r.userAgent.match(/Android\s([0-9.]*)/);i&&parseInt(i[1],10)<7&&(t=!1)}}return t?e:4}var ke=class{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}};var Td=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`;var wd=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;var He=class extends ke{constructor(e){super(e),this.setShaderGenerator(),this.geometryClass=ii,this.vertexSize=6,this.state=Nt.for2d(),this.size=He.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??bd(32),this._defaultMaxTextures}static set defaultMaxTextures(e){this._defaultMaxTextures=e}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??vd(),this._canUploadSameBuffer}static set canUploadSameBuffer(e){this._canUploadSameBuffer=e}get MAX_TEXTURES(){return rt("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return wd}static get defaultFragmentTemplate(){return Td}setShaderGenerator({vertex:e=He.defaultVertexSrc,fragment:t=He.defaultFragmentTemplate}={}){this.shaderGenerator=new $s(e,t)}contextChange(){let e=this.renderer.gl;w.PREFER_ENV===we.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),He.defaultMaxTextures),this.maxTextures=Ro(this.maxTextures,e)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){let{_drawCallPool:e,_textureArrayPool:t}=He,r=this.size/4,i=Math.floor(r/this.maxTextures)+1;for(;e.length<r;)e.push(new Cr);for(;t.length<i;)t.push(new Dr);for(let s=0;s<this.maxTextures;s++)this._tempBoundTextures[s]=null}onPrerender(){this._flushId=0}render(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)}buildTexturesAndDrawCalls(){let{_bufferedTextures:e,maxTextures:t}=this,r=He._textureArrayPool,i=this.renderer.batch,s=this._tempBoundTextures,n=this.renderer.textureGC.count,o=++W._globalBatch,a=0,h=r[0],l=0;i.copyBoundTextures(s,t);for(let c=0;c<this._bufferSize;++c){let u=e[c];e[c]=null,u._batchEnabled!==o&&(h.count>=t&&(i.boundArray(h,s,o,t),this.buildDrawCalls(h,l,c),l=c,h=r[++a],++o),u._batchEnabled=o,u.touched=n,h.elements[h.count++]=u)}h.count>0&&(i.boundArray(h,s,o,t),this.buildDrawCalls(h,l,this._bufferSize),++a,++o);for(let c=0;c<s.length;c++)s[c]=null;W._globalBatch=o}buildDrawCalls(e,t,r){let{_bufferedElements:i,_attributeBuffer:s,_indexBuffer:n,vertexSize:o}=this,a=He._drawCallPool,h=this._dcIndex,l=this._aIndex,c=this._iIndex,u=a[h];u.start=this._iIndex,u.texArray=e;for(let d=t;d<r;++d){let f=i[d],p=f._texture.baseTexture,g=Ns[p.alphaMode?1:0][f.blendMode];i[d]=null,t<d&&u.blend!==g&&(u.size=c-u.start,t=d,u=a[++h],u.texArray=e,u.start=c),this.packInterleavedGeometry(f,s,n,l,c),l+=f.vertexData.length/2*o,c+=f.indices.length,u.blend=g}t<r&&(u.size=c-u.start,++h),this._dcIndex=h,this._aIndex=l,this._iIndex=c}bindAndClearTexArray(e){let t=this.renderer.texture;for(let r=0;r<e.count;r++)t.bind(e.elements[r],e.ids[r]),e.elements[r]=null;e.count=0}updateGeometry(){let{_packedGeometries:e,_attributeBuffer:t,_indexBuffer:r}=this;He.canUploadSameBuffer?(e[this._flushId]._buffer.update(t.rawBinaryData),e[this._flushId]._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(t.rawBinaryData),e[this._flushId]._indexBuffer.update(r),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){let e=this._dcIndex,{gl:t,state:r}=this.renderer,i=He._drawCallPool,s=null;for(let n=0;n<e;n++){let{texArray:o,type:a,size:h,start:l,blend:c}=i[n];s!==o&&(s=o,this.bindAndClearTexArray(o)),this.state.blendMode=c,r.set(this.state),t.drawElements(a,h,t.UNSIGNED_SHORT,l*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),He.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(e){let t=Pr(Math.ceil(e/8)),r=Gs(t),i=t*8;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);let s=this._aBuffers[i];return s||(this._aBuffers[i]=s=new Rr(i*this.vertexSize*4)),s}getIndexBuffer(e){let t=Pr(Math.ceil(e/12)),r=Gs(t),i=t*12;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);let s=this._iBuffers[r];return s||(this._iBuffers[r]=s=new Uint16Array(i)),s}packInterleavedGeometry(e,t,r,i,s){let{uint32View:n,float32View:o}=t,a=i/this.vertexSize,h=e.uvs,l=e.indices,c=e.vertexData,u=e._texture.baseTexture._batchLocation,d=Math.min(e.worldAlpha,1),f=tt.shared.setValue(e._tintRGB).toPremultiplied(d,e._texture.baseTexture.alphaMode>0);for(let p=0;p<c.length;p+=2)o[i++]=c[p],o[i++]=c[p+1],o[i++]=h[p],o[i++]=h[p+1],n[i++]=f,o[i++]=u;for(let p=0;p<l.length;p++)r[s++]=a+l[p]}},Pe=He;Pe.defaultBatchSize=4096;Pe.extension={name:"batch",type:S.RendererPlugin};Pe._drawCallPool=[];Pe._textureArrayPool=[];P.add(Pe);var Ed=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`;var Sd=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;var js=class extends Gt{constructor(e,t,r){let i=Wt.from(e||js.defaultVertexSrc,t||js.defaultFragmentSrc);super(i,r),this.padding=0,this.resolution=js.defaultResolution,this.multisample=js.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new Nt}apply(e,t,r,i,s){e.applyFilter(this,t,r,i)}get blendMode(){return this.state.blendMode}set blendMode(e){this.state.blendMode=e}get resolution(){return this._resolution}set resolution(e){this._resolution=e}static get defaultVertexSrc(){return Sd}static get defaultFragmentSrc(){return Ed}},ft=js;ft.defaultResolution=1;ft.defaultMultisample=dt.NONE;var ur=class{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new tt(0),this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender;let{backgroundColor:r,background:i,backgroundAlpha:s}=t,n=i??r;n!==void 0&&(this.color=n),this.alpha=s}get color(){return this._backgroundColor.value}set color(t){this._backgroundColor.setValue(t)}get alpha(){return this._backgroundColor.alpha}set alpha(t){this._backgroundColor.setAlpha(t)}get backgroundColor(){return this._backgroundColor}destroy(){}};ur.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0};ur.extension={type:[S.RendererSystem,S.CanvasRendererSystem],name:"background"};P.add(ur);var Yi=class{constructor(t){this.renderer=t,this.emptyRenderer=new ke(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,r){let{boundTextures:i}=this.renderer.texture;for(let s=r-1;s>=0;--s)t[s]=i[s]||null,t[s]&&(t[s]._batchLocation=s)}boundArray(t,r,i,s){let{elements:n,ids:o,count:a}=t,h=0;for(let l=0;l<a;l++){let c=n[l],u=c._batchLocation;if(u>=0&&u<s&&r[u]===c){o[l]=u;continue}for(;h<s;){let d=r[h];if(d&&d._batchEnabled===i&&d._batchLocation===h){h++;continue}o[l]=h,c._batchLocation=h,r[h]=c;break}}}destroy(){this.renderer=null}};Yi.extension={type:S.RendererSystem,name:"batch"};P.add(Yi);var Ad=0,dr=class{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=Ad++}init(t){if(t.context)this.initFromContext(t.context);else{let r=this.renderer.background.alpha<1,i=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:r,premultipliedAlpha:i,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=Ad++,this.renderer.runners.contextChange.emit(t);let r=this.renderer.view;r.addEventListener!==void 0&&(r.addEventListener("webglcontextlost",this.handleContextLost,!1),r.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){let r=this.createContext(this.renderer.view,t);this.initFromContext(r)}createContext(t,r){let i;if(w.PREFER_ENV>=we.WEBGL2&&(i=t.getContext("webgl2",r)),i)this.webGLVersion=2;else if(this.webGLVersion=1,i=t.getContext("webgl",r)||t.getContext("experimental-webgl",r),!i)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),this.gl}getExtensions(){let{gl:t}=this,r={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,r,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,r,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){let t=this.renderer.view;this.renderer=null,t.removeEventListener!==void 0&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){let r=t.getContextAttributes(),i="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;i&&(this.webGLVersion=2),r&&!r.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");let s=i||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=s,s||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}};dr.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"};dr.extension={type:S.RendererSystem,name:"context"};P.add(dr);var ko=class extends xe{upload(t,r,i){let s=t.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===Bt.UNPACK);let n=r.realWidth,o=r.realHeight;return i.width===n&&i.height===o?s.texSubImage2D(r.target,0,0,0,n,o,r.format,i.type,this.data):(i.width=n,i.height=o,s.texImage2D(r.target,0,i.internalFormat,n,o,0,r.format,i.type,this.data)),!0}};var Or=class{constructor(t,r){this.width=Math.round(t||100),this.height=Math.round(r||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new It("disposeFramebuffer"),this.multisample=dt.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,r){return this.colorTextures[t]=r||new W(null,{scaleMode:Me.NEAREST,resolution:1,mipmap:Kt.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new W(new ko(null,{width:this.width,height:this.height}),{scaleMode:Me.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:Kt.OFF,format:L.DEPTH_COMPONENT,type:z.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,r){if(t=Math.round(t),r=Math.round(r),!(t===this.width&&r===this.height)){this.width=t,this.height=r,this.dirtyId++,this.dirtySize++;for(let i=0;i<this.colorTextures.length;i++){let s=this.colorTextures[i],n=s.resolution;s.setSize(t/n,r/n)}if(this.depthTexture){let i=this.depthTexture.resolution;this.depthTexture.setSize(t/i,r/i)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}};var di=class extends W{constructor(t={}){if(typeof t=="number"){let r=arguments[0],i=arguments[1],s=arguments[2],n=arguments[3];t={width:r,height:i,scaleMode:s,resolution:n}}t.width=t.width||100,t.height=t.height||100,t.multisample??(t.multisample=dt.NONE),super(null,t),this.mipmap=Kt.OFF,this.valid=!0,this._clear=new tt([0,0,0,0]),this.framebuffer=new Or(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(t){this._clear.setValue(t)}get clearColor(){return this._clear.value}get clear(){return this._clear}resize(t,r){this.framebuffer.resize(t*this.resolution,r*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}};var Zt=class extends Ae{constructor(t){let r=t,i=r.naturalWidth||r.videoWidth||r.width,s=r.naturalHeight||r.videoHeight||r.height;super(i,s),this.source=t,this.noSubImage=!1}static crossOrigin(t,r,i){i===void 0&&!r.startsWith("data:")?t.crossOrigin=Io(r):i!==!1&&(t.crossOrigin=typeof i=="string"?i:"anonymous")}upload(t,r,i,s){let n=t.gl,o=r.realWidth,a=r.realHeight;if(s=s||this.source,typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement){if(!s.complete||s.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement&&s.readyState<=1&&s.buffered.length===0)return!1;return n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===Bt.UNPACK),!this.noSubImage&&r.target===n.TEXTURE_2D&&i.width===o&&i.height===a?n.texSubImage2D(n.TEXTURE_2D,0,0,0,r.format,i.type,s):(i.width=o,i.height=a,n.texImage2D(r.target,0,i.internalFormat,r.format,i.type,s)),!0}update(){if(this.destroyed)return;let t=this.source,r=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;this.resize(r,i),super.update()}dispose(){this.source=null}};var Fr=class extends Zt{constructor(t,r){if(r=r||{},typeof t=="string"){let i=new Image;Zt.crossOrigin(i,t,r.crossorigin),i.src=t,t=i}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(r.createBitmap??w.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,this.bitmap=null,this._load=null,r.autoLoad!==!1&&this.load()}load(t){return this._load?this._load:(t!==void 0&&(this.createBitmap=t),this._load=new Promise((r,i)=>{let s=this.source;this.url=s.src;let n=()=>{this.destroyed||(s.onload=null,s.onerror=null,this.resize(s.width,s.height),this._load=null,this.createBitmap?r(this.process()):r(this))};s.complete&&s.src?n():(s.onload=n,s.onerror=o=>{i(o),this.onError.emit(o)})}),this._load)}process(){let t=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);let r=globalThis.createImageBitmap,i=!t.crossOrigin||t.crossOrigin==="anonymous";return this._process=fetch(t.src,{mode:i?"cors":"no-cors"}).then(s=>s.blob()).then(s=>r(s,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Bt.UNPACK?"premultiply":"none"})).then(s=>this.destroyed?Promise.reject():(this.bitmap=s,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(t,r,i){if(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,r,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,r,i,this.bitmap),!this.preserveBitmap){let s=!0,n=r._glTextures;for(let o in n){let a=n[o];if(a!==i&&a.dirtyId!==r.dirtyId){s=!1;break}}s&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return typeof HTMLImageElement<"u"&&(typeof t=="string"||t instanceof HTMLImageElement)}};var qi=class{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,r,i){let s=r.width,n=r.height;if(i){let o=t.width/2/s,a=t.height/2/n,h=t.x/s+o,l=t.y/n+a;i=gt.add(i,gt.NW),this.x0=h+o*gt.uX(i),this.y0=l+a*gt.uY(i),i=gt.add(i,2),this.x1=h+o*gt.uX(i),this.y1=l+a*gt.uY(i),i=gt.add(i,2),this.x2=h+o*gt.uX(i),this.y2=l+a*gt.uY(i),i=gt.add(i,2),this.x3=h+o*gt.uX(i),this.y3=l+a*gt.uY(i)}else this.x0=t.x/s,this.y0=t.y/n,this.x1=(t.x+t.width)/s,this.y1=t.y/n,this.x2=(t.x+t.width)/s,this.y2=(t.y+t.height)/n,this.x3=t.x/s,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}toString(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`}};var Pd=new qi;function Ho(e){e.destroy=function(){},e.on=function(){},e.once=function(){},e.emit=function(){}}var H=class extends Ir.default{constructor(t,r,i,s,n,o,a){if(super(),this.noFrame=!1,r||(this.noFrame=!0,r=new $(0,0,1,1)),t instanceof H&&(t=t.baseTexture),this.baseTexture=t,this._frame=r,this.trim=s,this.valid=!1,this._uvs=Pd,this.uvMatrix=null,this.orig=i||r,this._rotate=Number(n||0),n===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=o?new Q(o.x,o.y):new Q(0,0),this.defaultBorders=a,this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=r:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){let{resource:r}=this.baseTexture;r?.url&&zt[r.url]&&H.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,H.removeFromCache(this),this.textureCacheIds=null}clone(){let t=this._frame.clone(),r=this._frame===this.orig?t:this.orig.clone(),i=new H(this.baseTexture,!this.noFrame&&t,r,this.trim?.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(i._frame=t),i}updateUvs(){this._uvs===Pd&&(this._uvs=new qi),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,r={},i=w.STRICT_TEXTURE_CACHE){let s=typeof t=="string",n=null;if(s)n=t;else if(t instanceof W){if(!t.cacheId){let a=r?.pixiIdPrefix||"pixiid";t.cacheId=`${a}-${Ze()}`,W.addToCache(t,t.cacheId)}n=t.cacheId}else{if(!t._pixiId){let a=r?.pixiIdPrefix||"pixiid";t._pixiId=`${a}_${Ze()}`}n=t._pixiId}let o=zt[n];if(s&&i&&!o)throw new Error(`The cacheId "${n}" does not exist in TextureCache.`);return!o&&!(t instanceof W)?(r.resolution||(r.resolution=Hs(t)),o=new H(new W(t,r)),o.baseTexture.cacheId=n,W.addToCache(o.baseTexture,n),H.addToCache(o,n)):!o&&t instanceof W&&(o=new H(t),H.addToCache(o,n)),o}static fromURL(t,r){let i=Object.assign({autoLoad:!1},r?.resourceOptions),s=H.from(t,Object.assign({resourceOptions:i},r),!1),n=s.baseTexture.resource;return s.baseTexture.valid?Promise.resolve(s):n.load().then(()=>Promise.resolve(s))}static fromBuffer(t,r,i,s){return new H(W.fromBuffer(t,r,i,s))}static fromLoader(t,r,i,s){let n=new W(t,Object.assign({scaleMode:W.defaultOptions.scaleMode,resolution:Hs(r)},s)),{resource:o}=n;o instanceof Fr&&(o.url=r);let a=new H(n);return i||(i=r),W.addToCache(a.baseTexture,i),H.addToCache(a,i),i!==r&&(W.addToCache(a.baseTexture,r),H.addToCache(a,r)),a.baseTexture.valid?Promise.resolve(a):new Promise(h=>{a.baseTexture.once("loaded",()=>h(a))})}static addToCache(t,r){r&&(t.textureCacheIds.includes(r)||t.textureCacheIds.push(r),zt[r]&&zt[r]!==t&&console.warn(`Texture added to the cache with an id [${r}] that already had an entry`),zt[r]=t)}static removeFromCache(t){if(typeof t=="string"){let r=zt[t];if(r){let i=r.textureCacheIds.indexOf(t);return i>-1&&r.textureCacheIds.splice(i,1),delete zt[t],r}}else if(t?.textureCacheIds){for(let r=0;r<t.textureCacheIds.length;++r)zt[t.textureCacheIds[r]]===t&&delete zt[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;let{x:r,y:i,width:s,height:n}=t,o=r+s>this.baseTexture.width,a=i+n>this.baseTexture.height;if(o||a){let h=o&&a?"and":"or",l=`X: ${r} + ${s} = ${r+s} > ${this.baseTexture.width}`,c=`Y: ${i} + ${n} = ${i+n} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${l} ${h} ${c}`)}this.valid=s&&n&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return H._EMPTY||(H._EMPTY=new H(new W),Ho(H._EMPTY),Ho(H._EMPTY.baseTexture)),H._EMPTY}static get WHITE(){if(!H._WHITE){let t=w.ADAPTER.createCanvas(16,16),r=t.getContext("2d");t.width=16,t.height=16,r.fillStyle="white",r.fillRect(0,0,16,16),H._WHITE=new H(W.from(t)),Ho(H._WHITE),Ho(H._WHITE.baseTexture)}return H._WHITE}};var ye=class extends H{constructor(t,r){super(t,r),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,r,i=!0){let s=this.baseTexture.resolution,n=Math.round(t*s)/s,o=Math.round(r*s)/s;this.valid=n>0&&o>0,this._frame.width=this.orig.width=n,this._frame.height=this.orig.height=o,i&&this.baseTexture.resize(n,o),this.updateUvs()}setResolution(t){let{baseTexture:r}=this;r.resolution!==t&&(r.setResolution(t),this.resize(r.width,r.height,!1))}static create(t){return new ye(new di(t))}};var Ki=class{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,r,i=dt.NONE){let s=new di(Object.assign({width:t,height:r,resolution:1,multisample:i},this.textureOptions));return new ye(s)}getOptimalTexture(t,r,i=1,s=dt.NONE){let n;t=Math.ceil(t*i-1e-6),r=Math.ceil(r*i-1e-6),!this.enableFullScreen||t!==this._pixelsWidth||r!==this._pixelsHeight?(t=Pr(t),r=Pr(r),n=((t&65535)<<16|r&65535)>>>0,s>1&&(n+=s*4294967296)):n=s>1?-s:-1,this.texturePool[n]||(this.texturePool[n]=[]);let o=this.texturePool[n].pop();return o||(o=this.createTexture(t,r,s)),o.filterPoolKey=n,o.setResolution(i),o}getFilterTexture(t,r,i){let s=this.getOptimalTexture(t.width,t.height,r||t.resolution,i||dt.NONE);return s.filterFrame=t.filterFrame,s}returnTexture(t){let r=t.filterPoolKey;t.filterFrame=null,this.texturePool[r].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=t!==!1,t)for(let r in this.texturePool){let i=this.texturePool[r];if(i)for(let s=0;s<i.length;s++)i[s].destroy(!0)}this.texturePool={}}setScreenSize(t){if(!(t.width===this._pixelsWidth&&t.height===this._pixelsHeight)){this.enableFullScreen=t.width>0&&t.height>0;for(let r in this.texturePool){if(!(Number(r)<0))continue;let i=this.texturePool[r];if(i)for(let s=0;s<i.length;s++)i[s].destroy(!0);this.texturePool[r]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}};Ki.SCREEN_KEY=-1;var Ys=class extends ie{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}};var fi=class extends ie{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new ut(this.vertices),this.uvBuffer=new ut(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,r){let i=0,s=0;return this.uvs[0]=i,this.uvs[1]=s,this.uvs[2]=i+r.width/t.width,this.uvs[3]=s,this.uvs[4]=i+r.width/t.width,this.uvs[5]=s+r.height/t.height,this.uvs[6]=i,this.uvs[7]=s+r.height/t.height,i=r.x,s=r.y,this.vertices[0]=i,this.vertices[1]=s,this.vertices[2]=i+r.width,this.vertices[3]=s,this.vertices[4]=i+r.width,this.vertices[5]=s+r.height,this.vertices[6]=i,this.vertices[7]=s+r.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}};var qs=class{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=dt.NONE,this.sourceFrame=new $,this.destinationFrame=new $,this.bindingSourceFrame=new $,this.bindingDestinationFrame=new $,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}};var Xo=[new Q,new Q,new Q,new Q],Xh=new st,Zi=class{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new Ki,this.statePool=[],this.quad=new Ys,this.quadUv=new fi,this.tempRect=new $,this.activeState={},this.globalUniforms=new Ut({outputFrame:new $,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,r){let i=this.renderer,s=this.defaultFilterStack,n=this.statePool.pop()||new qs,o=this.renderer.renderTexture,a=r[0].resolution,h=r[0].multisample,l=r[0].padding,c=r[0].autoFit,u=r[0].legacy??!0;for(let p=1;p<r.length;p++){let g=r[p];a=Math.min(a,g.resolution),h=Math.min(h,g.multisample),l=this.useMaxPadding?Math.max(l,g.padding):l+g.padding,c=c&&g.autoFit,u=u||(g.legacy??!0)}s.length===1&&(this.defaultFilterStack[0].renderTexture=o.current),s.push(n),n.resolution=a,n.multisample=h,n.legacy=u,n.target=t,n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(l);let d=this.tempRect.copyFrom(o.sourceFrame);i.projection.transform&&this.transformAABB(Xh.copyFrom(i.projection.transform).invert(),d),c?(n.sourceFrame.fit(d),(n.sourceFrame.width<=0||n.sourceFrame.height<=0)&&(n.sourceFrame.width=0,n.sourceFrame.height=0)):n.sourceFrame.intersects(d)||(n.sourceFrame.width=0,n.sourceFrame.height=0),this.roundFrame(n.sourceFrame,o.current?o.current.resolution:i.resolution,o.sourceFrame,o.destinationFrame,i.projection.transform),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,a,h),n.filters=r,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height;let f=this.tempRect;f.x=0,f.y=0,f.width=n.sourceFrame.width,f.height=n.sourceFrame.height,n.renderTexture.filterFrame=n.sourceFrame,n.bindingSourceFrame.copyFrom(o.sourceFrame),n.bindingDestinationFrame.copyFrom(o.destinationFrame),n.transform=i.projection.transform,i.projection.transform=null,o.bind(n.renderTexture,n.sourceFrame,f),i.framebuffer.clear(0,0,0,0)}pop(){let t=this.defaultFilterStack,r=t.pop(),i=r.filters;this.activeState=r;let s=this.globalUniforms.uniforms;s.outputFrame=r.sourceFrame,s.resolution=r.resolution;let n=s.inputSize,o=s.inputPixel,a=s.inputClamp;if(n[0]=r.destinationFrame.width,n[1]=r.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],o[0]=Math.round(n[0]*r.resolution),o[1]=Math.round(n[1]*r.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=r.sourceFrame.width*n[2]-.5*o[2],a[3]=r.sourceFrame.height*n[3]-.5*o[3],r.legacy){let l=s.filterArea;l[0]=r.destinationFrame.width,l[1]=r.destinationFrame.height,l[2]=r.sourceFrame.x,l[3]=r.sourceFrame.y,s.filterClamp=s.inputClamp}this.globalUniforms.update();let h=t[t.length-1];if(this.renderer.framebuffer.blit(),i.length===1)i[0].apply(this,r.renderTexture,h.renderTexture,Se.BLEND,r),this.returnFilterTexture(r.renderTexture);else{let l=r.renderTexture,c=this.getOptimalFilterTexture(l.width,l.height,r.resolution);c.filterFrame=l.filterFrame;let u=0;for(u=0;u<i.length-1;++u){u===1&&r.multisample>1&&(c=this.getOptimalFilterTexture(l.width,l.height,r.resolution),c.filterFrame=l.filterFrame),i[u].apply(this,l,c,Se.CLEAR,r);let d=l;l=c,c=d}i[u].apply(this,l,h.renderTexture,Se.BLEND,r),u>1&&r.multisample>1&&this.returnFilterTexture(r.renderTexture),this.returnFilterTexture(l),this.returnFilterTexture(c)}r.clear(),this.statePool.push(r)}bindAndClear(t,r=Se.CLEAR){let{renderTexture:i,state:s}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t?.filterFrame){let o=this.tempRect;o.x=0,o.y=0,o.width=t.filterFrame.width,o.height=t.filterFrame.height,i.bind(t,t.filterFrame,o)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?i.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);let n=s.stateId&1||this.forceClear;(r===Se.CLEAR||r===Se.BLIT&&n)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,r,i,s){let n=this.renderer;n.state.set(t.state),this.bindAndClear(i,s),t.uniforms.uSampler=r,t.uniforms.filterGlobals=this.globalUniforms,n.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(r._frame,r.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(me.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(me.TRIANGLE_STRIP))}calculateSpriteMatrix(t,r){let{sourceFrame:i,destinationFrame:s}=this.activeState,{orig:n}=r._texture,o=t.set(s.width,0,0,s.height,i.x,i.y),a=r.worldTransform.copyTo(st.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/n.width,1/n.height),o.translate(r.anchor.x,r.anchor.y),o}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,r,i=1,s=dt.NONE){return this.texturePool.getOptimalTexture(t,r,i,s)}getFilterTexture(t,r,i){if(typeof t=="number"){let n=t;t=r,r=n}t=t||this.activeState.renderTexture;let s=this.texturePool.getOptimalTexture(t.width,t.height,r||t.resolution,i||dt.NONE);return s.filterFrame=t.filterFrame,s}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,r){let i=Xo[0],s=Xo[1],n=Xo[2],o=Xo[3];i.set(r.left,r.top),s.set(r.left,r.bottom),n.set(r.right,r.top),o.set(r.right,r.bottom),t.apply(i,i),t.apply(s,s),t.apply(n,n),t.apply(o,o);let a=Math.min(i.x,s.x,n.x,o.x),h=Math.min(i.y,s.y,n.y,o.y),l=Math.max(i.x,s.x,n.x,o.x),c=Math.max(i.y,s.y,n.y,o.y);r.x=a,r.y=h,r.width=l-a,r.height=c-h}roundFrame(t,r,i,s,n){if(!(t.width<=0||t.height<=0||i.width<=0||i.height<=0)){if(n){let{a:o,b:a,c:h,d:l}=n;if((Math.abs(a)>1e-4||Math.abs(h)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(l)>1e-4))return}n=n?Xh.copyFrom(n):Xh.identity(),n.translate(-i.x,-i.y).scale(s.width/i.width,s.height/i.height).translate(s.x,s.y),this.transformAABB(n,t),t.ceil(r),this.transformAABB(n.invert(),t)}}};Zi.extension={type:S.RendererSystem,name:"filter"};P.add(Zi);var Ks=class{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=dt.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}};var Qg=new $,Ji=class{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new Or(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);let t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new $,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let r=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;w.PREFER_ENV===we.WEBGL_LEGACY&&(r=null,i=null),r?t.drawBuffers=s=>r.drawBuffersWEBGL(s):(this.hasMRT=!1,t.drawBuffers=()=>{}),i||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,r,i=0){let{gl:s}=this;if(t){let n=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,s.bindFramebuffer(s.FRAMEBUFFER,n.framebuffer)),n.mipLevel!==i&&(t.dirtyId++,t.dirtyFormat++,n.mipLevel=i),n.dirtyId!==t.dirtyId&&(n.dirtyId=t.dirtyId,n.dirtyFormat!==t.dirtyFormat?(n.dirtyFormat=t.dirtyFormat,n.dirtySize=t.dirtySize,this.updateFramebuffer(t,i)):n.dirtySize!==t.dirtySize&&(n.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let o=0;o<t.colorTextures.length;o++){let a=t.colorTextures[o];this.renderer.texture.unbind(a.parentTextureArray||a)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),r){let o=r.width>>i,a=r.height>>i,h=o/r.width;this.setViewport(r.x*h,r.y*h,o,a)}else{let o=t.width>>i,a=t.height>>i;this.setViewport(0,0,o,a)}}else this.current&&(this.current=null,s.bindFramebuffer(s.FRAMEBUFFER,null)),r?this.setViewport(r.x,r.y,r.width,r.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,r,i,s){let n=this.viewport;t=Math.round(t),r=Math.round(r),i=Math.round(i),s=Math.round(s),(n.width!==i||n.height!==s||n.x!==t||n.y!==r)&&(n.x=t,n.y=r,n.width=i,n.height=s,this.gl.viewport(t,r,i,s))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,r,i,s,n=Jn.COLOR|Jn.DEPTH){let{gl:o}=this;o.clearColor(t,r,i,s),o.clear(n)}initFramebuffer(t){let{gl:r}=this,i=new Ks(r.createFramebuffer());return i.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=i,this.managedFramebuffers.push(t),t.disposeRunner.add(this),i}resizeFramebuffer(t){let{gl:r}=this,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(r.bindRenderbuffer(r.RENDERBUFFER,i.stencil),i.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,i.multisample,r.DEPTH24_STENCIL8,t.width,t.height):r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,t.width,t.height));let s=t.colorTextures,n=s.length;r.drawBuffers||(n=Math.min(n,1));for(let o=0;o<n;o++){let a=s[o],h=a.parentTextureArray||a;this.renderer.texture.bind(h,0),o===0&&i.msaaBuffer&&(r.bindRenderbuffer(r.RENDERBUFFER,i.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,i.multisample,h._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,r){let{gl:i}=this,s=t.glFramebuffers[this.CONTEXT_UID],n=t.colorTextures,o=n.length;i.drawBuffers||(o=Math.min(o,1)),s.multisample>1&&this.canMultisampleFramebuffer(t)?s.msaaBuffer=s.msaaBuffer||i.createRenderbuffer():s.msaaBuffer&&(i.deleteRenderbuffer(s.msaaBuffer),s.msaaBuffer=null,s.blitFramebuffer&&(s.blitFramebuffer.dispose(),s.blitFramebuffer=null));let a=[];for(let h=0;h<o;h++){let l=n[h],c=l.parentTextureArray||l;this.renderer.texture.bind(c,0),h===0&&s.msaaBuffer?(i.bindRenderbuffer(i.RENDERBUFFER,s.msaaBuffer),i.renderbufferStorageMultisample(i.RENDERBUFFER,s.multisample,c._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,s.msaaBuffer)):(i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+h,l.target,c._glTextures[this.CONTEXT_UID].texture,r),a.push(i.COLOR_ATTACHMENT0+h))}if(a.length>1&&i.drawBuffers(a),t.depthTexture&&this.writeDepthTexture){let l=t.depthTexture;this.renderer.texture.bind(l,0),i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,l._glTextures[this.CONTEXT_UID].texture,r)}(t.stencil||t.depth)&&!(t.depthTexture&&this.writeDepthTexture)?(s.stencil=s.stencil||i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,s.stencil),s.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,s.multisample,i.DEPTH24_STENCIL8,t.width,t.height):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,s.stencil)):s.stencil&&(i.deleteRenderbuffer(s.stencil),s.stencil=null)}canMultisampleFramebuffer(t){return this.renderer.context.webGLVersion!==1&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){let{msaaSamples:r}=this,i=dt.NONE;if(t<=1||r===null)return i;for(let s=0;s<r.length;s++)if(r[s]<=t){i=r[s];break}return i===1&&(i=dt.NONE),i}blit(t,r,i){let{current:s,renderer:n,gl:o,CONTEXT_UID:a}=this;if(n.context.webGLVersion!==2||!s)return;let h=s.glFramebuffers[a];if(!h)return;if(!t){if(!h.msaaBuffer)return;let c=s.colorTextures[0];if(!c)return;h.blitFramebuffer||(h.blitFramebuffer=new Or(s.width,s.height),h.blitFramebuffer.addColorTexture(0,c)),t=h.blitFramebuffer,t.colorTextures[0]!==c&&(t.colorTextures[0]=c,t.dirtyId++,t.dirtyFormat++),(t.width!==s.width||t.height!==s.height)&&(t.width=s.width,t.height=s.height,t.dirtyId++,t.dirtySize++)}r||(r=Qg,r.width=s.width,r.height=s.height),i||(i=r);let l=r.width===i.width&&r.height===i.height;this.bind(t),o.bindFramebuffer(o.READ_FRAMEBUFFER,h.framebuffer),o.blitFramebuffer(r.left,r.top,r.right,r.bottom,i.left,i.top,i.right,i.bottom,o.COLOR_BUFFER_BIT,l?o.NEAREST:o.LINEAR),o.bindFramebuffer(o.READ_FRAMEBUFFER,t.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(t,r){let i=t.glFramebuffers[this.CONTEXT_UID],s=this.gl;if(!i)return;delete t.glFramebuffers[this.CONTEXT_UID];let n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),r||(s.deleteFramebuffer(i.framebuffer),i.msaaBuffer&&s.deleteRenderbuffer(i.msaaBuffer),i.stencil&&s.deleteRenderbuffer(i.stencil)),i.blitFramebuffer&&this.disposeFramebuffer(i.blitFramebuffer,r)}disposeAll(t){let r=this.managedFramebuffers;this.managedFramebuffers=[];for(let i=0;i<r.length;i++)this.disposeFramebuffer(r[i],t)}forceStencil(){let t=this.current;if(!t)return;let r=t.glFramebuffers[this.CONTEXT_UID];if(!r||r.stencil)return;t.stencil=!0;let i=t.width,s=t.height,n=this.gl,o=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,o),r.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,r.multisample,n.DEPTH24_STENCIL8,i,s):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,i,s),r.stencil=o,n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,o)}reset(){this.current=this.unknownFramebuffer,this.viewport=new $}destroy(){this.renderer=null}};Ji.extension={type:S.RendererSystem,name:"framebuffer"};P.add(Ji);var Vh={5126:4,5123:2,5121:1},Qi=class{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);let t=this.gl=this.renderer.gl,r=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,r.webGLVersion!==2){let i=this.renderer.context.extensions.vertexArrayObject;w.PREFER_ENV===we.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=()=>i.createVertexArrayOES(),t.bindVertexArray=s=>i.bindVertexArrayOES(s),t.deleteVertexArray=s=>i.deleteVertexArrayOES(s)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(r.webGLVersion!==2){let i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=(s,n)=>i.vertexAttribDivisorANGLE(s,n),t.drawElementsInstanced=(s,n,o,a,h)=>i.drawElementsInstancedANGLE(s,n,o,a,h),t.drawArraysInstanced=(s,n,o,a)=>i.drawArraysInstancedANGLE(s,n,o,a)):this.hasInstance=!1}this.canUseUInt32ElementIndex=r.webGLVersion===2||!!r.extensions.uint32ElementIndex}bind(t,r){r=r||this.renderer.shader.shader;let{gl:i}=this,s=t.glVertexArrayObjects[this.CONTEXT_UID],n=!1;s||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=s={},n=!0);let o=s[r.program.id]||this.initGeometryVao(t,r,n);this._activeGeometry=t,this._activeVao!==o&&(this._activeVao=o,this.hasVao?i.bindVertexArray(o):this.activateVao(t,r.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){let t=this._activeGeometry,r=this.renderer.buffer;for(let i=0;i<t.buffers.length;i++){let s=t.buffers[i];r.update(s)}}checkCompatibility(t,r){let i=t.attributes,s=r.attributeData;for(let n in s)if(!i[n])throw new Error(`shader and geometry incompatible, geometry missing the "${n}" attribute`)}getSignature(t,r){let i=t.attributes,s=r.attributeData,n=["g",t.id];for(let o in i)s[o]&&n.push(o,s[o].location);return n.join("-")}initGeometryVao(t,r,i=!0){let s=this.gl,n=this.CONTEXT_UID,o=this.renderer.buffer,a=r.program;a.glPrograms[n]||this.renderer.shader.generateProgram(r),this.checkCompatibility(t,a);let h=this.getSignature(t,a),l=t.glVertexArrayObjects[this.CONTEXT_UID],c=l[h];if(c)return l[a.id]=c,c;let u=t.buffers,d=t.attributes,f={},p={};for(let g in u)f[g]=0,p[g]=0;for(let g in d)!d[g].size&&a.attributeData[g]?d[g].size=a.attributeData[g].size:d[g].size||console.warn(`PIXI Geometry attribute '${g}' size cannot be determined (likely the bound shader does not have the attribute)`),f[d[g].buffer]+=d[g].size*Vh[d[g].type];for(let g in d){let _=d[g],y=_.size;_.stride===void 0&&(f[_.buffer]===y*Vh[_.type]?_.stride=0:_.stride=f[_.buffer]),_.start===void 0&&(_.start=p[_.buffer],p[_.buffer]+=y*Vh[_.type])}c=s.createVertexArray(),s.bindVertexArray(c);for(let g=0;g<u.length;g++){let _=u[g];o.bind(_),i&&_._glBuffers[n].refCount++}return this.activateVao(t,a),l[a.id]=c,l[h]=c,s.bindVertexArray(null),o.unbind(ge.ARRAY_BUFFER),c}disposeGeometry(t,r){if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];let i=t.glVertexArrayObjects[this.CONTEXT_UID],s=this.gl,n=t.buffers,o=this.renderer?.buffer;if(t.disposeRunner.remove(this),!!i){if(o)for(let a=0;a<n.length;a++){let h=n[a]._glBuffers[this.CONTEXT_UID];h&&(h.refCount--,h.refCount===0&&!r&&o.dispose(n[a],r))}if(!r){for(let a in i)if(a[0]==="g"){let h=i[a];this._activeVao===h&&this.unbind(),s.deleteVertexArray(h)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){let r=Object.keys(this.managedGeometries);for(let i=0;i<r.length;i++)this.disposeGeometry(this.managedGeometries[r[i]],t)}activateVao(t,r){let i=this.gl,s=this.CONTEXT_UID,n=this.renderer.buffer,o=t.buffers,a=t.attributes;t.indexBuffer&&n.bind(t.indexBuffer);let h=null;for(let l in a){let c=a[l],u=o[c.buffer],d=u._glBuffers[s];if(r.attributeData[l]){h!==d&&(n.bind(u),h=d);let f=r.attributeData[l].location;if(i.enableVertexAttribArray(f),i.vertexAttribPointer(f,c.size,c.type||i.FLOAT,c.normalized,c.stride,c.start),c.instance)if(this.hasInstance)i.vertexAttribDivisor(f,c.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(t,r,i,s){let{gl:n}=this,o=this._activeGeometry;if(o.indexBuffer){let a=o.indexBuffer.data.BYTES_PER_ELEMENT,h=a===2?n.UNSIGNED_SHORT:n.UNSIGNED_INT;a===2||a===4&&this.canUseUInt32ElementIndex?o.instanced?n.drawElementsInstanced(t,r||o.indexBuffer.data.length,h,(i||0)*a,s||1):n.drawElements(t,r||o.indexBuffer.data.length,h,(i||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?n.drawArraysInstanced(t,i,r||o.getSize(),s||1):n.drawArrays(t,i,r||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}};Qi.extension={type:S.RendererSystem,name:"geometry"};P.add(Qi);var Id=new st,Lr=class{constructor(t,r){this._texture=t,this.mapCoord=new st,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof r>"u"?.5:r,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,r){r===void 0&&(r=t);let i=this.mapCoord;for(let s=0;s<t.length;s+=2){let n=t[s],o=t[s+1];r[s]=n*i.a+o*i.c+i.tx,r[s+1]=n*i.b+o*i.d+i.ty}return r}update(t){let r=this._texture;if(!r||!r.valid||!t&&this._textureID===r._updateID)return!1;this._textureID=r._updateID,this._updateID++;let i=r._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);let s=r.orig,n=r.trim;n&&(Id.set(s.width/n.width,0,0,s.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(Id));let o=r.baseTexture,a=this.uClampFrame,h=this.clampMargin/o.resolution,l=this.clampOffset;return a[0]=(r._frame.x+h+l)/o.width,a[1]=(r._frame.y+h+l)/o.height,a[2]=(r._frame.x+r._frame.width-h+l)/o.width,a[3]=(r._frame.y+r._frame.height-h+l)/o.height,this.uClampOffset[0]=l/o.realWidth,this.uClampOffset[1]=l/o.realHeight,this.isSimple=r._frame.width===o.width&&r._frame.height===o.height&&r.rotate===0,!0}};var Rd=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`;var Cd=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;var Zs=class extends ft{constructor(t,r,i){let s=null;typeof t!="string"&&r===void 0&&i===void 0&&(s=t,t=void 0,r=void 0,i=void 0),super(t||Cd,r||Rd,i),this.maskSprite=s,this.maskMatrix=new st}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,r,i,s){let n=this._maskSprite,o=n._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new Lr(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,t.applyFilter(this,r,i,s))}};var Js=class{constructor(t=null){this.type=Et.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=ft.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=Et.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}};var ts=class{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,r){let i=r;if(!i.isMaskData){let n=this.maskDataPool.pop()||new Js;n.pooled=!0,n.maskObject=r,i=n}let s=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(i.copyCountersOrReset(s),i._colorMask=s?s._colorMask:15,i.autoDetect&&this.detect(i),i._target=t,i.type!==Et.SPRITE&&this.maskStack.push(i),i.enabled)switch(i.type){case Et.SCISSOR:this.renderer.scissor.push(i);break;case Et.STENCIL:this.renderer.stencil.push(i);break;case Et.SPRITE:i.copyCountersOrReset(null),this.pushSpriteMask(i);break;case Et.COLOR:this.pushColorMask(i);break;default:break}i.type===Et.SPRITE&&this.maskStack.push(i)}pop(t){let r=this.maskStack.pop();if(!(!r||r._target!==t)){if(r.enabled)switch(r.type){case Et.SCISSOR:this.renderer.scissor.pop(r);break;case Et.STENCIL:this.renderer.stencil.pop(r.maskObject);break;case Et.SPRITE:this.popSpriteMask(r);break;case Et.COLOR:this.popColorMask(r);break;default:break}if(r.reset(),r.pooled&&this.maskDataPool.push(r),this.maskStack.length!==0){let i=this.maskStack[this.maskStack.length-1];i.type===Et.SPRITE&&i._filters&&(i._filters[0].maskSprite=i.maskObject)}}}detect(t){let r=t.maskObject;r?r.isSprite?t.type=Et.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=Et.SCISSOR:t.type=Et.STENCIL:t.type=Et.COLOR}pushSpriteMask(t){let{maskObject:r}=t,i=t._target,s=t._filters;s||(s=this.alphaMaskPool[this.alphaMaskIndex],s||(s=this.alphaMaskPool[this.alphaMaskIndex]=[new Zs]));let n=this.renderer,o=n.renderTexture,a,h;if(o.current){let c=o.current;a=t.resolution||c.resolution,h=t.multisample??c.multisample}else a=t.resolution||n.resolution,h=t.multisample??n.multisample;s[0].resolution=a,s[0].multisample=h,s[0].maskSprite=r;let l=i.filterArea;i.filterArea=r.getBounds(!0),n.filter.push(i,s),i.filterArea=l,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){let r=t._colorMask,i=t._colorMask=r&t.colorMask;i!==r&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}popColorMask(t){let r=t._colorMask,i=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;i!==r&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}destroy(){this.renderer=null}};ts.extension={type:S.RendererSystem,name:"mask"};P.add(ts);var es=class{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){let{gl:r}=this.renderer,i=this.getStackLength();this.maskStack=t;let s=this.getStackLength();s!==i&&(s===0?r.disable(this.glConst):(r.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}};var Md=new st,Bd=[],Vo=class extends es{constructor(e){super(e),this.glConst=w.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){let e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0}calcScissorRect(e){if(e._scissorRectLocal)return;let t=e._scissorRect,{maskObject:r}=e,{renderer:i}=this,s=i.renderTexture,n=r.getBounds(!0,Bd.pop()??new $);this.roundFrameToPixels(n,s.current?s.current.resolution:i.resolution,s.sourceFrame,s.destinationFrame,i.projection.transform),t&&n.fit(t),e._scissorRectLocal=n}static isMatrixRotated(e){if(!e)return!1;let{a:t,b:r,c:i,d:s}=e;return(Math.abs(r)>1e-4||Math.abs(i)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(s)>1e-4)}testScissor(e){let{maskObject:t}=e;if(!t.isFastRect||!t.isFastRect()||Vo.isMatrixRotated(t.worldTransform)||Vo.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(e);let r=e._scissorRectLocal;return r.width>0&&r.height>0}roundFrameToPixels(e,t,r,i,s){Vo.isMatrixRotated(s)||(s=s?Md.copyFrom(s):Md.identity(),s.translate(-r.x,-r.y).scale(i.width/r.width,i.height/r.height).translate(i.x,i.y),this.renderer.filter.transformAABB(s,e),e.fit(i),e.x=Math.round(e.x*t),e.y=Math.round(e.y*t),e.width=Math.round(e.width*t),e.height=Math.round(e.height*t))}push(e){e._scissorRectLocal||this.calcScissorRect(e);let{gl:t}=this.renderer;e._scissorRect||t.enable(t.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=e._scissorRectLocal,this._useCurrent()}pop(e){let{gl:t}=this.renderer;e&&Bd.push(e._scissorRectLocal),this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)}_useCurrent(){let e=this.maskStack[this.maskStack.length-1]._scissorRect,t;this.renderer.renderTexture.current?t=e.y:t=this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,t,e.width,e.height)}},zo=Vo;zo.extension={type:S.RendererSystem,name:"scissor"};P.add(zo);var rs=class extends es{constructor(t){super(t),this.glConst=w.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){let t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){let r=t.maskObject,{gl:i}=this.renderer,s=t._stencilCounter;s===0&&(this.renderer.framebuffer.forceStencil(),i.clearStencil(0),i.clear(i.STENCIL_BUFFER_BIT),i.enable(i.STENCIL_TEST)),t._stencilCounter++;let n=t._colorMask;n!==0&&(t._colorMask=0,i.colorMask(!1,!1,!1,!1)),i.stencilFunc(i.EQUAL,s,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.INCR),r.renderable=!0,r.render(this.renderer),this.renderer.batch.flush(),r.renderable=!1,n!==0&&(t._colorMask=n,i.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)),this._useCurrent()}pop(t){let r=this.renderer.gl;if(this.getStackLength()===0)r.disable(r.STENCIL_TEST);else{let i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,s=i?i._colorMask:15;s!==0&&(i._colorMask=0,r.colorMask(!1,!1,!1,!1)),r.stencilOp(r.KEEP,r.KEEP,r.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,s!==0&&(i._colorMask=s,r.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)),this._useCurrent()}}_useCurrent(){let t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}};rs.extension={type:S.RendererSystem,name:"stencil"};P.add(rs);var is=class{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return rt("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract}},prepare:{enumerable:!1,get(){return rt("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare}},interaction:{enumerable:!1,get(){return rt("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events}}})}init(){let t=this.rendererPlugins;for(let r in t)this.plugins[r]=new t[r](this.renderer)}destroy(){for(let t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}};is.extension={type:[S.RendererSystem,S.CanvasRendererSystem],name:"_plugin"};P.add(is);var ss=class{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new st,this.transform=null}update(t,r,i,s){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=r||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,i,s),this.transform&&this.projectionMatrix.append(this.transform);let n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)}calculateProjection(t,r,i,s){let n=this.projectionMatrix,o=s?-1:1;n.identity(),n.a=1/r.width*2,n.d=o*(1/r.height*2),n.tx=-1-r.x*n.a,n.ty=-o-r.y*n.d}setTransform(t){}destroy(){this.renderer=null}};ss.extension={type:S.RendererSystem,name:"projection"};P.add(ss);var tx=new ui,ns=class{constructor(t){this.renderer=t,this._tempMatrix=new st}generateTexture(t,r){let{region:i,...s}=r||{},n=i||t.getLocalBounds(null,!0);n.width===0&&(n.width=1),n.height===0&&(n.height=1);let o=ye.create({width:n.width,height:n.height,...s});this._tempMatrix.tx=-n.x,this._tempMatrix.ty=-n.y;let a=t.transform;return t.transform=tx,this.renderer.render(t,{renderTexture:o,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=a,o}destroy(){}};ns.extension={type:[S.RendererSystem,S.CanvasRendererSystem],name:"textureGenerator"};P.add(ns);var pi=new $,Qs=new $,os=class{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new $,this.destinationFrame=new $,this.viewportFrame=new $}contextChange(){let t=this.renderer?.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(t&&t.alpha&&t.premultipliedAlpha)}bind(t=null,r,i){let s=this.renderer;this.current=t;let n,o,a;t?(n=t.baseTexture,a=n.resolution,r||(pi.width=t.frame.width,pi.height=t.frame.height,r=pi),i||(Qs.x=t.frame.x,Qs.y=t.frame.y,Qs.width=r.width,Qs.height=r.height,i=Qs),o=n.framebuffer):(a=s.resolution,r||(pi.width=s._view.screen.width,pi.height=s._view.screen.height,r=pi),i||(i=pi,i.width=r.width,i.height=r.height));let h=this.viewportFrame;h.x=i.x*a,h.y=i.y*a,h.width=i.width*a,h.height=i.height*a,t||(h.y=s.view.height-(h.y+h.height)),h.ceil(),this.renderer.framebuffer.bind(o,h),this.renderer.projection.update(i,r,a,!o),t?this.renderer.mask.setMaskStack(n.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(r),this.destinationFrame.copyFrom(i)}clear(t,r){let i=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,s=tt.shared.setValue(t||i);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&s.premultiply(s.alpha);let n=this.destinationFrame,o=this.current?this.current.baseTexture:this.renderer._view.screen,a=n.width!==o.width||n.height!==o.height;if(a){let{x:h,y:l,width:c,height:u}=this.viewportFrame;h=Math.round(h),l=Math.round(l),c=Math.round(c),u=Math.round(u),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(h,l,c,u)}this.renderer.framebuffer.clear(s.red,s.green,s.blue,s.alpha,r),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}};os.extension={type:S.RendererSystem,name:"renderTexture"};P.add(os);var tn=class{constructor(t,r){this.program=t,this.uniformData=r,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}};function Dd(e,t){let r={},i=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let s=0;s<i;s++){let n=t.getActiveAttrib(e,s);if(n.name.startsWith("gl_"))continue;let o=zs(t,n.type),a={type:o,name:n.name,size:Vs(o),location:t.getAttribLocation(e,n.name)};r[n.name]=a}return r}function Od(e,t){let r={},i=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let s=0;s<i;s++){let n=t.getActiveUniform(e,s),o=n.name.replace(/\[.*?\]$/,""),a=!!n.name.match(/\[.*?\]$/),h=zs(t,n.type);r[o]={name:o,index:s,type:h,size:n.size,isArray:a,value:Xs(h,n.size)}}return r}function zh(e,t){let r=Bo(e,e.VERTEX_SHADER,t.vertexSrc),i=Bo(e,e.FRAGMENT_SHADER,t.fragmentSrc),s=e.createProgram();e.attachShader(s,r),e.attachShader(s,i);let n=t.extra?.transformFeedbackVaryings;if(n&&(typeof e.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):e.transformFeedbackVaryings(s,n.names,n.bufferMode==="separate"?e.SEPARATE_ATTRIBS:e.INTERLEAVED_ATTRIBS)),e.linkProgram(s),e.getProgramParameter(s,e.LINK_STATUS)||Hh(e,s,r,i),t.attributeData=Dd(s,e),t.uniformData=Od(s,e),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){let h=Object.keys(t.attributeData);h.sort((l,c)=>l>c?1:-1);for(let l=0;l<h.length;l++)t.attributeData[h[l]].location=l,e.bindAttribLocation(s,l,h[l]);e.linkProgram(s)}e.deleteShader(r),e.deleteShader(i);let o={};for(let h in t.uniformData){let l=t.uniformData[h];o[h]={location:e.getUniformLocation(s,h),value:Xs(l.type,l.size)}}return new tn(s,o)}function ex(e,t,r,i,s){r.buffer.update(s)}var rx={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},Fd={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function Ld(e){let t=e.map(n=>({data:n,offset:0,dataLen:0,dirty:0})),r=0,i=0,s=0;for(let n=0;n<t.length;n++){let o=t[n];if(r=Fd[o.data.type],o.data.size>1&&(r=Math.max(r,16)*o.data.size),o.dataLen=r,i%r!==0&&i<16){let a=i%r%16;i+=a,s+=a}i+r>16?(s=Math.ceil(s/16)*16,o.offset=s,s+=r,i=r):(o.offset=s,i+=r,s+=r)}return s=Math.ceil(s/16)*16,{uboElements:t,size:s}}function Nd(e,t){let r=[];for(let i in e)t[i]&&r.push(t[i]);return r.sort((i,s)=>i.index-s.index),r}function Wh(e,t){if(!e.autoManage)return{size:0,syncFunc:ex};let r=Nd(e.uniforms,t),{uboElements:i,size:s}=Ld(r),n=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let o=0;o<i.length;o++){let a=i[o],h=e.uniforms[a.data.name],l=a.data.name,c=!1;for(let u=0;u<Je.length;u++){let d=Je[u];if(d.codeUbo&&d.test(a.data,h)){n.push(`offset = ${a.offset/4};`,Je[u].codeUbo(a.data.name,h)),c=!0;break}}if(!c)if(a.data.size>1){let u=Vs(a.data.type),d=Math.max(Fd[a.data.type]/16,1),f=u/d,p=(4-f%4)%4;n.push(`
                cv = ud.${l}.value;
                v = uv.${l};
                offset = ${a.offset/4};

                t = 0;

                for(var i=0; i < ${a.data.size*d}; i++)
                {
                    for(var j = 0; j < ${f}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${p};
                }

                `)}else{let u=rx[a.data.type];n.push(`
                cv = ud.${l}.value;
                v = uv.${l};
                offset = ${a.offset/4};
                ${u};
                `)}}return n.push(`
       renderer.buffer.update(buffer);
    `),{size:s,syncFunc:new Function("ud","uv","renderer","syncData","buffer",n.join(`
`))}}var ix=0,Wo={textureCount:0,uboCount:0},as=class{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=ix++}systemCheck(){if(!Uo())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,r){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;let i=t.program,s=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(s.program)),r||(Wo.textureCount=0,Wo.uboCount=0,this.syncUniformGroup(t.uniformGroup,Wo)),s}setUniforms(t){let r=this.shader.program,i=r.glPrograms[this.renderer.CONTEXT_UID];r.syncUniforms(i.uniformData,t,this.renderer)}syncUniformGroup(t,r){let i=this.getGlProgram();(!t.static||t.dirtyId!==i.uniformDirtyGroups[t.id])&&(i.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,i,r))}syncUniforms(t,r,i){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(r.uniformData,t.uniforms,this.renderer,i)}createSyncGroups(t){let r=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[r]||(this.cache[r]=Gh(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[r],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,r){let i=this.getGlProgram();if(!t.static||t.dirtyId!==0||!i.uniformGroups[t.id]){t.dirtyId=0;let s=i.uniformGroups[t.id]||this.createSyncBufferGroup(t,i,r);t.buffer.update(),s(i.uniformData,t.uniforms,this.renderer,Wo,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,i.uniformBufferBindings[r])}createSyncBufferGroup(t,r,i){let{gl:s}=this.renderer;this.renderer.buffer.bind(t.buffer);let n=this.gl.getUniformBlockIndex(r.program,i);r.uniformBufferBindings[i]=this.shader.uniformBindCount,s.uniformBlockBinding(r.program,n,this.shader.uniformBindCount),this.shader.uniformBindCount++;let o=this.getSignature(t,this.shader.program.uniformData,"ubo"),a=this._uboCache[o];if(a||(a=this._uboCache[o]=Wh(t,this.shader.program.uniformData)),t.autoManage){let h=new Float32Array(a.size/4);t.buffer.update(h)}return r.uniformGroups[t.id]=a.syncFunc,r.uniformGroups[t.id]}getSignature(t,r,i){let s=t.uniforms,n=[`${i}-`];for(let o in s)n.push(o),r[o]&&n.push(r[o].type);return n.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){let r=this.gl,i=t.program,s=zh(r,i);return i.glPrograms[this.renderer.CONTEXT_UID]=s,s}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}};as.extension={type:S.RendererSystem,name:"shader"};P.add(as);var fr=class{constructor(t){this.renderer=t}run(t){let{renderer:r}=this;r.runners.init.emit(r.options),t.hello&&console.log(`PixiJS 7.2.4 - ${r.rendererLogId} - https://pixijs.com`),r.resize(r.screen.width,r.screen.height)}destroy(){}};fr.defaultOptions={hello:!1};fr.extension={type:[S.RendererSystem,S.CanvasRendererSystem],name:"startup"};P.add(fr);function Ud(e,t=[]){return t[q.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[q.ADD]=[e.ONE,e.ONE],t[q.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[q.SCREEN]=[e.ONE,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[q.OVERLAY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[q.DARKEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[q.LIGHTEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[q.COLOR_DODGE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[q.COLOR_BURN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[q.HARD_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[q.SOFT_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[q.DIFFERENCE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[q.EXCLUSION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[q.HUE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[q.SATURATION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[q.COLOR]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[q.LUMINOSITY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[q.NONE]=[0,0],t[q.NORMAL_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[q.ADD_NPM]=[e.SRC_ALPHA,e.ONE,e.ONE,e.ONE],t[q.SCREEN_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[q.SRC_IN]=[e.DST_ALPHA,e.ZERO],t[q.SRC_OUT]=[e.ONE_MINUS_DST_ALPHA,e.ZERO],t[q.SRC_ATOP]=[e.DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[q.DST_OVER]=[e.ONE_MINUS_DST_ALPHA,e.ONE],t[q.DST_IN]=[e.ZERO,e.SRC_ALPHA],t[q.DST_OUT]=[e.ZERO,e.ONE_MINUS_SRC_ALPHA],t[q.DST_ATOP]=[e.ONE_MINUS_DST_ALPHA,e.SRC_ALPHA],t[q.XOR]=[e.ONE_MINUS_DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[q.SUBTRACT]=[e.ONE,e.ONE,e.ONE,e.ONE,e.FUNC_REVERSE_SUBTRACT,e.FUNC_ADD],t}var sx=0,nx=1,ox=2,ax=3,hx=4,lx=5,$h=class{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=q.NONE,this._blendEq=!1,this.map=[],this.map[sx]=this.setBlend,this.map[nx]=this.setOffset,this.map[ox]=this.setCullFace,this.map[ax]=this.setDepthTest,this.map[hx]=this.setFrontFace,this.map[lx]=this.setDepthMask,this.checks=[],this.defaultState=new Nt,this.defaultState.blend=!0}contextChange(e){this.gl=e,this.blendModes=Ud(e),this.set(this.defaultState),this.reset()}set(e){if(e=e||this.defaultState,this.stateId!==e.data){let t=this.stateId^e.data,r=0;for(;t;)t&1&&this.map[r].call(this,!!(e.data&1<<r)),t=t>>1,r++;this.stateId=e.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,e)}forceState(e){e=e||this.defaultState;for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,e);this.stateId=e.data}setBlend(e){this.updateCheck($h.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)}setOffset(e){this.updateCheck($h.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}setBlendMode(e){if(e===this.blendMode)return;this.blendMode=e;let t=this.blendModes[e],r=this.gl;t.length===2?r.blendFunc(t[0],t[1]):r.blendFuncSeparate(t[0],t[1],t[2],t[3]),t.length===6?(this._blendEq=!0,r.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}setPolygonOffset(e,t){this.gl.polygonOffset(e,t)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(e,t){let r=this.checks.indexOf(e);t&&r===-1?this.checks.push(e):!t&&r!==-1&&this.checks.splice(r,1)}static checkBlendMode(e,t){e.setBlendMode(t.blendMode)}static checkPolygonOffset(e,t){e.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null}},$o=$h;$o.extension={type:S.RendererSystem,name:"state"};P.add($o);var hs=class extends Ir.default{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){this.addRunners(...t.runners);let r=(t.priority??[]).filter(s=>t.systems[s]),i=[...r,...Object.keys(t.systems).filter(s=>!r.includes(s))];for(let s of i)this.addSystem(t.systems[s],s)}addRunners(...t){t.forEach(r=>{this.runners[r]=new It(r)})}addSystem(t,r){let i=new t(this);if(this[r])throw new Error(`Whoops! The name "${r}" is already in use`);this[r]=i,this._systemsHash[r]=i;for(let s in this.runners)this.runners[s].add(i);return this}emitWithCustomOptions(t,r){let i=Object.keys(this._systemsHash);t.items.forEach(s=>{let n=i.find(o=>this._systemsHash[o]===s);s[t.name](r[n])})}destroy(){Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash={}}};var jo=class{constructor(e){this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=jo.defaultMaxIdle,this.checkCountMax=jo.defaultCheckCountMax,this.mode=jo.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==to.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){let e=this.renderer.texture,t=e.managedTextures,r=!1;for(let i=0;i<t.length;i++){let s=t[i];!s.framebuffer&&this.count-s.touched>this.maxIdle&&(e.destroyTexture(s,!0),t[i]=null,r=!0)}if(r){let i=0;for(let s=0;s<t.length;s++)t[s]!==null&&(t[i++]=t[s]);t.length=i}}unload(e){let t=this.renderer.texture,r=e._texture;r&&!r.framebuffer&&t.destroyTexture(r);for(let i=e.children.length-1;i>=0;i--)this.unload(e.children[i])}destroy(){this.renderer=null}},ve=jo;ve.defaultMode=to.AUTO;ve.defaultMaxIdle=60*60;ve.defaultCheckCountMax=60*10;ve.extension={type:S.RendererSystem,name:"textureGC"};P.add(ve);var mi=class{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=z.UNSIGNED_BYTE,this.internalFormat=L.RGBA,this.samplerType=0}};function Gd(e){let t;return"WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext?t={[z.UNSIGNED_BYTE]:{[L.RGBA]:e.RGBA8,[L.RGB]:e.RGB8,[L.RG]:e.RG8,[L.RED]:e.R8,[L.RGBA_INTEGER]:e.RGBA8UI,[L.RGB_INTEGER]:e.RGB8UI,[L.RG_INTEGER]:e.RG8UI,[L.RED_INTEGER]:e.R8UI,[L.ALPHA]:e.ALPHA,[L.LUMINANCE]:e.LUMINANCE,[L.LUMINANCE_ALPHA]:e.LUMINANCE_ALPHA},[z.BYTE]:{[L.RGBA]:e.RGBA8_SNORM,[L.RGB]:e.RGB8_SNORM,[L.RG]:e.RG8_SNORM,[L.RED]:e.R8_SNORM,[L.RGBA_INTEGER]:e.RGBA8I,[L.RGB_INTEGER]:e.RGB8I,[L.RG_INTEGER]:e.RG8I,[L.RED_INTEGER]:e.R8I},[z.UNSIGNED_SHORT]:{[L.RGBA_INTEGER]:e.RGBA16UI,[L.RGB_INTEGER]:e.RGB16UI,[L.RG_INTEGER]:e.RG16UI,[L.RED_INTEGER]:e.R16UI,[L.DEPTH_COMPONENT]:e.DEPTH_COMPONENT16},[z.SHORT]:{[L.RGBA_INTEGER]:e.RGBA16I,[L.RGB_INTEGER]:e.RGB16I,[L.RG_INTEGER]:e.RG16I,[L.RED_INTEGER]:e.R16I},[z.UNSIGNED_INT]:{[L.RGBA_INTEGER]:e.RGBA32UI,[L.RGB_INTEGER]:e.RGB32UI,[L.RG_INTEGER]:e.RG32UI,[L.RED_INTEGER]:e.R32UI,[L.DEPTH_COMPONENT]:e.DEPTH_COMPONENT24},[z.INT]:{[L.RGBA_INTEGER]:e.RGBA32I,[L.RGB_INTEGER]:e.RGB32I,[L.RG_INTEGER]:e.RG32I,[L.RED_INTEGER]:e.R32I},[z.FLOAT]:{[L.RGBA]:e.RGBA32F,[L.RGB]:e.RGB32F,[L.RG]:e.RG32F,[L.RED]:e.R32F,[L.DEPTH_COMPONENT]:e.DEPTH_COMPONENT32F},[z.HALF_FLOAT]:{[L.RGBA]:e.RGBA16F,[L.RGB]:e.RGB16F,[L.RG]:e.RG16F,[L.RED]:e.R16F},[z.UNSIGNED_SHORT_5_6_5]:{[L.RGB]:e.RGB565},[z.UNSIGNED_SHORT_4_4_4_4]:{[L.RGBA]:e.RGBA4},[z.UNSIGNED_SHORT_5_5_5_1]:{[L.RGBA]:e.RGB5_A1},[z.UNSIGNED_INT_2_10_10_10_REV]:{[L.RGBA]:e.RGB10_A2,[L.RGBA_INTEGER]:e.RGB10_A2UI},[z.UNSIGNED_INT_10F_11F_11F_REV]:{[L.RGB]:e.R11F_G11F_B10F},[z.UNSIGNED_INT_5_9_9_9_REV]:{[L.RGB]:e.RGB9_E5},[z.UNSIGNED_INT_24_8]:{[L.DEPTH_STENCIL]:e.DEPTH24_STENCIL8},[z.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[L.DEPTH_STENCIL]:e.DEPTH32F_STENCIL8}}:t={[z.UNSIGNED_BYTE]:{[L.RGBA]:e.RGBA,[L.RGB]:e.RGB,[L.ALPHA]:e.ALPHA,[L.LUMINANCE]:e.LUMINANCE,[L.LUMINANCE_ALPHA]:e.LUMINANCE_ALPHA},[z.UNSIGNED_SHORT_5_6_5]:{[L.RGB]:e.RGB},[z.UNSIGNED_SHORT_4_4_4_4]:{[L.RGBA]:e.RGBA},[z.UNSIGNED_SHORT_5_5_5_1]:{[L.RGBA]:e.RGBA}},t}var ls=class{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new W,this.hasIntegerTextures=!1}contextChange(){let t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=Gd(t);let r=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=r;for(let s=0;s<r;s++)this.boundTextures[s]=null;this.emptyTextures={};let i=new mi(t.createTexture());t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new mi(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let s=0;s<6;s++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let s=0;s<this.boundTextures.length;s++)this.bind(null,s)}bind(t,r=0){let{gl:i}=this;if(t=t?.castToBaseTexture(),t?.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;let s=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[r]!==t&&(this.currentLocation!==r&&(this.currentLocation=r,i.activeTexture(i.TEXTURE0+r)),i.bindTexture(t.target,s.texture)),s.dirtyId!==t.dirtyId?(this.currentLocation!==r&&(this.currentLocation=r,i.activeTexture(i.TEXTURE0+r)),this.updateTexture(t)):s.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[r]=t}else this.currentLocation!==r&&(this.currentLocation=r,i.activeTexture(i.TEXTURE0+r)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[r]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){let{gl:r,boundTextures:i}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let s=0;s<i.length;s++)i[s]===this.unknownTexture&&this.bind(null,s)}for(let s=0;s<i.length;s++)i[s]===t&&(this.currentLocation!==s&&(r.activeTexture(r.TEXTURE0+s),this.currentLocation=s),r.bindTexture(t.target,this.emptyTextures[t.target].texture),i[s]=null)}ensureSamplerType(t){let{boundTextures:r,hasIntegerTextures:i,CONTEXT_UID:s}=this;if(i)for(let n=t-1;n>=0;--n){let o=r[n];o&&o._glTextures[s].samplerType!==Qn.FLOAT&&this.renderer.texture.unbind(o)}}initTexture(t){let r=new mi(this.gl.createTexture());return r.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=r,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),r}initTextureType(t,r){r.internalFormat=this.internalFormats[t.type]?.[t.format]??t.format,this.webGLVersion===2&&t.type===z.HALF_FLOAT?r.type=this.gl.HALF_FLOAT:r.type=t.type}updateTexture(t){let r=t._glTextures[this.CONTEXT_UID];if(!r)return;let i=this.renderer;if(this.initTextureType(t,r),t.resource?.upload(i,t,r))r.samplerType!==Qn.FLOAT&&(this.hasIntegerTextures=!0);else{let s=t.realWidth,n=t.realHeight,o=i.gl;(r.width!==s||r.height!==n||r.dirtyId<0)&&(r.width=s,r.height=n,o.texImage2D(t.target,0,r.internalFormat,s,n,0,t.format,r.type,null))}t.dirtyStyleId!==r.dirtyStyleId&&this.updateTextureStyle(t),r.dirtyId=t.dirtyId}destroyTexture(t,r){let{gl:i}=this;if(t=t.castToBaseTexture(),t._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!r)){let s=this.managedTextures.indexOf(t);s!==-1&&Eo(this.managedTextures,s,1)}}updateTextureStyle(t){let r=t._glTextures[this.CONTEXT_UID];r&&((t.mipmap===Kt.POW2||this.webGLVersion!==2)&&!t.isPowerOfTwo?r.mipmap=!1:r.mipmap=t.mipmap>=1,this.webGLVersion!==2&&!t.isPowerOfTwo?r.wrapMode=Ee.CLAMP:r.wrapMode=t.wrapMode,t.resource?.style(this.renderer,t,r)||this.setStyle(t,r),r.dirtyStyleId=t.dirtyStyleId)}setStyle(t,r){let i=this.gl;if(r.mipmap&&t.mipmap!==Kt.ON_MANUAL&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,r.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,r.wrapMode),r.mipmap){i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===Me.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);let s=this.renderer.context.extensions.anisotropicFiltering;if(s&&t.anisotropicLevel>0&&t.scaleMode===Me.LINEAR){let n=Math.min(t.anisotropicLevel,i.getParameter(s.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,s.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===Me.LINEAR?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode===Me.LINEAR?i.LINEAR:i.NEAREST)}destroy(){this.renderer=null}};ls.extension={type:S.RendererSystem,name:"texture"};P.add(ls);var cs=class{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){let{gl:r,CONTEXT_UID:i}=this,s=t._glTransformFeedbacks[i]||this.createGLTransformFeedback(t);r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,s)}unbind(){let{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,r){let{gl:i,renderer:s}=this;r&&s.shader.bind(r),i.beginTransformFeedback(t)}endTransformFeedback(){let{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){let{gl:r,renderer:i,CONTEXT_UID:s}=this,n=r.createTransformFeedback();t._glTransformFeedbacks[s]=n,r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,n);for(let o=0;o<t.buffers.length;o++){let a=t.buffers[o];a&&(i.buffer.update(a),a._glBuffers[s].refCount++,r.bindBufferBase(r.TRANSFORM_FEEDBACK_BUFFER,o,a._glBuffers[s].buffer||null))}return r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),n}disposeTransformFeedback(t,r){let i=t._glTransformFeedbacks[this.CONTEXT_UID],s=this.gl;t.disposeRunner.remove(this);let n=this.renderer.buffer;if(n)for(let o=0;o<t.buffers.length;o++){let a=t.buffers[o];if(!a)continue;let h=a._glBuffers[this.CONTEXT_UID];h&&(h.refCount--,h.refCount===0&&!r&&n.dispose(a,r))}i&&(r||s.deleteTransformFeedback(i),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}};cs.extension={type:S.RendererSystem,name:"transformFeedback"};P.add(cs);var pr=class{constructor(t){this.renderer=t}init(t){this.screen=new $(0,0,t.width,t.height),this.element=t.view||w.ADAPTER.createCanvas(),this.resolution=t.resolution||w.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,r){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(r*this.resolution);let i=this.element.width/this.resolution,s=this.element.height/this.resolution;this.screen.width=i,this.screen.height=s,this.autoDensity&&(this.element.style.width=`${i}px`,this.element.style.height=`${s}px`),this.renderer.emit("resize",i,s),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){t&&this.element.parentNode?.removeChild(this.element),this.renderer=null,this.element=null,this.screen=null}};pr.defaultOptions={width:800,height:600,resolution:w.RESOLUTION,autoDensity:!1};pr.extension={type:[S.RendererSystem,S.CanvasRendererSystem],name:"_view"};P.add(pr);w.PREFER_ENV=we.WEBGL2;w.STRICT_TEXTURE_CACHE=!1;w.RENDER_OPTIONS={...dr.defaultOptions,...ur.defaultOptions,...pr.defaultOptions,...fr.defaultOptions};Object.defineProperties(w,{WRAP_MODE:{get(){return W.defaultOptions.wrapMode},set(e){rt("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),W.defaultOptions.wrapMode=e}},SCALE_MODE:{get(){return W.defaultOptions.scaleMode},set(e){rt("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),W.defaultOptions.scaleMode=e}},MIPMAP_TEXTURES:{get(){return W.defaultOptions.mipmap},set(e){rt("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),W.defaultOptions.mipmap=e}},ANISOTROPIC_LEVEL:{get(){return W.defaultOptions.anisotropicLevel},set(e){rt("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),W.defaultOptions.anisotropicLevel=e}},FILTER_RESOLUTION:{get(){return rt("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),ft.defaultResolution},set(e){ft.defaultResolution=e}},FILTER_MULTISAMPLE:{get(){return rt("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),ft.defaultMultisample},set(e){ft.defaultMultisample=e}},SPRITE_MAX_TEXTURES:{get(){return Pe.defaultMaxTextures},set(e){rt("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),Pe.defaultMaxTextures=e}},SPRITE_BATCH_SIZE:{get(){return Pe.defaultBatchSize},set(e){rt("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),Pe.defaultBatchSize=e}},CAN_UPLOAD_SAME_BUFFER:{get(){return Pe.canUploadSameBuffer},set(e){rt("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),Pe.canUploadSameBuffer=e}},GC_MODE:{get(){return ve.defaultMode},set(e){rt("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),ve.defaultMode=e}},GC_MAX_IDLE:{get(){return ve.defaultMaxIdle},set(e){rt("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),ve.defaultMaxIdle=e}},GC_MAX_CHECK_COUNT:{get(){return ve.defaultCheckCountMax},set(e){rt("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),ve.defaultCheckCountMax=e}},PRECISION_VERTEX:{get(){return Wt.defaultVertexPrecision},set(e){rt("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Wt.defaultVertexPrecision=e}},PRECISION_FRAGMENT:{get(){return Wt.defaultFragmentPrecision},set(e){rt("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Wt.defaultFragmentPrecision=e}}});var Ie=(e=>(e[e.INTERACTION=50]="INTERACTION",e[e.HIGH=25]="HIGH",e[e.NORMAL=0]="NORMAL",e[e.LOW=-25]="LOW",e[e.UTILITY=-50]="UTILITY",e))(Ie||{});var us=class{constructor(t,r=null,i=0,s=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=r,this.priority=i,this.once=s}match(t,r=null){return this.fn===t&&this.context===r}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));let r=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),r}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);let r=this.next;return this.next=t?null:r,this.previous=null,r}};var Re=class{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new us(null,null,1/0),this.deltaMS=1/Re.targetFPMS,this.elapsedMS=1/Re.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,t,r=Ie.NORMAL){return this._addListener(new us(e,t,r))}addOnce(e,t,r=Ie.NORMAL){return this._addListener(new us(e,t,r,!0))}_addListener(e){let t=this._head.next,r=this._head;if(!t)e.connect(r);else{for(;t;){if(e.priority>t.priority){e.connect(r);break}r=t,t=t.next}e.previous||e.connect(r)}return this._startIfPossible(),this}remove(e,t){let r=this._head.next;for(;r;)r.match(e,t)?r=r.destroy():r=r.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,t=this._head;for(;t=t.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let t;if(e>this.lastTime){if(t=this.elapsedMS=e-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){let s=e-this._lastFrame|0;if(s<this._minElapsedMS)return;this._lastFrame=e-s%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*Re.targetFPMS;let r=this._head,i=r.next;for(;i;)i=i.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){let t=Math.min(this.maxFPS,e),r=Math.min(Math.max(0,t)/1e3,Re.targetFPMS);this._maxElapsedMS=1/r}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{let t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!Re._shared){let e=Re._shared=new Re;e.autoStart=!0,e._protected=!0}return Re._shared}static get system(){if(!Re._system){let e=Re._system=new Re;e.autoStart=!0,e._protected=!0}return Re._system}},bt=Re;bt.targetFPMS=.06;Object.defineProperties(w,{TARGET_FPMS:{get(){return bt.targetFPMS},set(e){rt("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),bt.targetFPMS=e}}});var en=class{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(r){this._ticker&&this._ticker.remove(this.render,this),this._ticker=r,r&&r.add(this.render,this,Ie.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?bt.shared:new bt,t.autoStart&&this.start()}static destroy(){if(this._ticker){let t=this._ticker;this.ticker=null,t.destroy()}}};en.extension=S.Application;P.add(en);var kd=[];P.handleByList(S.Renderer,kd);function jh(e){for(let t of kd)if(t.test(e))return new t(e);throw new Error("Unable to auto-detect a suitable renderer.")}var Hd=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`;var Xd=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;var Yh=Hd,rn=Xd;var sn=class{constructor(t){this.renderer=t}contextChange(t){let r;if(this.renderer.context.webGLVersion===1){let i=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),r=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,i)}else{let i=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),r=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,i)}r>=dt.HIGH?this.multisample=dt.HIGH:r>=dt.MEDIUM?this.multisample=dt.MEDIUM:r>=dt.LOW?this.multisample=dt.LOW:this.multisample=dt.NONE}destroy(){}};sn.extension={type:S.RendererSystem,name:"_multisample"};P.add(sn);var Yo=class{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}};var nn=class{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){let{gl:r,CONTEXT_UID:i}=this,s=t._glBuffers[i]||this.createGLBuffer(t);r.bindBuffer(t.type,s.buffer)}unbind(t){let{gl:r}=this;r.bindBuffer(t,null)}bindBufferBase(t,r){let{gl:i,CONTEXT_UID:s}=this;if(this.boundBufferBases[r]!==t){let n=t._glBuffers[s]||this.createGLBuffer(t);this.boundBufferBases[r]=t,i.bindBufferBase(i.UNIFORM_BUFFER,r,n.buffer)}}bindBufferRange(t,r,i){let{gl:s,CONTEXT_UID:n}=this;i=i||0;let o=t._glBuffers[n]||this.createGLBuffer(t);s.bindBufferRange(s.UNIFORM_BUFFER,r||0,o.buffer,i*256,256)}update(t){let{gl:r,CONTEXT_UID:i}=this,s=t._glBuffers[i]||this.createGLBuffer(t);if(t._updateID!==s.updateID)if(s.updateID=t._updateID,r.bindBuffer(t.type,s.buffer),s.byteLength>=t.data.byteLength)r.bufferSubData(t.type,0,t.data);else{let n=t.static?r.STATIC_DRAW:r.DYNAMIC_DRAW;s.byteLength=t.data.byteLength,r.bufferData(t.type,t.data,n)}}dispose(t,r){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];let i=t._glBuffers[this.CONTEXT_UID],s=this.gl;t.disposeRunner.remove(this),i&&(r||s.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){let r=Object.keys(this.managedBuffers);for(let i=0;i<r.length;i++)this.dispose(this.managedBuffers[r[i]],t)}createGLBuffer(t){let{CONTEXT_UID:r,gl:i}=this;return t._glBuffers[r]=new Yo(i.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[r]}};nn.extension={type:S.RendererSystem,name:"buffer"};P.add(nn);var on=class{constructor(t){this.renderer=t}render(t,r){let i=this.renderer,s,n,o,a;if(r&&(s=r.renderTexture,n=r.clear,o=r.transform,a=r.skipUpdateTransform),this.renderingToScreen=!s,i.runners.prerender.emit(),i.emit("prerender"),i.projection.transform=o,!i.context.isLost){if(s||(this.lastObjectRendered=t),!a){let h=t.enableTempParent();t.updateTransform(),t.disableTempParent(h)}i.renderTexture.bind(s),i.batch.currentRenderer.start(),(n??i.background.clearBeforeRender)&&i.renderTexture.clear(),t.render(i),i.batch.currentRenderer.flush(),s&&(r.blit&&i.framebuffer.blit(),s.baseTexture.update()),i.runners.postrender.emit(),i.projection.transform=null,i.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}};on.extension={type:S.RendererSystem,name:"objectRenderer"};P.add(on);var qh=class extends hs{constructor(e){super(),this.type=ka.WEBGL,e=Object.assign({},w.RENDER_OPTIONS,e),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new Ut({projectionMatrix:new st},!0);let t={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:qh.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(t),"useContextAlpha"in e&&(rt("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),e.premultipliedAlpha=e.useContextAlpha&&e.useContextAlpha!=="notMultiplied",e.backgroundAlpha=e.useContextAlpha===!1?1:e.backgroundAlpha),this._plugin.rendererPlugins=qh.__plugins,this.options=e,this.startup.run(this.options)}static test(e){return e?.forceCanvas?!1:bo()}render(e,t){this.objectRenderer.render(e,t)}resize(e,t){this._view.resizeView(e,t)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(e=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:e}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(e){this._view.resolution=e,this.runners.resolutionChange.emit(e)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return rt("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return rt("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return rt("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return rt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(e){rt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=e}get backgroundAlpha(){return rt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(e){rt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=e}get powerPreference(){return rt("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(e,t){return this.textureGenerator.generateTexture(e,t)}},gi=qh;gi.extension={type:S.Renderer,priority:1};gi.__plugins={};gi.__systems={};P.handleByMap(S.RendererPlugin,gi.__plugins);P.handleByMap(S.RendererSystem,gi.__systems);P.add(gi);var Nr=class extends Ae{constructor(t,r){let{width:i,height:s}=r||{};super(i,s),this.items=[],this.itemDirtyIds=[];for(let n=0;n<t;n++){let o=new W;this.items.push(o),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,r){for(let i=0;i<this.length;i++)t[i]&&(t[i].castToBaseTexture?this.addBaseTextureAt(t[i].castToBaseTexture(),i):t[i]instanceof Ae?this.addResourceAt(t[i],i):this.addResourceAt(Wi(t[i],r),i))}dispose(){for(let t=0,r=this.length;t<r;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,r){if(!this.items[r])throw new Error(`Index ${r} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[r].setResource(t),this}bind(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let r=0;r<this.length;r++)this.items[r].parentTextureArray=t,this.items[r].on("update",t.update,t)}unbind(t){super.unbind(t);for(let r=0;r<this.length;r++)this.items[r].parentTextureArray=null,this.items[r].off("update",t.update,t)}load(){if(this._load)return this._load;let r=this.items.map(i=>i.resource).filter(i=>i).map(i=>i.load());return this._load=Promise.all(r).then(()=>{let{realWidth:i,realHeight:s}=this.items[0];return this.resize(i,s),Promise.resolve(this)}),this._load}};var ds=class extends Nr{constructor(t,r){let{width:i,height:s}=r||{},n,o;Array.isArray(t)?(n=t,o=t.length):o=t,super(o,{width:i,height:s}),n&&this.initFromArray(n,r)}addBaseTextureAt(t,r){if(t.resource)this.addResourceAt(t.resource,r);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(t){super.bind(t),t.target=ar.TEXTURE_2D_ARRAY}upload(t,r,i){let{length:s,itemDirtyIds:n,items:o}=this,{gl:a}=t;i.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,i.internalFormat,this._width,this._height,s,0,r.format,i.type,null);for(let h=0;h<s;h++){let l=o[h];n[h]<l.dirtyId&&(n[h]=l.dirtyId,l.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,h,l.resource.width,l.resource.height,1,r.format,i.type,l.resource.source))}return!0}};var fs=class extends Zt{constructor(t){super(t)}static test(t){let{OffscreenCanvas:r}=globalThis;return r&&t instanceof r?!0:globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}};var an=class extends Nr{constructor(e,t){let{width:r,height:i,autoLoad:s,linkBaseTexture:n}=t||{};if(e&&e.length!==an.SIDES)throw new Error(`Invalid length. Got ${e.length}, expected 6`);super(6,{width:r,height:i});for(let o=0;o<an.SIDES;o++)this.items[o].target=ar.TEXTURE_CUBE_MAP_POSITIVE_X+o;this.linkBaseTexture=n!==!1,e&&this.initFromArray(e,t),s!==!1&&this.load()}bind(e){super.bind(e),e.target=ar.TEXTURE_CUBE_MAP}addBaseTextureAt(e,t,r){if(r===void 0&&(r=this.linkBaseTexture),!this.items[t])throw new Error(`Index ${t} is out of bounds`);if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0)if(e.resource)this.addResourceAt(e.resource,t);else throw new Error("CubeResource does not support copying of renderTexture.");else e.target=ar.TEXTURE_CUBE_MAP_POSITIVE_X+t,e.parentTextureArray=this.baseTexture,this.items[t]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[t]=e,this}upload(e,t,r){let i=this.itemDirtyIds;for(let s=0;s<an.SIDES;s++){let n=this.items[s];(i[s]<n.dirtyId||r.dirtyId<t.dirtyId)&&(n.valid&&n.resource?(n.resource.upload(e,n,r),i[s]=n.dirtyId):i[s]<-1&&(e.gl.texImage2D(n.target,0,r.internalFormat,t.realWidth,t.realHeight,0,t.format,r.type,null),i[s]=-1))}return!0}static test(e){return Array.isArray(e)&&e.length===an.SIDES}},hn=an;hn.SIDES=6;var Xe=class extends Zt{constructor(t,r){r=r||{};let i,s;typeof t=="string"?(i=Xe.EMPTY,s=t):(i=t,s=null),super(i),this.url=s,this.crossOrigin=r.crossOrigin??!0,this.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,this._load=null,r.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(t,r)=>{if(this.url===null){t(this);return}try{let i=await w.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;let s=await i.blob();if(this.destroyed)return;let n=await createImageBitmap(s,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Bt.UNPACK?"premultiply":"none"});if(this.destroyed)return;this.source=n,this.update(),t(this)}catch(i){if(this.destroyed)return;r(i),this.onError.emit(i)}}),this._load)}upload(t,r,i){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),super.upload(t,r,i)):(this.load(),!1)}dispose(){this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof t=="string"||t instanceof ImageBitmap)}static get EMPTY(){return Xe._EMPTY=Xe._EMPTY??w.ADAPTER.createCanvas(0,0),Xe._EMPTY}};var qo=class extends Zt{constructor(e,t){t=t||{},super(w.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=e,this.scale=t.scale||1,this._overrideWidth=t.width,this._overrideHeight=t.height,this._resolve=null,this._crossorigin=t.crossorigin,this._load=null,t.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(e=>{if(this._resolve=()=>{this.resize(this.source.width,this.source.height),e(this)},qo.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){let e=new Image;Zt.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=t=>{this._resolve&&(e.onerror=null,this.onError.emit(t))},e.onload=()=>{if(!this._resolve)return;let t=e.width,r=e.height;if(!t||!r)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let i=t*this.scale,s=r*this.scale;(this._overrideWidth||this._overrideHeight)&&(i=this._overrideWidth||this._overrideHeight/r*t,s=this._overrideHeight||this._overrideWidth/t*r),i=Math.round(i),s=Math.round(s);let n=this.source;n.width=i,n.height=s,n._pixiId=`canvas_${Ze()}`,n.getContext("2d").drawImage(e,0,0,t,r,0,0,i,s),this._resolve(),this._resolve=null}}static getSize(e){let t=qo.SVG_SIZE.exec(e),r={};return t&&(r[t[1]]=Math.round(parseFloat(t[3])),r[t[5]]=Math.round(parseFloat(t[7]))),r}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(e,t){return t==="svg"||typeof e=="string"&&e.startsWith("data:image/svg+xml")||typeof e=="string"&&qo.SVG_XML.test(e)}},mr=qo;mr.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m;mr.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var Kh=class extends Zt{constructor(e,t){if(t=t||{},!(e instanceof HTMLVideoElement)){let r=document.createElement("video");r.setAttribute("preload","auto"),r.setAttribute("webkit-playsinline",""),r.setAttribute("playsinline",""),typeof e=="string"&&(e=[e]);let i=e[0].src||e[0];Zt.crossOrigin(r,i,t.crossorigin);for(let s=0;s<e.length;++s){let n=document.createElement("source"),{src:o,mime:a}=e[s];o=o||e[s];let h=o.split("?").shift().toLowerCase(),l=h.slice(h.lastIndexOf(".")+1);a=a||Kh.MIME_TYPES[l]||`video/${l}`,n.src=o,n.type=a,r.appendChild(n)}e=r}super(e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),t.autoLoad!==!1&&this.load()}update(e=0){if(!this.destroyed){let t=bt.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t),(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}load(){if(this._load)return this._load;let e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise(t=>{this.valid?t(this):(this._resolve=t,e.load())}),this._load}_onError(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e)}_isSourcePlaying(){let e=this.source;return!e.paused&&!e.ended&&this._isSourceReady()}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(bt.shared.add(this.update,this),this._isConnectedToTicker=!0)}_onPlayStop(){this._isConnectedToTicker&&(bt.shared.remove(this.update,this),this._isConnectedToTicker=!1)}_onCanPlay(){let e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);let t=this.valid;this.resize(e.videoWidth,e.videoHeight),!t&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()}dispose(){this._isConnectedToTicker&&(bt.shared.remove(this.update,this),this._isConnectedToTicker=!1);let e=this.source;e&&(e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(bt.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(bt.shared.add(this.update,this),this._isConnectedToTicker=!0))}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e)}static test(e,t){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement||Kh.TYPES.includes(t)}},ps=Kh;ps.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];ps.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};zi.push(Xe,Fr,fs,ps,mr,xe,hn,ds);var Qe=class{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?$.EMPTY:(t=t||new $(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,r){let{a:i,b:s,c:n,d:o,tx:a,ty:h}=t,l=i*r.x+n*r.y+a,c=s*r.x+o*r.y+h;this.minX=Math.min(this.minX,l),this.maxX=Math.max(this.maxX,l),this.minY=Math.min(this.minY,c),this.maxY=Math.max(this.maxY,c)}addQuad(t){let r=this.minX,i=this.minY,s=this.maxX,n=this.maxY,o=t[0],a=t[1];r=o<r?o:r,i=a<i?a:i,s=o>s?o:s,n=a>n?a:n,o=t[2],a=t[3],r=o<r?o:r,i=a<i?a:i,s=o>s?o:s,n=a>n?a:n,o=t[4],a=t[5],r=o<r?o:r,i=a<i?a:i,s=o>s?o:s,n=a>n?a:n,o=t[6],a=t[7],r=o<r?o:r,i=a<i?a:i,s=o>s?o:s,n=a>n?a:n,this.minX=r,this.minY=i,this.maxX=s,this.maxY=n}addFrame(t,r,i,s,n){this.addFrameMatrix(t.worldTransform,r,i,s,n)}addFrameMatrix(t,r,i,s,n){let o=t.a,a=t.b,h=t.c,l=t.d,c=t.tx,u=t.ty,d=this.minX,f=this.minY,p=this.maxX,g=this.maxY,_=o*r+h*i+c,y=a*r+l*i+u;d=_<d?_:d,f=y<f?y:f,p=_>p?_:p,g=y>g?y:g,_=o*s+h*i+c,y=a*s+l*i+u,d=_<d?_:d,f=y<f?y:f,p=_>p?_:p,g=y>g?y:g,_=o*r+h*n+c,y=a*r+l*n+u,d=_<d?_:d,f=y<f?y:f,p=_>p?_:p,g=y>g?y:g,_=o*s+h*n+c,y=a*s+l*n+u,d=_<d?_:d,f=y<f?y:f,p=_>p?_:p,g=y>g?y:g,this.minX=d,this.minY=f,this.maxX=p,this.maxY=g}addVertexData(t,r,i){let s=this.minX,n=this.minY,o=this.maxX,a=this.maxY;for(let h=r;h<i;h+=2){let l=t[h],c=t[h+1];s=l<s?l:s,n=c<n?c:n,o=l>o?l:o,a=c>a?c:a}this.minX=s,this.minY=n,this.maxX=o,this.maxY=a}addVertices(t,r,i,s){this.addVerticesMatrix(t.worldTransform,r,i,s)}addVerticesMatrix(t,r,i,s,n=0,o=n){let a=t.a,h=t.b,l=t.c,c=t.d,u=t.tx,d=t.ty,f=this.minX,p=this.minY,g=this.maxX,_=this.maxY;for(let y=i;y<s;y+=2){let T=r[y],x=r[y+1],v=a*T+l*x+u,N=c*x+h*T+d;f=Math.min(f,v-n),g=Math.max(g,v+n),p=Math.min(p,N-o),_=Math.max(_,N+o)}this.minX=f,this.minY=p,this.maxX=g,this.maxY=_}addBounds(t){let r=this.minX,i=this.minY,s=this.maxX,n=this.maxY;this.minX=t.minX<r?t.minX:r,this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>s?t.maxX:s,this.maxY=t.maxY>n?t.maxY:n}addBoundsMask(t,r){let i=t.minX>r.minX?t.minX:r.minX,s=t.minY>r.minY?t.minY:r.minY,n=t.maxX<r.maxX?t.maxX:r.maxX,o=t.maxY<r.maxY?t.maxY:r.maxY;if(i<=n&&s<=o){let a=this.minX,h=this.minY,l=this.maxX,c=this.maxY;this.minX=i<a?i:a,this.minY=s<h?s:h,this.maxX=n>l?n:l,this.maxY=o>c?o:c}}addBoundsMatrix(t,r){this.addFrameMatrix(r,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,r){let i=t.minX>r.x?t.minX:r.x,s=t.minY>r.y?t.minY:r.y,n=t.maxX<r.x+r.width?t.maxX:r.x+r.width,o=t.maxY<r.y+r.height?t.maxY:r.y+r.height;if(i<=n&&s<=o){let a=this.minX,h=this.minY,l=this.maxX,c=this.maxY;this.minX=i<a?i:a,this.minY=s<h?s:h,this.maxX=n>l?n:l,this.maxY=o>c?o:c}}pad(t=0,r=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=r,this.maxY+=r)}addFramePad(t,r,i,s,n,o){t-=n,r-=o,i+=n,s+=o,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<r?this.minY:r,this.maxY=this.maxY>s?this.maxY:s}};var ct=class extends O.EventEmitter{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new ui,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Qe,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){let r=Object.keys(t);for(let i=0;i<r.length;++i){let s=r[i];Object.defineProperty(ct.prototype,s,Object.getOwnPropertyDescriptor(t,s))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,r){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),r||(this._boundsRect||(this._boundsRect=new $),r=this._boundsRect),this._bounds.getRectangle(r)}getLocalBounds(t){t||(this._localBoundsRect||(this._localBoundsRect=new $),t=this._localBoundsRect),this._localBounds||(this._localBounds=new Qe);let r=this.transform,i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;let s=this._bounds,n=this._boundsID;this._bounds=this._localBounds;let o=this.getBounds(!1,t);return this.parent=i,this.transform=r,this._bounds=s,this._bounds.updateID+=this._boundsID-n,o}toGlobal(t,r,i=!1){return i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,r)}toLocal(t,r,i,s){return r&&(t=r.toGlobal(t,i,s)),s||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){this.parent?.removeChild(this)}setTransform(t=0,r=0,i=1,s=1,n=0,o=0,a=0,h=0,l=0){return this.position.x=t,this.position.y=r,this.scale.x=i||1,this.scale.y=s||1,this.rotation=n,this.skew.x=o,this.skew.y=a,this.pivot.x=h,this.pivot.y=l,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new Ko),this.tempDisplayObjectParent}enableTempParent(){let t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*Fh}set angle(t){this.transform.rotation=t*Lh}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){let r=this._mask.isMaskData?this._mask.maskObject:this._mask;r&&(r._maskRefCount--,r._maskRefCount===0&&(r.renderable=!0,r.isMask=!1))}if(this._mask=t,this._mask){let r=this._mask.isMaskData?this._mask.maskObject:this._mask;r&&(r._maskRefCount===0&&(r.renderable=!1,r.isMask=!0),r._maskRefCount++)}}}},Ko=class extends ct{constructor(){super(...arguments),this.sortDirty=null}};ct.prototype.displayObjectUpdateTransform=ct.prototype.updateTransform;var cx=new st;function ux(e,t){return e.zIndex===t.zIndex?e._lastSortedIndex-t._lastSortedIndex:e.zIndex-t.zIndex}var Zh=class extends ct{constructor(){super(),this.children=[],this.sortableChildren=Zh.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(e){}addChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.addChild(e[t]);else{let t=e[0];t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this)}return e[0]}addChildAt(e,t){if(t<0||t>this.children.length)throw new Error(`${e}addChildAt: The index ${t} supplied is out of bounds ${this.children.length}`);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(t,0,e),this._boundsID++,this.onChildrenChange(t),e.emit("added",this),this.emit("childAdded",e,this,t),e}swapChildren(e,t){if(e===t)return;let r=this.getChildIndex(e),i=this.getChildIndex(t);this.children[r]=t,this.children[i]=e,this.onChildrenChange(r<i?r:i)}getChildIndex(e){let t=this.children.indexOf(e);if(t===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return t}setChildIndex(e,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);let r=this.getChildIndex(e);O.removeItems(this.children,r,1),this.children.splice(t,0,e),this.onChildrenChange(t)}getChildAt(e){if(e<0||e>=this.children.length)throw new Error(`getChildAt: Index (${e}) does not exist.`);return this.children[e]}removeChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.removeChild(e[t]);else{let t=e[0],r=this.children.indexOf(t);if(r===-1)return null;t.parent=null,t.transform._parentID=-1,O.removeItems(this.children,r,1),this._boundsID++,this.onChildrenChange(r),t.emit("removed",this),this.emit("childRemoved",t,this,r)}return e[0]}removeChildAt(e){let t=this.getChildAt(e);return t.parent=null,t.transform._parentID=-1,O.removeItems(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit("removed",this),this.emit("childRemoved",t,this,e),t}removeChildren(e=0,t=this.children.length){let r=e,i=t,s=i-r,n;if(s>0&&s<=i){n=this.children.splice(r,s);for(let o=0;o<n.length;++o)n[o].parent=null,n[o].transform&&(n[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(let o=0;o<n.length;++o)n[o].emit("removed",this),this.emit("childRemoved",n[o],this,o);return n}else if(s===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let e=!1;for(let t=0,r=this.children.length;t<r;++t){let i=this.children[t];i._lastSortedIndex=t,!e&&i.zIndex!==0&&(e=!0)}e&&this.children.length>1&&this.children.sort(ux),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let e=0,t=this.children.length;e<t;++e){let r=this.children[e];r.visible&&r.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let e=0;e<this.children.length;e++){let t=this.children[e];if(!(!t.visible||!t.renderable))if(t.calculateBounds(),t._mask){let r=t._mask.isMaskData?t._mask.maskObject:t._mask;r?(r.calculateBounds(),this._bounds.addBoundsMask(t._bounds,r._bounds)):this._bounds.addBounds(t._bounds)}else t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(e,t=!1){let r=super.getLocalBounds(e);if(!t)for(let i=0,s=this.children.length;i<s;++i){let n=this.children[i];n.visible&&n.updateTransform()}return r}_calculateBounds(){}_renderWithCulling(e){let t=e.renderTexture.sourceFrame;if(!(t.width>0&&t.height>0))return;let r,i;this.cullArea?(r=this.cullArea,i=this.worldTransform):this._render!==Zh.prototype._render&&(r=this.getBounds(!0));let s=e.projection.transform;if(s&&(i?(i=cx.copyFrom(i),i.prepend(s)):i=s),r&&t.intersects(r,i))this._render(e);else if(this.cullArea)return;for(let n=0,o=this.children.length;n<o;++n){let a=this.children[n],h=a.cullable;a.cullable=h||!this.cullArea,a.render(e),a.cullable=h}}render(e){if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||this.filters?.length)this.renderAdvanced(e);else if(this.cullable)this._renderWithCulling(e);else{this._render(e);for(let t=0,r=this.children.length;t<r;++t)this.children[t].render(e)}}renderAdvanced(e){let t=this.filters,r=this._mask;if(t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let s=0;s<t.length;s++)t[s].enabled&&this._enabledFilters.push(t[s])}let i=t&&this._enabledFilters?.length||r&&(!r.isMaskData||r.enabled&&(r.autoDetect||r.type!==Et.NONE));if(i&&e.batch.flush(),t&&this._enabledFilters?.length&&e.filter.push(this,this._enabledFilters),r&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e);for(let s=0,n=this.children.length;s<n;++s)this.children[s].render(e)}i&&e.batch.flush(),r&&e.mask.pop(this),t&&this._enabledFilters?.length&&e.filter.pop()}_render(e){}destroy(e){super.destroy(),this.sortDirty=!1;let t=typeof e=="boolean"?e:e?.children,r=this.removeChildren(0,this.children.length);if(t)for(let i=0;i<r.length;++i)r[i].destroy(e)}get width(){return this.scale.x*this.getLocalBounds().width}set width(e){let t=this.getLocalBounds().width;t!==0?this.scale.x=e/t:this.scale.x=1,this._width=e}get height(){return this.scale.y*this.getLocalBounds().height}set height(e){let t=this.getLocalBounds().height;t!==0?this.scale.y=e/t:this.scale.y=1,this._height=e}},St=Zh;St.defaultSortableChildren=!1;St.prototype.containerUpdateTransform=St.prototype.updateTransform;Object.defineProperties(w,{SORTABLE_CHILDREN:{get(){return St.defaultSortableChildren},set(e){O.deprecation("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),St.defaultSortableChildren=e}}});var ln=new Q,dx=new Uint16Array([0,1,2,0,2,3]),be=class extends St{constructor(t){super(),this._anchor=new _e(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new tt(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=q.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||H.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=dx,this.pluginName="batch",this.isSprite=!0,this._roundPixels=w.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=O.sign(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=O.sign(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){let t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;let r=this.transform.worldTransform,i=r.a,s=r.b,n=r.c,o=r.d,a=r.tx,h=r.ty,l=this.vertexData,c=t.trim,u=t.orig,d=this._anchor,f=0,p=0,g=0,_=0;if(c?(p=c.x-d._x*u.width,f=p+c.width,_=c.y-d._y*u.height,g=_+c.height):(p=-d._x*u.width,f=p+u.width,_=-d._y*u.height,g=_+u.height),l[0]=i*p+n*_+a,l[1]=o*_+s*p+h,l[2]=i*f+n*_+a,l[3]=o*_+s*f+h,l[4]=i*f+n*g+a,l[5]=o*g+s*f+h,l[6]=i*p+n*g+a,l[7]=o*g+s*p+h,this._roundPixels){let y=w.RESOLUTION;for(let T=0;T<l.length;++T)l[T]=Math.round(l[T]*y)/y}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;let t=this._texture,r=this.vertexTrimmedData,i=t.orig,s=this._anchor,n=this.transform.worldTransform,o=n.a,a=n.b,h=n.c,l=n.d,c=n.tx,u=n.ty,d=-s._x*i.width,f=d+i.width,p=-s._y*i.height,g=p+i.height;r[0]=o*d+h*p+c,r[1]=l*p+a*d+u,r[2]=o*f+h*p+c,r[3]=l*p+a*f+u,r[4]=o*f+h*g+c,r[5]=l*g+a*f+u,r[6]=o*d+h*g+c,r[7]=l*g+a*d+u}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){let t=this._texture.trim,r=this._texture.orig;!t||t.width===r.width&&t.height===r.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return this.children.length===0?(this._localBounds||(this._localBounds=new Qe),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new $),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,ln);let r=this._texture.orig.width,i=this._texture.orig.height,s=-r*this.anchor.x,n=0;return ln.x>=s&&ln.x<s+r&&(n=-i*this.anchor.y,ln.y>=n&&ln.y<n+i)}destroy(t){if(super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof t=="boolean"?t:t?.texture){let i=typeof t=="boolean"?t:t?.baseTexture;this._texture.destroy(!!i)}this._texture=null}static from(t,r){let i=t instanceof H?t:H.from(t,r);return new be(i)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){let r=O.sign(this.scale.x)||1;this.scale.x=r*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){let r=O.sign(this.scale.y)||1;this.scale.y=r*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||H.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}};var Vd=new st;ct.prototype._cacheAsBitmap=!1;ct.prototype._cacheData=null;ct.prototype._cacheAsBitmapResolution=null;ct.prototype._cacheAsBitmapMultisample=null;var Jh=class{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}};Object.defineProperties(ct.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(e){e!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=e,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(e){e!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=e,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(e){if(this._cacheAsBitmap===e)return;this._cacheAsBitmap=e;let t;e?(this._cacheData||(this._cacheData=new Jh),t=this._cacheData,t.originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(t=this._cacheData,t.sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea)}}});ct.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))};ct.prototype._initCachedDisplayObject=function(t){if(this._cacheData?.sprite)return;let r=this.alpha;this.alpha=1,t.batch.flush();let i=this.getLocalBounds(null,!0).clone();if(this.filters?.length){let d=this.filters[0].padding;i.pad(d)}i.ceil(w.RESOLUTION);let s=t.renderTexture.current,n=t.renderTexture.sourceFrame.clone(),o=t.renderTexture.destinationFrame.clone(),a=t.projection.transform,h=ye.create({width:i.width,height:i.height,resolution:this.cacheAsBitmapResolution||t.resolution,multisample:this.cacheAsBitmapMultisample??t.multisample}),l=`cacheAsBitmap_${O.uid()}`;this._cacheData.textureCacheId=l,W.addToCache(h.baseTexture,l),H.addToCache(h,l);let c=this.transform.localTransform.copyTo(Vd).invert().translate(-i.x,-i.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:h,clear:!0,transform:c,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=a,t.renderTexture.bind(s,n,o),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=r;let u=new be(h);u.transform.worldTransform=this.transform.worldTransform,u.anchor.x=-(i.x/i.width),u.anchor.y=-(i.y/i.height),u.alpha=r,u._bounds=this._bounds,this._cacheData.sprite=u,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=u.containsPoint.bind(u)};ct.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))};ct.prototype._initCachedDisplayObjectCanvas=function(t){if(this._cacheData?.sprite)return;let r=this.getLocalBounds(null,!0),i=this.alpha;this.alpha=1;let s=t.canvasContext.activeContext,n=t._projTransform;r.ceil(w.RESOLUTION);let o=ye.create({width:r.width,height:r.height}),a=`cacheAsBitmap_${O.uid()}`;this._cacheData.textureCacheId=a,W.addToCache(o.baseTexture,a),H.addToCache(o,a);let h=Vd;this.transform.localTransform.copyTo(h),h.invert(),h.tx-=r.x,h.ty-=r.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:o,clear:!0,transform:h,skipUpdateTransform:!1}),t.canvasContext.activeContext=s,t._projTransform=n,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=i;let l=new be(o);l.transform.worldTransform=this.transform.worldTransform,l.anchor.x=-(r.x/r.width),l.anchor.y=-(r.y/r.height),l.alpha=i,l._bounds=this._bounds,this._cacheData.sprite=l,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=l.containsPoint.bind(l)};ct.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};ct.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};ct.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,W.removeFromCache(this._cacheData.textureCacheId),H.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};ct.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)};ct.prototype.name=null;St.prototype.getChildByName=function(t,r){for(let i=0,s=this.children.length;i<s;i++)if(this.children[i].name===t)return this.children[i];if(r)for(let i=0,s=this.children.length;i<s;i++){let n=this.children[i];if(!n.getChildByName)continue;let o=n.getChildByName(t,!0);if(o)return o}return null};ct.prototype.getGlobalPosition=function(t=new Q,r=!1){return this.parent?this.parent.toGlobal(this.position,t,r):(t.x=this.position.x,t.y=this.position.y),t};var zd=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;var cn=class extends ft{constructor(t=1){super(Yh,zd,{uAlpha:1}),this.alpha=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}};var fx={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},px=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function Wd(e){let t=fx[e],r=t.length,i=px,s="",n="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;",o;for(let a=0;a<e;a++){let h=n.replace("%index%",a.toString());o=a,a>=r&&(o=e-a-1),h=h.replace("%value%",t[o].toString()),s+=h,s+=`
`}return i=i.replace("%blur%",s),i=i.replace("%size%",e.toString()),i}var mx=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function $d(e,t){let r=Math.ceil(e/2),i=mx,s="",n;t?n="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":n="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let o=0;o<e;o++){let a=n.replace("%index%",o.toString());a=a.replace("%sampleIndex%",`${o-(r-1)}.0`),s+=a,s+=`
`}return i=i.replace("%blur%",s),i=i.replace("%size%",e.toString()),i}var Ur=class extends ft{constructor(t,r=8,i=4,s=ft.defaultResolution,n=5){let o=$d(n,t),a=Wd(n);super(o,a),this.horizontal=t,this.resolution=s,this._quality=0,this.quality=i,this.blur=r}apply(t,r,i,s){if(i?this.horizontal?this.uniforms.strength=1/i.width*(i.width/r.width):this.uniforms.strength=1/i.height*(i.height/r.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/r.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/r.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)t.applyFilter(this,r,i,s);else{let n=t.getFilterTexture(),o=t.renderer,a=r,h=n;this.state.blend=!1,t.applyFilter(this,a,h,Se.CLEAR);for(let l=1;l<this.passes-1;l++){t.bindAndClear(a,Se.BLIT),this.uniforms.uSampler=h;let c=h;h=a,a=c,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,h,i,s),t.returnFilterTexture(n)}}get blur(){return this.strength}set blur(t){this.padding=1+Math.abs(t)*2,this.strength=t}get quality(){return this._quality}set quality(t){this._quality=t,this.passes=t}};var un=class extends ft{constructor(t=8,r=4,i=ft.defaultResolution,s=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new Ur(!0,t,r,i,s),this.blurYFilter=new Ur(!1,t,r,i,s),this.resolution=i,this.quality=r,this.blur=t,this.repeatEdgePixels=!1}apply(t,r,i,s){let n=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(n&&o){let a=t.getFilterTexture();this.blurXFilter.apply(t,r,a,Se.CLEAR),this.blurYFilter.apply(t,a,i,s),t.returnFilterTexture(a)}else o?this.blurYFilter.apply(t,r,i,s):this.blurXFilter.apply(t,r,i,s)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(t){this.blurXFilter.quality=this.blurYFilter.quality=t}get blurX(){return this.blurXFilter.blur}set blurX(t){this.blurXFilter.blur=t,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(t){this.blurYFilter.blur=t,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(t){this.blurYFilter.blendMode=t}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(t){this._repeatEdgePixels=t,this.updatePadding()}};var jd=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;var xi=class extends ft{constructor(){let t={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(rn,jd,t),this.alpha=1}_loadMatrix(t,r=!1){let i=t;r&&(this._multiply(i,this.uniforms.m,t),i=this._colorMatrix(i)),this.uniforms.m=i}_multiply(t,r,i){return t[0]=r[0]*i[0]+r[1]*i[5]+r[2]*i[10]+r[3]*i[15],t[1]=r[0]*i[1]+r[1]*i[6]+r[2]*i[11]+r[3]*i[16],t[2]=r[0]*i[2]+r[1]*i[7]+r[2]*i[12]+r[3]*i[17],t[3]=r[0]*i[3]+r[1]*i[8]+r[2]*i[13]+r[3]*i[18],t[4]=r[0]*i[4]+r[1]*i[9]+r[2]*i[14]+r[3]*i[19]+r[4],t[5]=r[5]*i[0]+r[6]*i[5]+r[7]*i[10]+r[8]*i[15],t[6]=r[5]*i[1]+r[6]*i[6]+r[7]*i[11]+r[8]*i[16],t[7]=r[5]*i[2]+r[6]*i[7]+r[7]*i[12]+r[8]*i[17],t[8]=r[5]*i[3]+r[6]*i[8]+r[7]*i[13]+r[8]*i[18],t[9]=r[5]*i[4]+r[6]*i[9]+r[7]*i[14]+r[8]*i[19]+r[9],t[10]=r[10]*i[0]+r[11]*i[5]+r[12]*i[10]+r[13]*i[15],t[11]=r[10]*i[1]+r[11]*i[6]+r[12]*i[11]+r[13]*i[16],t[12]=r[10]*i[2]+r[11]*i[7]+r[12]*i[12]+r[13]*i[17],t[13]=r[10]*i[3]+r[11]*i[8]+r[12]*i[13]+r[13]*i[18],t[14]=r[10]*i[4]+r[11]*i[9]+r[12]*i[14]+r[13]*i[19]+r[14],t[15]=r[15]*i[0]+r[16]*i[5]+r[17]*i[10]+r[18]*i[15],t[16]=r[15]*i[1]+r[16]*i[6]+r[17]*i[11]+r[18]*i[16],t[17]=r[15]*i[2]+r[16]*i[7]+r[17]*i[12]+r[18]*i[17],t[18]=r[15]*i[3]+r[16]*i[8]+r[17]*i[13]+r[18]*i[18],t[19]=r[15]*i[4]+r[16]*i[9]+r[17]*i[14]+r[18]*i[19]+r[19],t}_colorMatrix(t){let r=new Float32Array(t);return r[4]/=255,r[9]/=255,r[14]/=255,r[19]/=255,r}brightness(t,r){let i=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(i,r)}tint(t,r){let[i,s,n]=tt.shared.setValue(t).toArray(),o=[i,0,0,0,0,0,s,0,0,0,0,0,n,0,0,0,0,0,1,0];this._loadMatrix(o,r)}greyscale(t,r){let i=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(i,r)}blackAndWhite(t){let r=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(r,t)}hue(t,r){t=(t||0)/180*Math.PI;let i=Math.cos(t),s=Math.sin(t),n=Math.sqrt,o=1/3,a=n(o),h=i+(1-i)*o,l=o*(1-i)-a*s,c=o*(1-i)+a*s,u=o*(1-i)+a*s,d=i+o*(1-i),f=o*(1-i)-a*s,p=o*(1-i)-a*s,g=o*(1-i)+a*s,_=i+o*(1-i),y=[h,l,c,0,0,u,d,f,0,0,p,g,_,0,0,0,0,0,1,0];this._loadMatrix(y,r)}contrast(t,r){let i=(t||0)+1,s=-.5*(i-1),n=[i,0,0,0,s,0,i,0,0,s,0,0,i,0,s,0,0,0,1,0];this._loadMatrix(n,r)}saturate(t=0,r){let i=t*2/3+1,s=(i-1)*-.5,n=[i,s,s,0,0,s,i,s,0,0,s,s,i,0,0,0,0,0,1,0];this._loadMatrix(n,r)}desaturate(){this.saturate(-1)}negative(t){let r=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(r,t)}sepia(t){let r=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(r,t)}technicolor(t){let r=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(r,t)}polaroid(t){let r=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(r,t)}toBGR(t){let r=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(r,t)}kodachrome(t){let r=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(r,t)}browni(t){let r=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(r,t)}vintage(t){let r=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(r,t)}colorTone(t,r,i,s,n){t=t||.2,r=r||.15,i=i||16770432,s=s||3375104;let o=tt.shared,[a,h,l]=o.setValue(i).toArray(),[c,u,d]=o.setValue(s).toArray(),f=[.3,.59,.11,0,0,a,h,l,t,0,c,u,d,r,0,a-c,h-u,l-d,0,0];this._loadMatrix(f,n)}night(t,r){t=t||.1;let i=[t*-2,-t,0,0,0,-t,0,t,0,0,0,t,t*2,0,0,0,0,0,1,0];this._loadMatrix(i,r)}predator(t,r){let i=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(i,r)}lsd(t){let r=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(r,t)}reset(){let t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(t,!1)}get matrix(){return this.uniforms.m}set matrix(t){this.uniforms.m=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}};xi.prototype.grayscale=xi.prototype.greyscale;var Yd=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`;var qd=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;var dn=class extends ft{constructor(t,r){let i=new st;t.renderable=!1,super(qd,Yd,{mapSampler:t._texture,filterMatrix:i,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=t,this.maskMatrix=i,r==null&&(r=20),this.scale=new Q(r,r)}apply(t,r,i,s){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;let n=this.maskSprite.worldTransform,o=Math.sqrt(n.a*n.a+n.b*n.b),a=Math.sqrt(n.c*n.c+n.d*n.d);o!==0&&a!==0&&(this.uniforms.rotation[0]=n.a/o,this.uniforms.rotation[1]=n.b/o,this.uniforms.rotation[2]=n.c/a,this.uniforms.rotation[3]=n.d/a),t.applyFilter(this,r,i,s)}get map(){return this.uniforms.mapSampler}set map(t){this.uniforms.mapSampler=t}};var Kd=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`;var Zd=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;var fn=class extends ft{constructor(){super(Zd,Kd)}};var Jd=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;var pn=class extends ft{constructor(t=.5,r=Math.random()){super(rn,Jd,{uNoise:0,uSeed:0}),this.noise=t,this.seed=r}get noise(){return this.uniforms.uNoise}set noise(t){this.uniforms.uNoise=t}get seed(){return this.uniforms.uSeed}set seed(t){this.uniforms.uSeed=t}};var Qh={AlphaFilter:cn,BlurFilter:un,BlurFilterPass:Ur,ColorMatrixFilter:xi,DisplacementFilter:dn,FXAAFilter:fn,NoiseFilter:pn};Object.entries(Qh).forEach(([e,t])=>{Object.defineProperty(Qh,e,{get(){return O.deprecation("7.1.0",`filters.${e} has moved to ${e}`),t}})});var tl=class{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(t){this.removeTickerListener(),this.events=t,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(t){this._pauseUpdate=t}addTickerListener(){this.tickerAdded||!this.domElement||(bt.system.add(this.tickerUpdate,this,Ie.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(bt.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}let t=this.events.rootPointerEvent;this.events.supportsTouchEvents&&t.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:t.clientX,clientY:t.clientY}))}tickerUpdate(t){this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}},tr=new tl;var Ve=class{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=Ve.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new Q,this.page=new Q,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,r,i){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,r,i,s,n){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}};var er=class extends Ve{constructor(){super(...arguments),this.client=new Q,this.movement=new Q,this.offset=new Q,this.global=new Q,this.screen=new Q}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(t,r,i){return t.worldTransform.applyInverse(i||this.global,r)}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,r,i,s,n,o,a,h,l,c,u,d,f,p,g){throw new Error("Method not implemented.")}};var se=class extends er{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}};var ze=class extends er{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}};ze.DOM_DELTA_PIXEL=0;ze.DOM_DELTA_LINE=1;ze.DOM_DELTA_PAGE=2;var gx=2048,xx=new Q,el=new Q,mn=class{constructor(t){this.dispatch=new O.EventEmitter,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,r){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:r,priority:0}),this.mappingTable[t].sort((i,s)=>i.priority-s.priority)}dispatchEvent(t,r){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,r),this.dispatch.emit(r||t.type,t)}mapEvent(t){if(!this.rootTarget)return;let r=this.mappingTable[t.type];if(r)for(let i=0,s=r.length;i<s;i++)r[i].fn(t);else console.warn(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,r){tr.pauseUpdate=!0;let s=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",n=this[s](this.rootTarget,this.rootTarget.eventMode,xx.set(t,r),this.hitTestFn,this.hitPruneFn);return n&&n[0]}propagate(t,r){if(!t.target)return;let i=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let s=0,n=i.length-1;s<n;s++)if(t.currentTarget=i[s],this.notifyTarget(t,r),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,r),!(t.propagationStopped||t.propagationImmediatelyStopped)){t.eventPhase=t.BUBBLING_PHASE;for(let s=i.length-2;s>=0;s--)if(t.currentTarget=i[s],this.notifyTarget(t,r),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,r,i=this._allInteractiveElements){if(i.length===0)return;t.eventPhase=t.BUBBLING_PHASE;let s=Array.isArray(r)?r:[r];for(let n=i.length-1;n>=0;n--)s.forEach(o=>{t.currentTarget=i[n],this.notifyTarget(t,o)})}propagationPath(t){let r=[t];for(let i=0;i<gx&&t!==this.rootTarget;i++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");r.push(t.parent),t=t.parent}return r.reverse(),r}hitTestMoveRecursive(t,r,i,s,n,o=!1){let a=!1;if(this._interactivePrune(t))return null;if((t.eventMode==="dynamic"||r==="dynamic")&&(tr.pauseUpdate=!1),t.interactiveChildren&&t.children){let c=t.children;for(let u=c.length-1;u>=0;u--){let d=c[u],f=this.hitTestMoveRecursive(d,this._isInteractive(r)?r:d.eventMode,i,s,n,o||n(t,i));if(f){if(f.length>0&&!f[f.length-1].parent)continue;let p=t.isInteractive();(f.length>0||p)&&(p&&this._allInteractiveElements.push(t),f.push(t)),this._hitElements.length===0&&(this._hitElements=f),a=!0}}}let h=this._isInteractive(r),l=t.isInteractive();return l&&l&&this._allInteractiveElements.push(t),o||this._hitElements.length>0?null:a?this._hitElements:h&&!n(t,i)&&s(t,i)?l?[t]:[]:null}hitTestRecursive(t,r,i,s,n){if(this._interactivePrune(t)||n(t,i))return null;if((t.eventMode==="dynamic"||r==="dynamic")&&(tr.pauseUpdate=!1),t.interactiveChildren&&t.children){let h=t.children;for(let l=h.length-1;l>=0;l--){let c=h[l],u=this.hitTestRecursive(c,this._isInteractive(r)?r:c.eventMode,i,s,n);if(u){if(u.length>0&&!u[u.length-1].parent)continue;let d=t.isInteractive();return(u.length>0||d)&&u.push(t),u}}}let o=this._isInteractive(r),a=t.isInteractive();return o&&s(t,i)?a?[t]:[]:null}_isInteractive(t){return t==="static"||t==="dynamic"}_interactivePrune(t){return!!(!t||t.isMask||!t.visible||!t.renderable||t.eventMode==="none"||t.eventMode==="passive"&&!t.interactiveChildren||t.isMask)}hitPruneFn(t,r){if(t.hitArea&&(t.worldTransform.applyInverse(r,el),!t.hitArea.contains(el.x,el.y)))return!0;if(t._mask){let i=t._mask.isMaskData?t._mask.maskObject:t._mask;if(i&&!i.containsPoint?.(r))return!0}return!1}hitTestFn(t,r){return t.eventMode==="passive"?!1:t.hitArea?!0:t.containsPoint?t.containsPoint(r):!1}notifyTarget(t,r){r=r??t.type;let i=`on${r}`;t.currentTarget[i]?.(t);let s=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${r}capture`:r;this.notifyListeners(t,s),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,r)}mapPointerDown(t){if(!(t instanceof se)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let r=this.createPointerEvent(t);if(this.dispatchEvent(r,"pointerdown"),r.pointerType==="touch")this.dispatchEvent(r,"touchstart");else if(r.pointerType==="mouse"||r.pointerType==="pen"){let s=r.button===2;this.dispatchEvent(r,s?"rightdown":"mousedown")}let i=this.trackingData(t.pointerId);i.pressTargetsByButton[t.button]=r.composedPath(),this.freeEvent(r)}mapPointerMove(t){if(!(t instanceof se)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;let r=this.createPointerEvent(t);this._isPointerMoveEvent=!1;let i=r.pointerType==="mouse"||r.pointerType==="pen",s=this.trackingData(t.pointerId),n=this.findMountedTarget(s.overTargets);if(s.overTargets?.length>0&&n!==r.target){let h=t.type==="mousemove"?"mouseout":"pointerout",l=this.createPointerEvent(t,h,n);if(this.dispatchEvent(l,"pointerout"),i&&this.dispatchEvent(l,"mouseout"),!r.composedPath().includes(n)){let c=this.createPointerEvent(t,"pointerleave",n);for(c.eventPhase=c.AT_TARGET;c.target&&!r.composedPath().includes(c.target);)c.currentTarget=c.target,this.notifyTarget(c),i&&this.notifyTarget(c,"mouseleave"),c.target=c.target.parent;this.freeEvent(c)}this.freeEvent(l)}if(n!==r.target){let h=t.type==="mousemove"?"mouseover":"pointerover",l=this.clonePointerEvent(r,h);this.dispatchEvent(l,"pointerover"),i&&this.dispatchEvent(l,"mouseover");let c=n?.parent;for(;c&&c!==this.rootTarget.parent&&c!==r.target;)c=c.parent;if(!c||c===this.rootTarget.parent){let d=this.clonePointerEvent(r,"pointerenter");for(d.eventPhase=d.AT_TARGET;d.target&&d.target!==n&&d.target!==this.rootTarget.parent;)d.currentTarget=d.target,this.notifyTarget(d),i&&this.notifyTarget(d,"mouseenter"),d.target=d.target.parent;this.freeEvent(d)}this.freeEvent(l)}let o=[],a=this.enableGlobalMoveEvents??!0;this.moveOnAll?o.push("pointermove"):this.dispatchEvent(r,"pointermove"),a&&o.push("globalpointermove"),r.pointerType==="touch"&&(this.moveOnAll?o.splice(1,0,"touchmove"):this.dispatchEvent(r,"touchmove"),a&&o.push("globaltouchmove")),i&&(this.moveOnAll?o.splice(1,0,"mousemove"):this.dispatchEvent(r,"mousemove"),a&&o.push("globalmousemove"),this.cursor=r.target?.cursor),o.length>0&&this.all(r,o),this._allInteractiveElements.length=0,this._hitElements.length=0,s.overTargets=r.composedPath(),this.freeEvent(r)}mapPointerOver(t){if(!(t instanceof se)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let r=this.trackingData(t.pointerId),i=this.createPointerEvent(t),s=i.pointerType==="mouse"||i.pointerType==="pen";this.dispatchEvent(i,"pointerover"),s&&this.dispatchEvent(i,"mouseover"),i.pointerType==="mouse"&&(this.cursor=i.target?.cursor);let n=this.clonePointerEvent(i,"pointerenter");for(n.eventPhase=n.AT_TARGET;n.target&&n.target!==this.rootTarget.parent;)n.currentTarget=n.target,this.notifyTarget(n),s&&this.notifyTarget(n,"mouseenter"),n.target=n.target.parent;r.overTargets=i.composedPath(),this.freeEvent(i),this.freeEvent(n)}mapPointerOut(t){if(!(t instanceof se)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let r=this.trackingData(t.pointerId);if(r.overTargets){let i=t.pointerType==="mouse"||t.pointerType==="pen",s=this.findMountedTarget(r.overTargets),n=this.createPointerEvent(t,"pointerout",s);this.dispatchEvent(n),i&&this.dispatchEvent(n,"mouseout");let o=this.createPointerEvent(t,"pointerleave",s);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),i&&this.notifyTarget(o,"mouseleave"),o.target=o.target.parent;r.overTargets=null,this.freeEvent(n),this.freeEvent(o)}this.cursor=null}mapPointerUp(t){if(!(t instanceof se)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let r=performance.now(),i=this.createPointerEvent(t);if(this.dispatchEvent(i,"pointerup"),i.pointerType==="touch")this.dispatchEvent(i,"touchend");else if(i.pointerType==="mouse"||i.pointerType==="pen"){let a=i.button===2;this.dispatchEvent(i,a?"rightup":"mouseup")}let s=this.trackingData(t.pointerId),n=this.findMountedTarget(s.pressTargetsByButton[t.button]),o=n;if(n&&!i.composedPath().includes(n)){let a=n;for(;a&&!i.composedPath().includes(a);){if(i.currentTarget=a,this.notifyTarget(i,"pointerupoutside"),i.pointerType==="touch")this.notifyTarget(i,"touchendoutside");else if(i.pointerType==="mouse"||i.pointerType==="pen"){let h=i.button===2;this.notifyTarget(i,h?"rightupoutside":"mouseupoutside")}a=a.parent}delete s.pressTargetsByButton[t.button],o=a}if(o){let a=this.clonePointerEvent(i,"click");a.target=o,a.path=null,s.clicksByButton[t.button]||(s.clicksByButton[t.button]={clickCount:0,target:a.target,timeStamp:r});let h=s.clicksByButton[t.button];if(h.target===a.target&&r-h.timeStamp<200?++h.clickCount:h.clickCount=1,h.target=a.target,h.timeStamp=r,a.detail=h.clickCount,a.pointerType==="mouse"){let l=a.button===2;this.dispatchEvent(a,l?"rightclick":"click")}else a.pointerType==="touch"&&this.dispatchEvent(a,"tap");this.dispatchEvent(a,"pointertap"),this.freeEvent(a)}this.freeEvent(i)}mapPointerUpOutside(t){if(!(t instanceof se)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let r=this.trackingData(t.pointerId),i=this.findMountedTarget(r.pressTargetsByButton[t.button]),s=this.createPointerEvent(t);if(i){let n=i;for(;n;)s.currentTarget=n,this.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch"?this.notifyTarget(s,"touchendoutside"):(s.pointerType==="mouse"||s.pointerType==="pen")&&this.notifyTarget(s,s.button===2?"rightupoutside":"mouseupoutside"),n=n.parent;delete r.pressTargetsByButton[t.button]}this.freeEvent(s)}mapWheel(t){if(!(t instanceof ze)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}let r=this.createWheelEvent(t);this.dispatchEvent(r),this.freeEvent(r)}findMountedTarget(t){if(!t)return null;let r=t[0];for(let i=1;i<t.length&&t[i].parent===r;i++)r=t[i];return r}createPointerEvent(t,r,i){let s=this.allocateEvent(se);return this.copyPointerData(t,s),this.copyMouseData(t,s),this.copyData(t,s),s.nativeEvent=t.nativeEvent,s.originalEvent=t,s.target=i??this.hitTest(s.global.x,s.global.y)??this._hitElements[0],typeof r=="string"&&(s.type=r),s}createWheelEvent(t){let r=this.allocateEvent(ze);return this.copyWheelData(t,r),this.copyMouseData(t,r),this.copyData(t,r),r.nativeEvent=t.nativeEvent,r.originalEvent=t,r.target=this.hitTest(r.global.x,r.global.y),r}clonePointerEvent(t,r){let i=this.allocateEvent(se);return i.nativeEvent=t.nativeEvent,i.originalEvent=t.originalEvent,this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.target=t.target,i.path=t.composedPath().slice(),i.type=r??i.type,i}copyWheelData(t,r){r.deltaMode=t.deltaMode,r.deltaX=t.deltaX,r.deltaY=t.deltaY,r.deltaZ=t.deltaZ}copyPointerData(t,r){t instanceof se&&r instanceof se&&(r.pointerId=t.pointerId,r.width=t.width,r.height=t.height,r.isPrimary=t.isPrimary,r.pointerType=t.pointerType,r.pressure=t.pressure,r.tangentialPressure=t.tangentialPressure,r.tiltX=t.tiltX,r.tiltY=t.tiltY,r.twist=t.twist)}copyMouseData(t,r){t instanceof er&&r instanceof er&&(r.altKey=t.altKey,r.button=t.button,r.buttons=t.buttons,r.client.copyFrom(t.client),r.ctrlKey=t.ctrlKey,r.metaKey=t.metaKey,r.movement.copyFrom(t.movement),r.screen.copyFrom(t.screen),r.shiftKey=t.shiftKey,r.global.copyFrom(t.global))}copyData(t,r){r.isTrusted=t.isTrusted,r.srcElement=t.srcElement,r.timeStamp=performance.now(),r.type=t.type,r.detail=t.detail,r.view=t.view,r.which=t.which,r.layer.copyFrom(t.layer),r.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);let r=this.eventPool.get(t).pop()||new t(this);return r.eventPhase=r.NONE,r.currentTarget=null,r.path=null,r.target=null,r}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");let r=t.constructor;this.eventPool.has(r)||this.eventPool.set(r,[]),this.eventPool.get(r).push(t)}notifyListeners(t,r){let i=t.currentTarget._events[r];if(i&&t.currentTarget.isInteractive())if("fn"in i)i.once&&t.currentTarget.removeListener(r,i.fn,void 0,!0),i.fn.call(i.context,t);else for(let s=0,n=i.length;s<n&&!t.propagationImmediatelyStopped;s++)i[s].once&&t.currentTarget.removeListener(r,i[s].fn,void 0,!0),i[s].fn.call(i[s].context,t)}};var _x=1,yx={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},rl=class{constructor(e){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=e,this.rootBoundary=new mn(null),tr.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new se(null),this.rootWheelEvent=new ze(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...rl.defaultEventFeatures},{set:(t,r,i)=>(r==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=i),t[r]=i,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(e){let{view:t,resolution:r}=this.renderer;this.setTargetElement(t),this.resolution=r,rl._defaultEventMode=e.eventMode??"auto",Object.assign(this.features,e.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(e){this.resolution=e}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(e){e=e||"default";let t=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(t=!1),this.currentCursor===e)return;this.currentCursor=e;let r=this.cursorStyles[e];if(r)switch(typeof r){case"string":t&&(this.domElement.style.cursor=r);break;case"function":r(e);break;case"object":t&&Object.assign(this.domElement.style,r);break}else t&&typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.domElement.style.cursor=e)}get pointer(){return this.rootPointerEvent}onPointerDown(e){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch"))return;let t=this.normalizeToPointerData(e);this.autoPreventDefault&&t[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(let r=0,i=t.length;r<i;r++){let s=t[r],n=this.bootstrapEvent(this.rootPointerEvent,s);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(e){if(!this.features.move||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch"))return;tr.pointerMoved();let t=this.normalizeToPointerData(e);for(let r=0,i=t.length;r<i;r++){let s=this.bootstrapEvent(this.rootPointerEvent,t[r]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(e){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch"))return;let t=e.target;e.composedPath&&e.composedPath().length>0&&(t=e.composedPath()[0]);let r=t!==this.domElement?"outside":"",i=this.normalizeToPointerData(e);for(let s=0,n=i.length;s<n;s++){let o=this.bootstrapEvent(this.rootPointerEvent,i[s]);o.type+=r,this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(e){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch"))return;let t=this.normalizeToPointerData(e);for(let r=0,i=t.length;r<i;r++){let s=this.bootstrapEvent(this.rootPointerEvent,t[r]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onWheel(e){if(!this.features.wheel)return;let t=this.normalizeWheelEvent(e);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(t)}setTargetElement(e){this.removeEvents(),this.domElement=e,tr.domElement=e,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;tr.addTickerListener();let e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0)),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;tr.removeTickerListener();let e=this.domElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(e,t,r){let i;this.domElement.parentElement?i=this.domElement.getBoundingClientRect():i={x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0};let s=1/this.resolution;e.x=(t-i.left)*(this.domElement.width/i.width)*s,e.y=(r-i.top)*(this.domElement.height/i.height)*s}normalizeToPointerData(e){let t=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(let r=0,i=e.changedTouches.length;r<i;r++){let s=e.changedTouches[r];typeof s.button>"u"&&(s.button=0),typeof s.buttons>"u"&&(s.buttons=1),typeof s.isPrimary>"u"&&(s.isPrimary=e.touches.length===1&&e.type==="touchstart"),typeof s.width>"u"&&(s.width=s.radiusX||1),typeof s.height>"u"&&(s.height=s.radiusY||1),typeof s.tiltX>"u"&&(s.tiltX=0),typeof s.tiltY>"u"&&(s.tiltY=0),typeof s.pointerType>"u"&&(s.pointerType="touch"),typeof s.pointerId>"u"&&(s.pointerId=s.identifier||0),typeof s.pressure>"u"&&(s.pressure=s.force||.5),typeof s.twist>"u"&&(s.twist=0),typeof s.tangentialPressure>"u"&&(s.tangentialPressure=0),typeof s.layerX>"u"&&(s.layerX=s.offsetX=s.clientX),typeof s.layerY>"u"&&(s.layerY=s.offsetY=s.clientY),s.isNormalized=!0,s.type=e.type,t.push(s)}else if(!globalThis.MouseEvent||e instanceof MouseEvent&&(!this.supportsPointerEvents||!(e instanceof globalThis.PointerEvent))){let r=e;typeof r.isPrimary>"u"&&(r.isPrimary=!0),typeof r.width>"u"&&(r.width=1),typeof r.height>"u"&&(r.height=1),typeof r.tiltX>"u"&&(r.tiltX=0),typeof r.tiltY>"u"&&(r.tiltY=0),typeof r.pointerType>"u"&&(r.pointerType="mouse"),typeof r.pointerId>"u"&&(r.pointerId=_x),typeof r.pressure>"u"&&(r.pressure=.5),typeof r.twist>"u"&&(r.twist=0),typeof r.tangentialPressure>"u"&&(r.tangentialPressure=0),r.isNormalized=!0,t.push(r)}else t.push(e);return t}normalizeWheelEvent(e){let t=this.rootWheelEvent;return this.transferMouseData(t,e),t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ,t.deltaMode=e.deltaMode,this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.nativeEvent=e,t.type=e.type,t}bootstrapEvent(e,t){return e.originalEvent=null,e.nativeEvent=t,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t),this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.isTrusted=t.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=yx[e.type]||e.type),e}transferMouseData(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.relatedTarget=null,e.shiftKey=t.shiftKey}},_i=rl;_i.extension={name:"events",type:[S.RendererSystem,S.CanvasRendererSystem]};_i.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};P.add(_i);function Qd(e){return e==="dynamic"||e==="static"}var tf={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??Qd(_i.defaultEventMode)},set interactive(e){O.deprecation("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=e,this.eventMode=e?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??_i.defaultEventMode},set eventMode(e){this._internalInteractive=Qd(e),this._internalEventMode=e},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(e,t,r){let i=typeof r=="boolean"&&r||typeof r=="object"&&r.capture,s=typeof t=="function"?void 0:t;e=i?`${e}capture`:e,t=typeof t=="function"?t:t.handleEvent,this.on(e,t,s)},removeEventListener(e,t,r){let i=typeof r=="boolean"&&r||typeof r=="object"&&r.capture,s=typeof t=="function"?void 0:t;e=i?`${e}capture`:e,t=typeof t=="function"?t:t.handleEvent,this.off(e,t,s)},dispatchEvent(e){if(!(e instanceof Ve))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return e.defaultPrevented=!1,e.path=null,e.target=this,e.manager.dispatchEvent(e),!e.defaultPrevented}};ct.mixin(tf);var il={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};ct.mixin(il);var vx=9,Zo=100,bx=0,Tx=0,ef=2,rf=1,wx=-1e3,Ex=-1e3,Sx=2,gn=class{constructor(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(O.isMobile.tablet||O.isMobile.phone)&&this.createTouchHook();let r=document.createElement("div");r.style.width=`${Zo}px`,r.style.height=`${Zo}px`,r.style.position="absolute",r.style.top=`${bx}px`,r.style.left=`${Tx}px`,r.style.zIndex=ef.toString(),this.div=r,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){let t=document.createElement("button");t.style.width=`${rf}px`,t.style.height=`${rf}px`,t.style.position="absolute",t.style.top=`${wx}px`,t.style.left=`${Ex}px`,t.style.zIndex=Sx.toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode?.appendChild(this.div))}deactivate(){!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode?.removeChild(this.div))}updateAccessibleObjects(t){if(!t.visible||!t.accessibleChildren)return;t.accessible&&t.isInteractive()&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);let r=t.children;if(r)for(let i=0;i<r.length;i++)this.updateAccessibleObjects(r[i])}update(){let t=performance.now();if(O.isMobile.android.device&&t<this.androidUpdateCount||(this.androidUpdateCount=t+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);let{x:r,y:i,width:s,height:n}=this.renderer.view.getBoundingClientRect(),{width:o,height:a,resolution:h}=this.renderer,l=s/o*h,c=n/a*h,u=this.div;u.style.left=`${r}px`,u.style.top=`${i}px`,u.style.width=`${o}px`,u.style.height=`${a}px`;for(let d=0;d<this.children.length;d++){let f=this.children[d];if(f.renderId!==this.renderId)f._accessibleActive=!1,O.removeItems(this.children,d,1),this.div.removeChild(f._accessibleDiv),this.pool.push(f._accessibleDiv),f._accessibleDiv=null,d--;else{u=f._accessibleDiv;let p=f.hitArea,g=f.worldTransform;f.hitArea?(u.style.left=`${(g.tx+p.x*g.a)*l}px`,u.style.top=`${(g.ty+p.y*g.d)*c}px`,u.style.width=`${p.width*g.a*l}px`,u.style.height=`${p.height*g.d*c}px`):(p=f.getBounds(),this.capHitArea(p),u.style.left=`${p.x*l}px`,u.style.top=`${p.y*c}px`,u.style.width=`${p.width*l}px`,u.style.height=`${p.height*c}px`,u.title!==f.accessibleTitle&&f.accessibleTitle!==null&&(u.title=f.accessibleTitle),u.getAttribute("aria-label")!==f.accessibleHint&&f.accessibleHint!==null&&u.setAttribute("aria-label",f.accessibleHint)),(f.accessibleTitle!==u.title||f.tabIndex!==u.tabIndex)&&(u.title=f.accessibleTitle,u.tabIndex=f.tabIndex,this.debug&&this.updateDebugHTML(u))}}this.renderId++}updateDebugHTML(t){t.innerHTML=`type: ${t.type}</br> title : ${t.title}</br> tabIndex: ${t.tabIndex}`}capHitArea(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);let{width:r,height:i}=this.renderer;t.x+t.width>r&&(t.width=r-t.x),t.y+t.height>i&&(t.height=i-t.y)}addChild(t){let r=this.pool.pop();r||(r=document.createElement("button"),r.style.width=`${Zo}px`,r.style.height=`${Zo}px`,r.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",r.style.position="absolute",r.style.zIndex=ef.toString(),r.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?r.setAttribute("aria-live","off"):r.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?r.setAttribute("aria-relevant","additions"):r.setAttribute("aria-relevant","text"),r.addEventListener("click",this._onClick.bind(this)),r.addEventListener("focus",this._onFocus.bind(this)),r.addEventListener("focusout",this._onFocusOut.bind(this))),r.style.pointerEvents=t.accessiblePointerEvents,r.type=t.accessibleType,t.accessibleTitle&&t.accessibleTitle!==null?r.title=t.accessibleTitle:(!t.accessibleHint||t.accessibleHint===null)&&(r.title=`displayObject ${t.tabIndex}`),t.accessibleHint&&t.accessibleHint!==null&&r.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(r),t._accessibleActive=!0,t._accessibleDiv=r,r.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex}_dispatchEvent(t,r){let{displayObject:i}=t.target,s=this.renderer.events.rootBoundary,n=Object.assign(new Ve(s),{target:i});s.rootTarget=this.renderer.lastObjectRendered,r.forEach(o=>s.dispatchEvent(n,o))}_onClick(t){this._dispatchEvent(t,["click","pointertap","tap"])}_onFocus(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive"),this._dispatchEvent(t,["mouseover"])}_onFocusOut(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite"),this._dispatchEvent(t,["mouseout"])}_onKeyDown(t){t.keyCode===vx&&this.activate()}_onMouseMove(t){t.movementX===0&&t.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}};gn.extension={name:"accessibility",type:[S.RendererPlugin,S.CanvasRendererPlugin]};P.add(gn);var sl=class{constructor(e){this.stage=new St,e=Object.assign({forceCanvas:!1},e),this.renderer=jh(e),sl._plugins.forEach(t=>{t.init.call(this,e)})}render(){this.renderer.render(this.stage)}get view(){return this.renderer.view}get screen(){return this.renderer.screen}destroy(e,t){let r=sl._plugins.slice(0);r.reverse(),r.forEach(i=>{i.destroy.call(this)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(e),this.renderer=null}},xn=sl;xn._plugins=[];P.handleByList(S.Application,xn._plugins);var _n=class{static init(t){Object.defineProperty(this,"resizeTo",{set(r){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=r,r&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let r,i;if(this._resizeTo===globalThis.window)r=globalThis.innerWidth,i=globalThis.innerHeight;else{let{clientWidth:s,clientHeight:n}=this._resizeTo;r=s,i=n}this.renderer.resize(r,i),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}};_n.extension=S.Application;P.add(_n);var sf={loader:S.LoadParser,resolver:S.ResolveParser,cache:S.CacheParser,detection:S.DetectionParser};P.handle(S.Asset,e=>{let t=e.ref;Object.entries(sf).filter(([r])=>!!t[r]).forEach(([r,i])=>P.add(Object.assign(t[r],{extension:t[r].extension??i})))},e=>{let t=e.ref;Object.keys(sf).filter(r=>!!t[r]).forEach(r=>P.remove(t[r]))});var Jo=class{constructor(t,r=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=r}add(t){t.forEach(r=>{this._assetList.push(r)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;let t=[],r=Math.min(this._assetList.length,this._maxConcurrent);for(let i=0;i<r;i++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}};function Fe(e,t){if(Array.isArray(t)){for(let r of t)if(e.startsWith(`data:${r}`))return!0;return!1}return e.startsWith(`data:${t}`)}function ne(e,t){let r=e.split("?")[0],i=O.path.extname(r).toLowerCase();return Array.isArray(t)?t.includes(i):i===t}var le=(e,t)=>(Array.isArray(e)||(e=[e]),t?e.map(r=>typeof r=="string"?t(r):r):e);var yi=(e,t)=>{let r=t.split("?")[1];return r&&(e+=`?${r}`),e};function nf(e,t,r,i,s){let n=t[r];for(let o=0;o<n.length;o++){let a=n[o];r<t.length-1?nf(e.replace(i[r],a),t,r+1,i,s):s.push(e.replace(i[r],a))}}function Qo(e){let t=/\{(.*?)\}/g,r=e.match(t),i=[];if(r){let s=[];r.forEach(n=>{let o=n.substring(1,n.length-1).split(",");s.push(o)}),nf(e,s,0,r,i)}else i.push(e);return i}var gr=e=>!Array.isArray(e);var nl=class{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){let r=this._cache.get(t);return r||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),r}set(t,r){let i=le(t),s;for(let a=0;a<this.parsers.length;a++){let h=this.parsers[a];if(h.test(r)){s=h.getCacheableAssets(i,r);break}}s||(s={},i.forEach(a=>{s[a]=r}));let n=Object.keys(s),o={cacheKeys:n,keys:i};if(i.forEach(a=>{this._cacheMap.set(a,o)}),n.forEach(a=>{this._cache.has(a)&&this._cache.get(a)!==r&&console.warn("[Cache] already has key:",a),this._cache.set(a,s[a])}),r instanceof H){let a=r;i.forEach(h=>{a.baseTexture!==H.EMPTY.baseTexture&&W.addToCache(a.baseTexture,h),H.addToCache(a,h)})}}remove(t){if(this._cacheMap.get(t),!this._cacheMap.has(t)){console.warn(`[Assets] Asset id ${t} was not found in the Cache`);return}let r=this._cacheMap.get(t);r.cacheKeys.forEach(s=>{this._cache.delete(s)}),r.keys.forEach(s=>{this._cacheMap.delete(s)})}get parsers(){return this._parsers}},Gr=new nl;var ta=class{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,r,i)=>(this._parsersValidated=!1,t[r]=i,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,r){let i={promise:null,parser:null};return i.promise=(async()=>{let s=null,n=null;if(r.loadParser&&(n=this._parserHash[r.loadParser],n||console.warn(`[Assets] specified load parser "${r.loadParser}" not found while loading ${t}`)),!n){for(let o=0;o<this.parsers.length;o++){let a=this.parsers[o];if(a.load&&a.test?.(t,r,this)){n=a;break}}if(!n)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}s=await n.load(t,r,this),i.parser=n;for(let o=0;o<this.parsers.length;o++){let a=this.parsers[o];a.parse&&a.parse&&await a.testParse?.(s,r,this)&&(s=await a.parse(s,r,this)||s,i.parser=a)}return s})(),i}async load(t,r){this._parsersValidated||this._validateParsers();let i=0,s={},n=gr(t),o=le(t,l=>({src:l})),a=o.length,h=o.map(async l=>{let c=O.path.toAbsolute(l.src);if(!s[l.src])try{this.promiseCache[c]||(this.promiseCache[c]=this._getLoadPromiseAndParser(c,l)),s[l.src]=await this.promiseCache[c].promise,r&&r(++i/a)}catch(u){throw delete this.promiseCache[c],delete s[l.src],new Error(`[Loader.load] Failed to load ${c}.
${u}`)}});return await Promise.all(h),n?s[o[0].src]:s}async unload(t){let i=le(t,s=>({src:s})).map(async s=>{let n=O.path.toAbsolute(s.src),o=this.promiseCache[n];if(o){let a=await o.promise;o.parser?.unload?.(a,s,this),delete this.promiseCache[n]}});await Promise.all(i)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name).reduce((t,r)=>(t[r.name]&&console.warn(`[Assets] loadParser name conflict "${r.name}"`),{...t,[r.name]:r}),{})}};var Rt=(e=>(e[e.Low=0]="Low",e[e.Normal=1]="Normal",e[e.High=2]="High",e))(Rt||{});var Ax=".json",Px="application/json",ol={extension:{type:S.LoadParser,priority:Rt.Low},name:"loadJson",test(e){return Fe(e,Px)||ne(e,Ax)},async load(e){return await(await w.ADAPTER.fetch(e)).json()}};P.add(ol);var Ix=".txt",Rx="text/plain",al={name:"loadTxt",extension:{type:S.LoadParser,priority:Rt.Low},test(e){return Fe(e,Rx)||ne(e,Ix)},async load(e){return await(await w.ADAPTER.fetch(e)).text()}};P.add(al);var Cx=["normal","bold","100","200","300","400","500","600","700","800","900"],Mx=[".ttf",".otf",".woff",".woff2"],Bx=["font/ttf","font/otf","font/woff","font/woff2"],Dx=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function hl(e){let t=O.path.extname(e),s=O.path.basename(e,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1)),n=s.length>0;for(let a of s)if(!a.match(Dx)){n=!1;break}let o=s.join(" ");return n||(o=`"${o.replace(/[\\"]/g,"\\$&")}"`),o}var ll={extension:{type:S.LoadParser,priority:Rt.Low},name:"loadWebFont",test(e){return Fe(e,Bx)||ne(e,Mx)},async load(e,t){let r=w.ADAPTER.getFontFaceSet();if(r){let i=[],s=t.data?.family??hl(e),n=t.data?.weights?.filter(a=>Cx.includes(a))??["normal"],o=t.data??{};for(let a=0;a<n.length;a++){let h=n[a],l=new FontFace(s,`url(${encodeURI(e)})`,{...o,weight:h});await l.load(),r.add(l),i.push(l)}return i.length===1?i[0]:i}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(e){(Array.isArray(e)?e:[e]).forEach(t=>w.ADAPTER.getFontFaceSet().delete(t))}};P.add(ll);var of=0,cl,Ox="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",Fx={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${Ox}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},Lx={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`},ul,dl=class{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{let r=URL.createObjectURL(new Blob([Fx.code],{type:"application/javascript"})),i=new Worker(r);i.addEventListener("message",s=>{i.terminate(),URL.revokeObjectURL(r),t(s.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){cl===void 0&&(cl=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<cl&&(ul||(ul=URL.createObjectURL(new Blob([Lx.code],{type:"application/javascript"}))),this._createdWorkers++,t=new Worker(ul),t.addEventListener("message",r=>{this.complete(r.data),this.returnWorker(r.target),this.next()})),t}returnWorker(t){this.workerPool.push(t)}complete(t){t.error!==void 0?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,r){await this._initWorkers();let i=new Promise((s,n)=>{this.queue.push({id:t,arguments:r,resolve:s,reject:n})});return this.next(),i}next(){if(!this.queue.length)return;let t=this.getWorker();if(!t)return;let r=this.queue.pop(),i=r.id;this.resolveHash[of]={resolve:r.resolve,reject:r.reject},t.postMessage({data:r.arguments,uuid:of++,id:i})}},fl=new dl;function rr(e,t,r){let i=new H(e);return i.baseTexture.on("dispose",()=>{delete t.promiseCache[r]}),i}var Nx=[".jpeg",".jpg",".png",".webp",".avif"],Ux=["image/jpeg","image/png","image/webp","image/avif"];async function pl(e){let t=await w.ADAPTER.fetch(e);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${e}: ${t.status} ${t.statusText}`);let r=await t.blob();return await createImageBitmap(r)}var xr={name:"loadTextures",extension:{type:S.LoadParser,priority:Rt.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(e){return Fe(e,Ux)||ne(e,Nx)},async load(e,t,r){let i=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await fl.isImageBitmapSupported()?i=await fl.loadImageBitmap(e):i=await pl(e):i=await new Promise(n=>{i=new Image,i.crossOrigin=this.config.crossOrigin,i.src=e,i.complete?n(i):i.onload=()=>{n(i)}});let s=new W(i,{resolution:O.getResolutionOfUrl(e),...t.data});return s.resource.src=e,rr(s,r,e)},unload(e){e.destroy(!0)}};P.add(xr);var Gx=".svg",kx="image/svg+xml",ml={extension:{type:S.LoadParser,priority:Rt.High},name:"loadSVG",test(e){return Fe(e,kx)||ne(e,Gx)},async testParse(e){return mr.test(e)},async parse(e,t,r){let i=new mr(e,t?.data?.resourceOptions);await i.load();let s=new W(i,{resolution:O.getResolutionOfUrl(e),...t?.data});return s.resource.src=e,rr(s,r,e)},async load(e,t){return(await w.ADAPTER.fetch(e)).text()},unload:xr.unload};P.add(ml);var ea=class{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,r)=>`${t}${this._bundleIdConnector}${r}`,extractAssetIdFromBundle:(t,r)=>r.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(r=>{this._preferredOrder.push(r),r.priority||(r.priority=Object.keys(r.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{let r=t;this._defaultSearchParams=Object.keys(r).map(i=>`${encodeURIComponent(i)}=${encodeURIComponent(r[i])}`).join("&")}}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(r=>{this.addBundle(r.name,r.assets)})}addBundle(t,r){let i=[];Array.isArray(r)?r.forEach(s=>{if(typeof s.name=="string"){let n=this._createBundleAssetId(t,s.name);i.push(n),this.add([s.name,n],s.srcs,s.data)}else{let n=s.name.map(o=>this._createBundleAssetId(t,o));n.forEach(o=>{i.push(o)}),this.add([...s.name,...n],s.srcs)}}):Object.keys(r).forEach(s=>{i.push(this._createBundleAssetId(t,s)),this.add([s,this._createBundleAssetId(t,s)],r[s])}),this._bundles[t]=i}add(t,r,i){let s=le(t);s.forEach(o=>{this.hasKey(o)&&console.warn(`[Resolver] already has key: ${o} overwriting`)}),Array.isArray(r)||(typeof r=="string"?r=Qo(r):r=[r]);let n=r.map(o=>{let a=o;if(typeof o=="string"){let h=!1;for(let l=0;l<this._parsers.length;l++){let c=this._parsers[l];if(c.test(o)){a=c.parse(o),h=!0;break}}h||(a={src:o})}return a.format||(a.format=a.src.split(".").pop()),a.alias||(a.alias=s),(this._basePath||this._rootPath)&&(a.src=O.path.toAbsolute(a.src,this._basePath,this._rootPath)),a.src=this._appendDefaultSearchParams(a.src),a.data=a.data??i,a});s.forEach(o=>{this._assetMap[o]=n})}resolveBundle(t){let r=gr(t);t=le(t);let i={};return t.forEach(s=>{let n=this._bundles[s];if(n){let o=this.resolve(n),a={};for(let h in o){let l=o[h];a[this._extractAssetIdFromBundle(s,h)]=l}i[s]=a}}),r?i[t[0]]:i}resolveUrl(t){let r=this.resolve(t);if(typeof t!="string"){let i={};for(let s in r)i[s]=r[s].src;return i}return r.src}resolve(t){let r=gr(t);t=le(t);let i={};return t.forEach(s=>{if(!this._resolverHash[s])if(this._assetMap[s]){let n=this._assetMap[s],o=this._getPreferredOrder(n),a=n[0];o?.priority.forEach(h=>{o.params[h].forEach(l=>{let c=n.filter(u=>u[h]?u[h]===l:!1);c.length&&(n=c)})}),this._resolverHash[s]=n[0]??a}else{let n=s;(this._basePath||this._rootPath)&&(n=O.path.toAbsolute(n,this._basePath,this._rootPath)),n=this._appendDefaultSearchParams(n),this._resolverHash[s]={src:n}}i[s]=this._resolverHash[s]}),r?i[t[0]]:i}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let r=0;r<t.length;r++){let i=t[0],s=this._preferredOrder.find(n=>n.params.format.includes(i.format));if(s)return s}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;let r=/\?/.test(t)?"&":"?";return`${t}${r}${this._defaultSearchParams}`}};var ra=class{constructor(){this._detections=[],this._initialized=!1,this.resolver=new ea,this.loader=new ta,this.cache=Gr,this._backgroundLoader=new Jo(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let n=t.manifest;typeof n=="string"&&(n=await this.load(n)),this.resolver.addManifest(n)}let r=t.texturePreference?.resolution??1,i=typeof r=="number"?[r]:r,s=[];if(t.texturePreference?.format){let n=t.texturePreference?.format;s=typeof n=="string"?[n]:n;for(let o of this._detections)await o.test()||(s=await o.remove(s))}else for(let n of this._detections)await n.test()&&(s=await n.add(s));this.resolver.prefer({params:{format:s,resolution:i}}),t.preferences&&this.setPreferences(t.preferences)}add(t,r,i){this.resolver.add(t,r,i)}async load(t,r){this._initialized||await this.init();let i=gr(t),s=le(t).map(a=>typeof a!="string"?(this.resolver.add(a.src,a),a.src):(this.resolver.hasKey(a)||this.resolver.add(a,a),a)),n=this.resolver.resolve(s),o=await this._mapLoadToResolve(n,r);return i?o[s[0]]:o}addBundle(t,r){this.resolver.addBundle(t,r)}async loadBundle(t,r){this._initialized||await this.init();let i=!1;typeof t=="string"&&(i=!0,t=[t]);let s=this.resolver.resolveBundle(t),n={},o=Object.keys(s),a=0,h=0,l=()=>{r?.(++a/h)},c=o.map(u=>{let d=s[u];return h+=Object.keys(d).length,this._mapLoadToResolve(d,l).then(f=>{n[u]=f})});return await Promise.all(c),i?n[t[0]]:n}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);let r=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(r))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);let r=this.resolver.resolveBundle(t);Object.values(r).forEach(i=>{this._backgroundLoader.add(Object.values(i))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return Gr.get(t);let r={};for(let i=0;i<t.length;i++)r[i]=Gr.get(t[i]);return r}async _mapLoadToResolve(t,r){let i=Object.values(t),s=Object.keys(t);this._backgroundLoader.active=!1;let n=await this.loader.load(i,r);this._backgroundLoader.active=!0;let o={};return i.forEach((a,h)=>{let l=n[a.src],c=[a.src];a.alias&&c.push(...a.alias),o[s[h]]=l,Gr.set(c,l)}),o}async unload(t){this._initialized||await this.init();let r=le(t).map(s=>typeof s!="string"?s.src:s),i=this.resolver.resolve(r);await this._unloadFromResolved(i)}async unloadBundle(t){this._initialized||await this.init(),t=le(t);let r=this.resolver.resolveBundle(t),i=Object.keys(r).map(s=>this._unloadFromResolved(r[s]));await Promise.all(i)}async _unloadFromResolved(t){let r=Object.values(t);r.forEach(i=>{Gr.remove(i.src)}),await this.loader.unload(r)}get detections(){return this._detections}get preferWorkers(){return xr.config.preferWorkers}set preferWorkers(t){O.deprecation("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:t})}setPreferences(t){this.loader.parsers.forEach(r=>{r.config&&Object.keys(r.config).filter(i=>i in t).forEach(i=>{r.config[i]=t[i]})})}},yn=new ra;P.handleByList(S.LoadParser,yn.loader.parsers).handleByList(S.ResolveParser,yn.resolver.parsers).handleByList(S.CacheParser,yn.cache.parsers).handleByList(S.DetectionParser,yn.detections);var gl={extension:S.CacheParser,test:e=>Array.isArray(e)&&e.every(t=>t instanceof H),getCacheableAssets:(e,t)=>{let r={};return e.forEach(i=>{t.forEach((s,n)=>{r[i+(n===0?"":n+1)]=s})}),r}};P.add(gl);var xl={extension:{type:S.DetectionParser,priority:1},test:async()=>{if(!globalThis.createImageBitmap)return!1;let e="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=",t=await w.ADAPTER.fetch(e).then(r=>r.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async e=>[...e,"avif"],remove:async e=>e.filter(t=>t!=="avif")};P.add(xl);var _l={extension:{type:S.DetectionParser,priority:0},test:async()=>{if(!globalThis.createImageBitmap)return!1;let e="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=",t=await w.ADAPTER.fetch(e).then(r=>r.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async e=>[...e,"webp"],remove:async e=>e.filter(t=>t!=="webp")};P.add(_l);var af=["png","jpg","jpeg"],yl={extension:{type:S.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async e=>[...e,...af],remove:async e=>e.filter(t=>!af.includes(t))};P.add(yl);var vl={extension:S.ResolveParser,test:xr.test,parse:e=>({resolution:parseFloat(w.RETINA_PREFIX.exec(e)?.[1]??"1"),format:e.split(".").pop(),src:e})};P.add(vl);var ce=(e=>(e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",e[e.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",e[e.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",e))(ce||{}),kr={[33776]:.5,[33777]:.5,[33778]:1,[33779]:1,[35916]:.5,[35917]:.5,[35918]:1,[35919]:1,[37488]:.5,[37489]:.5,[37490]:1,[37491]:1,[37492]:.5,[37496]:1,[37493]:.5,[37497]:1,[37494]:.5,[37495]:.5,[35840]:.5,[35842]:.5,[35841]:.25,[35843]:.25,[36196]:.5,[35986]:.5,[35986]:1,[34798]:1,[37808]:1};var _r,ms;function hf(){ms={s3tc:_r.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:_r.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:_r.getExtension("WEBGL_compressed_texture_etc"),etc1:_r.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:_r.getExtension("WEBGL_compressed_texture_pvrtc")||_r.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:_r.getExtension("WEBGL_compressed_texture_atc"),astc:_r.getExtension("WEBGL_compressed_texture_astc")}}var bl={extension:{type:S.DetectionParser,priority:2},test:async()=>{let t=w.ADAPTER.createCanvas().getContext("webgl");return t?(_r=t,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async e=>{ms||hf();let t=[];for(let r in ms)ms[r]&&t.push(r);return[...t,...e]},remove:async e=>(ms||hf(),e.filter(t=>!(t in ms)))};P.add(bl);var gs=class extends xe{constructor(t,r={width:1,height:1,autoLoad:!0}){let i,s;typeof t=="string"?(i=t,s=new Uint8Array):(i=null,s=t),super(s,r),this.origin=i,this.buffer=s?new Rr(s):null,this._load=null,this.loaded=!1,this.origin!==null&&r.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(t){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(t=>t.blob()).then(t=>t.arrayBuffer()).then(t=>(this.data=new Uint32Array(t),this.buffer=new Rr(t),this.loaded=!0,this.onBlobLoaded(t),this.update(),this)),this._load)}};var Ce=class extends gs{constructor(t,r){super(t,r),this.format=r.format,this.levels=r.levels||1,this._width=r.width,this._height=r.height,this._extension=Ce._formatToExtension(this.format),(r.levelBuffers||this.buffer)&&(this._levelBuffers=r.levelBuffers||Ce._createLevelBuffers(t instanceof Uint8Array?t:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(t,r,i){let s=t.gl;if(!t.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;for(let o=0,a=this.levels;o<a;o++){let{levelID:h,levelWidth:l,levelHeight:c,levelBuffer:u}=this._levelBuffers[o];s.compressedTexImage2D(s.TEXTURE_2D,h,this.format,l,c,0,u)}return!0}onBlobLoaded(){this._levelBuffers=Ce._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(t,r,i,s,n,o,a){let h=new Array(i),l=t.byteOffset,c=o,u=a,d=c+s-1&~(s-1),f=u+n-1&~(n-1),p=d*f*kr[r];for(let g=0;g<i;g++)h[g]={levelID:g,levelWidth:i>1?c:d,levelHeight:i>1?u:f,levelBuffer:new Uint8Array(t.buffer,l,p)},l+=p,c=c>>1||1,u=u>>1||1,d=c+s-1&~(s-1),f=u+n-1&~(n-1),p=d*f*kr[r];return h}};var Tl=4,ia=124,Hx=32,lf=20,Xx=542327876,sa={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},Vx={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},na={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4};var zx=1,Wx=2,$x=4,jx=64,Yx=512,qx=131072,Kx=827611204,Zx=861165636,Jx=894720068,Qx=808540228,t_=4,e_={[Kx]:ce.COMPRESSED_RGBA_S3TC_DXT1_EXT,[Zx]:ce.COMPRESSED_RGBA_S3TC_DXT3_EXT,[Jx]:ce.COMPRESSED_RGBA_S3TC_DXT5_EXT},r_={[70]:ce.COMPRESSED_RGBA_S3TC_DXT1_EXT,[71]:ce.COMPRESSED_RGBA_S3TC_DXT1_EXT,[73]:ce.COMPRESSED_RGBA_S3TC_DXT3_EXT,[74]:ce.COMPRESSED_RGBA_S3TC_DXT3_EXT,[76]:ce.COMPRESSED_RGBA_S3TC_DXT5_EXT,[77]:ce.COMPRESSED_RGBA_S3TC_DXT5_EXT,[72]:ce.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,[75]:ce.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,[78]:ce.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT};function oa(e){let t=new Uint32Array(e);if(t[0]!==Xx)throw new Error("Invalid DDS file magic word");let i=new Uint32Array(e,0,ia/Uint32Array.BYTES_PER_ELEMENT),s=i[sa.HEIGHT],n=i[sa.WIDTH],o=i[sa.MIPMAP_COUNT],a=new Uint32Array(e,sa.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,Hx/Uint32Array.BYTES_PER_ELEMENT),h=a[zx];if(h&$x){let l=a[Vx.FOURCC];if(l!==Qx){let x=e_[l],v=Tl+ia,N=new Uint8Array(e,v);return[new Ce(N,{format:x,width:n,height:s,levels:o})]}let c=Tl+ia,u=new Uint32Array(t.buffer,c,lf/Uint32Array.BYTES_PER_ELEMENT),d=u[na.DXGI_FORMAT],f=u[na.RESOURCE_DIMENSION],p=u[na.MISC_FLAG],g=u[na.ARRAY_SIZE],_=r_[d];if(_===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${d}`);if(p===t_)throw new Error("DDSParser does not support cubemap textures");if(f===6)throw new Error("DDSParser does not supported 3D texture data");let y=new Array,T=Tl+ia+lf;if(g===1)y.push(new Uint8Array(e,T));else{let x=kr[_],v=0,N=n,k=s;for(let R=0;R<o;R++){let U=Math.max(1,N+3&-4),C=Math.max(1,k+3&-4),F=U*C*x;v+=F,N=N>>>1,k=k>>>1}let B=T;for(let R=0;R<g;R++)y.push(new Uint8Array(e,B,v)),B+=v}return y.map(x=>new Ce(x,{format:_,width:n,height:s,levels:o}))}throw h&jx?new Error("DDSParser does not support uncompressed texture data."):h&Yx?new Error("DDSParser does not supported YUV uncompressed texture data."):h&qx?new Error("DDSParser does not support single-channel (lumninance) texture data!"):h&Wx?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}var cf=[171,75,84,88,32,49,49,187,13,10,26,10],i_=67305985,We={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},wl=64,aa={[z.UNSIGNED_BYTE]:1,[z.UNSIGNED_SHORT]:2,[z.INT]:4,[z.UNSIGNED_INT]:4,[z.FLOAT]:4,[z.HALF_FLOAT]:8},El={[L.RGBA]:4,[L.RGB]:3,[L.RG]:2,[L.RED]:1,[L.LUMINANCE]:1,[L.LUMINANCE_ALPHA]:2,[L.ALPHA]:1},Sl={[z.UNSIGNED_SHORT_4_4_4_4]:2,[z.UNSIGNED_SHORT_5_5_5_1]:2,[z.UNSIGNED_SHORT_5_6_5]:2};function ha(e,t,r=!1){let i=new DataView(t);if(!s_(e,i))return null;let s=i.getUint32(We.ENDIANNESS,!0)===i_,n=i.getUint32(We.GL_TYPE,s),o=i.getUint32(We.GL_FORMAT,s),a=i.getUint32(We.GL_INTERNAL_FORMAT,s),h=i.getUint32(We.PIXEL_WIDTH,s),l=i.getUint32(We.PIXEL_HEIGHT,s)||1,c=i.getUint32(We.PIXEL_DEPTH,s)||1,u=i.getUint32(We.NUMBER_OF_ARRAY_ELEMENTS,s)||1,d=i.getUint32(We.NUMBER_OF_FACES,s),f=i.getUint32(We.NUMBER_OF_MIPMAP_LEVELS,s),p=i.getUint32(We.BYTES_OF_KEY_VALUE_DATA,s);if(l===0||c!==1)throw new Error("Only 2D textures are supported");if(d!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(u!==1)throw new Error("WebGL does not support array textures");let g=4,_=4,y=h+3&-4,T=l+3&-4,x=new Array(u),v=h*l;n===0&&(v=y*T);let N;if(n!==0?aa[n]?N=aa[n]*El[o]:N=Sl[n]:N=kr[a],N===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");let k=r?o_(i,p,s):null,R=v*N,U=h,C=l,F=y,K=T,A=wl+p;for(let I=0;I<f;I++){let it=i.getUint32(A,s),Y=A+4;for(let et=0;et<u;et++){let G=x[et];G||(G=x[et]=new Array(f)),G[I]={levelID:I,levelWidth:f>1||n!==0?U:F,levelHeight:f>1||n!==0?C:K,levelBuffer:new Uint8Array(t,Y,R)},Y+=R}A+=it+4,A=A%4!==0?A+4-A%4:A,U=U>>1||1,C=C>>1||1,F=U+g-1&~(g-1),K=C+_-1&~(_-1),R=F*K*N}return n!==0?{uncompressed:x.map(I=>{let it=I[0].levelBuffer,Y=!1;return n===z.FLOAT?it=new Float32Array(I[0].levelBuffer.buffer,I[0].levelBuffer.byteOffset,I[0].levelBuffer.byteLength/4):n===z.UNSIGNED_INT?(Y=!0,it=new Uint32Array(I[0].levelBuffer.buffer,I[0].levelBuffer.byteOffset,I[0].levelBuffer.byteLength/4)):n===z.INT&&(Y=!0,it=new Int32Array(I[0].levelBuffer.buffer,I[0].levelBuffer.byteOffset,I[0].levelBuffer.byteLength/4)),{resource:new xe(it,{width:I[0].levelWidth,height:I[0].levelHeight}),type:n,format:Y?n_(o):o}}),kvData:k}:{compressed:x.map(I=>new Ce(null,{format:a,width:h,height:l,levels:f,levelBuffers:I})),kvData:k}}function s_(e,t){for(let r=0;r<cf.length;r++)if(t.getUint8(r)!==cf[r])return console.error(`${e} is not a valid *.ktx file!`),!1;return!0}function n_(e){switch(e){case L.RGBA:return L.RGBA_INTEGER;case L.RGB:return L.RGB_INTEGER;case L.RG:return L.RG_INTEGER;case L.RED:return L.RED_INTEGER;default:return e}}function o_(e,t,r){let i=new Map,s=0;for(;s<t;){let n=e.getUint32(wl+s,r),o=wl+s+4,a=3-(n+3)%4;if(n===0||n>t-s){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let h=0;for(;h<n&&e.getUint8(o+h)!==0;h++);if(h===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}let l=new TextDecoder().decode(new Uint8Array(e.buffer,o,h)),c=new DataView(e.buffer,o+h+1,n-h-1);i.set(l,c),s+=4+n+a}return i}var Al={extension:{type:S.LoadParser,priority:Rt.High},name:"loadDDS",test(e){return ne(e,".dds")},async load(e,t,r){let s=await(await w.ADAPTER.fetch(e)).arrayBuffer(),o=oa(s).map(a=>{let h=new W(a,{mipmap:Kt.OFF,alphaMode:Bt.NO_PREMULTIPLIED_ALPHA,resolution:O.getResolutionOfUrl(e),...t.data});return rr(h,r,e)});return o.length===1?o[0]:o},unload(e){Array.isArray(e)?e.forEach(t=>t.destroy(!0)):e.destroy(!0)}};P.add(Al);var Pl={extension:{type:S.LoadParser,priority:Rt.High},name:"loadKTX",test(e){return ne(e,".ktx")},async load(e,t,r){let s=await(await w.ADAPTER.fetch(e)).arrayBuffer(),{compressed:n,uncompressed:o,kvData:a}=ha(e,s),h=n??o,l={mipmap:Kt.OFF,alphaMode:Bt.NO_PREMULTIPLIED_ALPHA,resolution:O.getResolutionOfUrl(e),...t.data},c=h.map(u=>{h===o&&Object.assign(l,{type:u.type,format:u.format});let d=new W(u,l);return d.ktxKeyValueData=a,rr(d,r,e)});return c.length===1?c[0]:c},unload(e){Array.isArray(e)?e.forEach(t=>t.destroy(!0)):e.destroy(!0)}};P.add(Pl);var Il={extension:S.ResolveParser,test:e=>{let r=e.split("?")[0].split(".").pop();return["basis","ktx","dds"].includes(r)},parse:e=>{if(e.split("?")[0].split(".").pop()==="ktx"){let i=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(i.some(s=>e.endsWith(s)))return{resolution:parseFloat(w.RETINA_PREFIX.exec(e)?.[1]??"1"),format:i.find(s=>e.endsWith(s)),src:e}}return{resolution:parseFloat(w.RETINA_PREFIX.exec(e)?.[1]??"1"),format:e.split(".").pop(),src:e}}};P.add(Il);var a_=new $,h_=4,vn=class{constructor(e){this.renderer=e}async image(e,t,r){let i=new Image;return i.src=await this.base64(e,t,r),i}async base64(e,t,r){let i=this.canvas(e);if(i.toBlob!==void 0)return new Promise((s,n)=>{i.toBlob(o=>{if(!o){n(new Error("ICanvas.toBlob failed!"));return}let a=new FileReader;a.onload=()=>s(a.result),a.onerror=n,a.readAsDataURL(o)},t,r)});if(i.toDataURL!==void 0)return i.toDataURL(t,r);if(i.convertToBlob!==void 0){let s=await i.convertToBlob({type:t,quality:r});return new Promise((n,o)=>{let a=new FileReader;a.onload=()=>n(a.result),a.onerror=o,a.readAsDataURL(s)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(e,t){let{pixels:r,width:i,height:s,flipY:n}=this._rawPixels(e,t);n&&vn._flipY(r,i,s),vn._unpremultiplyAlpha(r);let o=new O.CanvasRenderTarget(i,s,1),a=new ImageData(new Uint8ClampedArray(r.buffer),i,s);return o.context.putImageData(a,0,0),o.canvas}pixels(e,t){let{pixels:r,width:i,height:s,flipY:n}=this._rawPixels(e,t);return n&&vn._flipY(r,i,s),vn._unpremultiplyAlpha(r),r}_rawPixels(e,t){let r=this.renderer;if(!r)throw new Error("The Extract has already been destroyed");let i,s=!1,n,o=!1;if(e&&(e instanceof ye?n=e:(n=r.generateTexture(e,{resolution:r.resolution,multisample:r.multisample}),o=!0)),n){if(i=n.baseTexture.resolution,t=t??n.frame,s=!1,!o){r.renderTexture.bind(n);let u=n.framebuffer.glFramebuffers[r.CONTEXT_UID];u.blitFramebuffer&&r.framebuffer.bind(u.blitFramebuffer)}}else i=r.resolution,t||(t=a_,t.width=r.width/i,t.height=r.height/i),s=!0,r.renderTexture.bind();let a=Math.round(t.width*i),h=Math.round(t.height*i),l=new Uint8Array(h_*a*h),c=r.gl;return c.readPixels(Math.round(t.x*i),Math.round(t.y*i),a,h,c.RGBA,c.UNSIGNED_BYTE,l),o&&n?.destroy(!0),{pixels:l,width:a,height:h,flipY:s}}destroy(){this.renderer=null}static _flipY(e,t,r){let i=t<<2,s=r>>1,n=new Uint8Array(i);for(let o=0;o<s;o++){let a=o*i,h=(r-o-1)*i;n.set(e.subarray(a,a+i)),e.copyWithin(a,h,h+i),e.set(n,h)}}static _unpremultiplyAlpha(e){e instanceof Uint8ClampedArray&&(e=new Uint8Array(e.buffer));let t=e.length;for(let r=0;r<t;r+=4){let i=e[r+3];if(i!==0){let s=255.001/i;e[r]=e[r]*s+.5,e[r+1]=e[r+1]*s+.5,e[r+2]=e[r+2]*s+.5}}}},Rl=vn;Rl.extension={name:"extract",type:S.RendererSystem};P.add(Rl);var Hr={build(e){let t=e.points,r,i,s,n,o,a;if(e.type===pt.CIRC){let p=e.shape;r=p.x,i=p.y,o=a=p.radius,s=n=0}else if(e.type===pt.ELIP){let p=e.shape;r=p.x,i=p.y,o=p.width,a=p.height,s=n=0}else{let p=e.shape,g=p.width/2,_=p.height/2;r=p.x+g,i=p.y+_,o=a=Math.max(0,Math.min(p.radius,Math.min(g,_))),s=g-o,n=_-a}if(!(o>=0&&a>=0&&s>=0&&n>=0)){t.length=0;return}let h=Math.ceil(2.3*Math.sqrt(o+a)),l=h*8+(s?4:0)+(n?4:0);if(t.length=l,l===0)return;if(h===0){t.length=8,t[0]=t[6]=r+s,t[1]=t[3]=i+n,t[2]=t[4]=r-s,t[5]=t[7]=i-n;return}let c=0,u=h*4+(s?2:0)+2,d=u,f=l;{let p=s+o,g=n,_=r+p,y=r-p,T=i+g;if(t[c++]=_,t[c++]=T,t[--u]=T,t[--u]=y,n){let x=i-g;t[d++]=y,t[d++]=x,t[--f]=x,t[--f]=_}}for(let p=1;p<h;p++){let g=Math.PI/2*(p/h),_=s+Math.cos(g)*o,y=n+Math.sin(g)*a,T=r+_,x=r-_,v=i+y,N=i-y;t[c++]=T,t[c++]=v,t[--u]=v,t[--u]=x,t[d++]=x,t[d++]=N,t[--f]=N,t[--f]=T}{let p=s,g=n+a,_=r+p,y=r-p,T=i+g,x=i-g;t[c++]=_,t[c++]=T,t[--f]=x,t[--f]=_,s&&(t[c++]=y,t[c++]=T,t[--f]=x,t[--f]=y)}},triangulate(e,t){let r=e.points,i=t.points,s=t.indices;if(r.length===0)return;let n=i.length/2,o=n,a,h;if(e.type!==pt.RREC){let c=e.shape;a=c.x,h=c.y}else{let c=e.shape;a=c.x+c.width/2,h=c.y+c.height/2}let l=e.matrix;i.push(e.matrix?l.a*a+l.c*h+l.tx:a,e.matrix?l.b*a+l.d*h+l.ty:h),n++,i.push(r[0],r[1]);for(let c=2;c<r.length;c+=2)i.push(r[c],r[c+1]),s.push(n++,o,n);s.push(o+1,o,n)}};function uf(e,t=!1){let r=e.length;if(r<6)return;let i=0;for(let s=0,n=e[r-2],o=e[r-1];s<r;s+=2){let a=e[s],h=e[s+1];i+=(a-n)*(h+o),n=a,o=h}if(!t&&i>0||t&&i<=0){let s=r/2;for(let n=s+s%2;n<r;n+=2){let o=r-n-2,a=r-n-1,h=n,l=n+1;[e[o],e[h]]=[e[h],e[o]],[e[a],e[l]]=[e[l],e[a]]}}}var xs={build(e){e.points=e.shape.points.slice()},triangulate(e,t){let r=e.points,i=e.holes,s=t.points,n=t.indices;if(r.length>=6){uf(r,!1);let o=[];for(let l=0;l<i.length;l++){let c=i[l];uf(c.points,!0),o.push(r.length/2),r=r.concat(c.points)}let a=O.earcut(r,o,2);if(!a)return;let h=s.length/2;for(let l=0;l<a.length;l+=3)n.push(a[l]+h),n.push(a[l+1]+h),n.push(a[l+2]+h);for(let l=0;l<r.length;l++)s.push(r[l])}}};var la={build(e){let t=e.shape,r=t.x,i=t.y,s=t.width,n=t.height,o=e.points;o.length=0,s>=0&&n>=0&&o.push(r,i,r+s,i,r+s,i+n,r,i+n)},triangulate(e,t){let r=e.points,i=t.points;if(r.length===0)return;let s=i.length/2;i.push(r[0],r[1],r[2],r[3],r[6],r[7],r[4],r[5]),t.indices.push(s,s+1,s+2,s+1,s+2,s+3)}};var ca={build(e){Hr.build(e)},triangulate(e,t){Hr.triangulate(e,t)}};var ue=(e=>(e.MITER="miter",e.BEVEL="bevel",e.ROUND="round",e))(ue||{}),$e=(e=>(e.BUTT="butt",e.ROUND="round",e.SQUARE="square",e))($e||{}),Le={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(e,t=20){if(!this.adaptive||!e||isNaN(e))return t;let r=Math.ceil(e/this.maxLength);return r<this.minSegments?r=this.minSegments:r>this.maxSegments&&(r=this.maxSegments),r}};var vi=class{static curveTo(t,r,i,s,n,o){let a=o[o.length-2],l=o[o.length-1]-r,c=a-t,u=s-r,d=i-t,f=Math.abs(l*d-c*u);if(f<1e-8||n===0)return(o[o.length-2]!==t||o[o.length-1]!==r)&&o.push(t,r),null;let p=l*l+c*c,g=u*u+d*d,_=l*u+c*d,y=n*Math.sqrt(p)/f,T=n*Math.sqrt(g)/f,x=y*_/p,v=T*_/g,N=y*d+T*c,k=y*u+T*l,B=c*(T+x),R=l*(T+x),U=d*(y+v),C=u*(y+v),F=Math.atan2(R-k,B-N),K=Math.atan2(C-k,U-N);return{cx:N+t,cy:k+r,radius:n,startAngle:F,endAngle:K,anticlockwise:c*u>d*l}}static arc(t,r,i,s,n,o,a,h,l){let c=a-o,u=Le._segmentsCount(Math.abs(c)*n,Math.ceil(Math.abs(c)/Br)*40),d=c/(u*2),f=d*2,p=Math.cos(d),g=Math.sin(d),_=u-1,y=_%1/_;for(let T=0;T<=_;++T){let x=T+y*T,v=d+o+f*x,N=Math.cos(v),k=-Math.sin(v);l.push((p*N+g*k)*n+i,(p*-k+g*N)*n+s)}}};var _s=class{constructor(){this.reset()}begin(t,r,i){this.reset(),this.style=t,this.start=r,this.attribStart=i}end(t,r){this.attribSize=r-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}};var Xr=class{static curveLength(t,r,i,s,n,o,a,h){let c=0,u=0,d=0,f=0,p=0,g=0,_=0,y=0,T=0,x=0,v=0,N=t,k=r;for(let B=1;B<=10;++B)u=B/10,d=u*u,f=d*u,p=1-u,g=p*p,_=g*p,y=_*t+3*g*u*i+3*p*d*n+f*a,T=_*r+3*g*u*s+3*p*d*o+f*h,x=N-y,v=k-T,N=y,k=T,c+=Math.sqrt(x*x+v*v);return c}static curveTo(t,r,i,s,n,o,a){let h=a[a.length-2],l=a[a.length-1];a.length-=2;let c=Le._segmentsCount(Xr.curveLength(h,l,t,r,i,s,n,o)),u=0,d=0,f=0,p=0,g=0;a.push(h,l);for(let _=1,y=0;_<=c;++_)y=_/c,u=1-y,d=u*u,f=d*u,p=y*y,g=p*y,a.push(f*h+3*d*y*t+3*u*p*i+g*n,f*l+3*d*y*r+3*u*p*s+g*o)}};function df(e,t,r,i,s,n,o,a){let h=e-r*s,l=t-i*s,c=e+r*n,u=t+i*n,d,f;o?(d=i,f=-r):(d=-i,f=r);let p=h+d,g=l+f,_=c+d,y=u+f;return a.push(p,g,_,y),2}function bi(e,t,r,i,s,n,o,a){let h=r-e,l=i-t,c=Math.atan2(h,l),u=Math.atan2(s-e,n-t);a&&c<u?c+=Math.PI*2:!a&&c>u&&(u+=Math.PI*2);let d=c,f=u-c,p=Math.abs(f),g=Math.sqrt(h*h+l*l),_=(15*p*Math.sqrt(g)/Math.PI>>0)+1,y=f/_;if(d+=y,a){o.push(e,t,r,i);for(let T=1,x=d;T<_;T++,x+=y)o.push(e,t,e+Math.sin(x)*g,t+Math.cos(x)*g);o.push(e,t,s,n)}else{o.push(r,i,e,t);for(let T=1,x=d;T<_;T++,x+=y)o.push(e+Math.sin(x)*g,t+Math.cos(x)*g,e,t);o.push(s,n,e,t)}return _*2}function l_(e,t){let r=e.shape,i=e.points||r.points.slice(),s=t.closePointEps;if(i.length===0)return;let n=e.lineStyle,o=new Q(i[0],i[1]),a=new Q(i[i.length-2],i[i.length-1]),h=r.type!==pt.POLY||r.closeStroke,l=Math.abs(o.x-a.x)<s&&Math.abs(o.y-a.y)<s;if(h){i=i.slice(),l&&(i.pop(),i.pop(),a.set(i[i.length-2],i[i.length-1]));let et=(o.x+a.x)*.5,G=(a.y+o.y)*.5;i.unshift(et,G),i.push(et,G)}let c=t.points,u=i.length/2,d=i.length,f=c.length/2,p=n.width/2,g=p*p,_=n.miterLimit*n.miterLimit,y=i[0],T=i[1],x=i[2],v=i[3],N=0,k=0,B=-(T-v),R=y-x,U=0,C=0,F=Math.sqrt(B*B+R*R);B/=F,R/=F,B*=p,R*=p;let K=n.alignment,A=(1-K)*2,I=K*2;h||(n.cap===$e.ROUND?d+=bi(y-B*(A-I)*.5,T-R*(A-I)*.5,y-B*A,T-R*A,y+B*I,T+R*I,c,!0)+2:n.cap===$e.SQUARE&&(d+=df(y,T,B,R,A,I,!0,c))),c.push(y-B*A,T-R*A,y+B*I,T+R*I);for(let et=1;et<u-1;++et){y=i[(et-1)*2],T=i[(et-1)*2+1],x=i[et*2],v=i[et*2+1],N=i[(et+1)*2],k=i[(et+1)*2+1],B=-(T-v),R=y-x,F=Math.sqrt(B*B+R*R),B/=F,R/=F,B*=p,R*=p,U=-(v-k),C=x-N,F=Math.sqrt(U*U+C*C),U/=F,C/=F,U*=p,C*=p;let G=x-y,m=T-v,b=x-N,E=k-v,M=G*b+m*E,D=m*b-E*G,X=D<0;if(Math.abs(D)<.001*Math.abs(M)){c.push(x-B*A,v-R*A,x+B*I,v+R*I),M>=0&&(n.join===ue.ROUND?d+=bi(x,v,x-B*A,v-R*A,x-U*A,v-C*A,c,!1)+4:d+=2,c.push(x-U*I,v-C*I,x+U*A,v+C*A));continue}let Z=(-B+y)*(-R+v)-(-B+x)*(-R+T),J=(-U+N)*(-C+v)-(-U+x)*(-C+k),nt=(G*J-b*Z)/D,ot=(E*Z-m*J)/D,at=(nt-x)*(nt-x)+(ot-v)*(ot-v),wt=x+(nt-x)*A,At=v+(ot-v)*A,Pt=x-(nt-x)*I,qt=v-(ot-v)*I,Zr=Math.min(G*G+m*m,b*b+E*E),qn=X?A:I,Kn=Zr+qn*qn*g,Ua=at<=Kn,Zn=n.join;if(Zn===ue.MITER&&at/g>_&&(Zn=ue.BEVEL),Ua)switch(Zn){case ue.MITER:{c.push(wt,At,Pt,qt);break}case ue.BEVEL:{X?c.push(wt,At,x+B*I,v+R*I,wt,At,x+U*I,v+C*I):c.push(x-B*A,v-R*A,Pt,qt,x-U*A,v-C*A,Pt,qt),d+=2;break}case ue.ROUND:{X?(c.push(wt,At,x+B*I,v+R*I),d+=bi(x,v,x+B*I,v+R*I,x+U*I,v+C*I,c,!0)+4,c.push(wt,At,x+U*I,v+C*I)):(c.push(x-B*A,v-R*A,Pt,qt),d+=bi(x,v,x-B*A,v-R*A,x-U*A,v-C*A,c,!1)+4,c.push(x-U*A,v-C*A,Pt,qt));break}}else{switch(c.push(x-B*A,v-R*A,x+B*I,v+R*I),Zn){case ue.MITER:{X?c.push(Pt,qt,Pt,qt):c.push(wt,At,wt,At),d+=2;break}case ue.ROUND:{X?d+=bi(x,v,x+B*I,v+R*I,x+U*I,v+C*I,c,!0)+2:d+=bi(x,v,x-B*A,v-R*A,x-U*A,v-C*A,c,!1)+2;break}}c.push(x-U*A,v-C*A,x+U*I,v+C*I),d+=2}}y=i[(u-2)*2],T=i[(u-2)*2+1],x=i[(u-1)*2],v=i[(u-1)*2+1],B=-(T-v),R=y-x,F=Math.sqrt(B*B+R*R),B/=F,R/=F,B*=p,R*=p,c.push(x-B*A,v-R*A,x+B*I,v+R*I),h||(n.cap===$e.ROUND?d+=bi(x-B*(A-I)*.5,v-R*(A-I)*.5,x-B*A,v-R*A,x+B*I,v+R*I,c,!1)+2:n.cap===$e.SQUARE&&(d+=df(x,v,B,R,A,I,!1,c)));let it=t.indices,Y=Le.epsilon*Le.epsilon;for(let et=f;et<d+f-2;++et)y=c[et*2],T=c[et*2+1],x=c[(et+1)*2],v=c[(et+1)*2+1],N=c[(et+2)*2],k=c[(et+2)*2+1],!(Math.abs(y*(v-k)+x*(k-T)+N*(T-v))<Y)&&it.push(et,et+1,et+2)}function c_(e,t){let r=0,i=e.shape,s=e.points||i.points,n=i.type!==pt.POLY||i.closeStroke;if(s.length===0)return;let o=t.points,a=t.indices,h=s.length/2,l=o.length/2,c=l;for(o.push(s[0],s[1]),r=1;r<h;r++)o.push(s[r*2],s[r*2+1]),a.push(c,c+1),c++;n&&a.push(c,l)}function bn(e,t){e.lineStyle.native?c_(e,t):l_(e,t)}var Vr=class{static curveLength(t,r,i,s,n,o){let a=t-2*i+n,h=r-2*s+o,l=2*i-2*t,c=2*s-2*r,u=4*(a*a+h*h),d=4*(a*l+h*c),f=l*l+c*c,p=2*Math.sqrt(u+d+f),g=Math.sqrt(u),_=2*u*g,y=2*Math.sqrt(f),T=d/g;return(_*p+g*d*(p-y)+(4*f*u-d*d)*Math.log((2*g+T+p)/(T+y)))/(4*_)}static curveTo(t,r,i,s,n){let o=n[n.length-2],a=n[n.length-1],h=Le._segmentsCount(Vr.curveLength(o,a,t,r,i,s)),l=0,c=0;for(let u=1;u<=h;++u){let d=u/h;l=o+(t-o)*d,c=a+(r-a)*d,n.push(l+(t+(i-t)*d-l)*d,c+(r+(s-r)*d-c)*d)}}};var Tn={[pt.POLY]:xs,[pt.CIRC]:Hr,[pt.ELIP]:Hr,[pt.RECT]:la,[pt.RREC]:ca},ua=[],ys=[];var zr=class{constructor(t,r=null,i=null,s=null){this.points=[],this.holes=[],this.shape=t,this.lineStyle=i,this.fillStyle=r,this.matrix=s,this.type=t.type}clone(){return new zr(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}};var vs=new Q,ff=class extends ii{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new Qe,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),ys.push(this.drawCalls[e]);this.drawCalls.length=0;for(let e=0;e<this.batches.length;e++){let t=this.batches[e];t.reset(),ua.push(t)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(e,t=null,r=null,i=null){let s=new zr(e,t,r,i);return this.graphicsData.push(s),this.dirty++,this}drawHole(e,t=null){if(!this.graphicsData.length)return null;let r=new zr(e,null,null,t),i=this.graphicsData[this.graphicsData.length-1];return r.lineStyle=i.lineStyle,i.holes.push(r),this.dirty++,this}destroy(){super.destroy();for(let e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(e){let t=this.graphicsData;for(let r=0;r<t.length;++r){let i=t[r];if(i.fillStyle.visible&&i.shape&&(i.matrix?i.matrix.applyInverse(e,vs):vs.copyFrom(e),i.shape.contains(vs.x,vs.y))){let s=!1;if(i.holes){for(let n=0;n<i.holes.length;n++)if(i.holes[n].shape.contains(vs.x,vs.y)){s=!0;break}}if(!s)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;let e=this.uvs,t=this.graphicsData,r=null,i=null;this.batches.length>0&&(r=this.batches[this.batches.length-1],i=r.style);for(let a=this.shapeIndex;a<t.length;a++){this.shapeIndex++;let h=t[a],l=h.fillStyle,c=h.lineStyle;Tn[h.type].build(h),h.matrix&&this.transformPoints(h.points,h.matrix),(l.visible||c.visible)&&this.processHoles(h.holes);for(let d=0;d<2;d++){let f=d===0?l:c;if(!f.visible)continue;let p=f.texture.baseTexture,g=this.indices.length,_=this.points.length/2;p.wrapMode=Ee.REPEAT,d===0?this.processFill(h):this.processLine(h);let y=this.points.length/2-_;y!==0&&(r&&!this._compareStyles(i,f)&&(r.end(g,_),r=null),r||(r=ua.pop()||new _s,r.begin(f,g,_),this.batches.push(r),i=f),this.addUvs(this.points,e,f.texture,_,y,f.matrix))}}let s=this.indices.length,n=this.points.length/2;if(r&&r.end(s,n),this.batches.length===0){this.batchable=!0;return}let o=n>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&o===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=o?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(e,t){return!(!e||!t||e.texture.baseTexture!==t.texture.baseTexture||e.color+e.alpha!==t.color+t.alpha||!!e.native!=!!t.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let e=0,t=this.graphicsData.length;e<t;e++){let r=this.graphicsData[e],i=r.fillStyle,s=r.lineStyle;if(i&&!i.texture.baseTexture.valid||s&&!s.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);let e=this.batches;for(let t=0,r=e.length;t<r;t++){let i=e[t];for(let s=0;s<i.size;s++){let n=i.start+s;this.indicesUint16[n]=this.indicesUint16[n]-i.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;let e=this.batches;for(let t=0;t<e.length;t++)if(e[t].style.native)return!1;return this.points.length<ff.BATCHABLE_SIZE*2}buildDrawCalls(){let e=++W._globalBatch;for(let c=0;c<this.drawCalls.length;c++)this.drawCalls[c].texArray.clear(),ys.push(this.drawCalls[c]);this.drawCalls.length=0;let t=this.colors,r=this.textureIds,i=ys.pop();i||(i=new Cr,i.texArray=new Dr),i.texArray.count=0,i.start=0,i.size=0,i.type=me.TRIANGLES;let s=0,n=null,o=0,a=!1,h=me.TRIANGLES,l=0;this.drawCalls.push(i);for(let c=0;c<this.batches.length;c++){let u=this.batches[c],d=8,f=u.style,p=f.texture.baseTexture;a!==!!f.native&&(a=!!f.native,h=a?me.LINES:me.TRIANGLES,n=null,s=d,e++),n!==p&&(n=p,p._batchEnabled!==e&&(s===d&&(e++,s=0,i.size>0&&(i=ys.pop(),i||(i=new Cr,i.texArray=new Dr),this.drawCalls.push(i)),i.start=l,i.size=0,i.texArray.count=0,i.type=h),p.touched=1,p._batchEnabled=e,p._batchLocation=s,p.wrapMode=Ee.REPEAT,i.texArray.elements[i.texArray.count++]=p,s++)),i.size+=u.size,l+=u.size,o=p._batchLocation,this.addColors(t,f.color,f.alpha,u.attribSize,u.attribStart),this.addTextureIds(r,o,u.attribSize,u.attribStart)}W._globalBatch=e,this.packAttributes()}packAttributes(){let e=this.points,t=this.uvs,r=this.colors,i=this.textureIds,s=new ArrayBuffer(e.length*3*4),n=new Float32Array(s),o=new Uint32Array(s),a=0;for(let h=0;h<e.length/2;h++)n[a++]=e[h*2],n[a++]=e[h*2+1],n[a++]=t[h*2],n[a++]=t[h*2+1],o[a++]=r[h],n[a++]=i[h];this._buffer.update(s),this._indexBuffer.update(this.indicesUint16)}processFill(e){e.holes.length?xs.triangulate(e,this):Tn[e.type].triangulate(e,this)}processLine(e){bn(e,this);for(let t=0;t<e.holes.length;t++)bn(e.holes[t],this)}processHoles(e){for(let t=0;t<e.length;t++){let r=e[t];Tn[r.type].build(r),r.matrix&&this.transformPoints(r.points,r.matrix)}}calculateBounds(){let e=this._bounds;e.clear(),e.addVertexData(this.points,0,this.points.length),e.pad(this.boundsPadding,this.boundsPadding)}transformPoints(e,t){for(let r=0;r<e.length/2;r++){let i=e[r*2],s=e[r*2+1];e[r*2]=t.a*i+t.c*s+t.tx,e[r*2+1]=t.b*i+t.d*s+t.ty}}addColors(e,t,r,i,s=0){let n=tt.shared.setValue(t).toLittleEndianNumber(),o=tt.shared.setValue(n).toPremultiplied(r);e.length=Math.max(e.length,s+i);for(let a=0;a<i;a++)e[s+a]=o}addTextureIds(e,t,r,i=0){e.length=Math.max(e.length,i+r);for(let s=0;s<r;s++)e[i+s]=t}addUvs(e,t,r,i,s,n=null){let o=0,a=t.length,h=r.frame;for(;o<s;){let c=e[(i+o)*2],u=e[(i+o)*2+1];if(n){let d=n.a*c+n.c*u+n.tx;u=n.b*c+n.d*u+n.ty,c=d}o++,t.push(c/h.width,u/h.height)}let l=r.baseTexture;(h.width<l.width||h.height<l.height)&&this.adjustUvs(t,r,a,s)}adjustUvs(e,t,r,i){let s=t.baseTexture,n=1e-6,o=r+i*2,a=t.frame,h=a.width/s.width,l=a.height/s.height,c=a.x/a.width,u=a.y/a.height,d=Math.floor(e[r]+n),f=Math.floor(e[r+1]+n);for(let p=r+2;p<o;p+=2)d=Math.min(d,Math.floor(e[p]+n)),f=Math.min(f,Math.floor(e[p+1]+n));c-=d,u-=f;for(let p=r;p<o;p+=2)e[p]=(e[p]+c)*h,e[p+1]=(e[p+1]+u)*l}},da=ff;da.BATCHABLE_SIZE=100;var yr=class{constructor(){this.color=16777215,this.alpha=1,this.texture=H.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){let t=new yr;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=H.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}};var Ti=class extends yr{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=$e.BUTT,this.join=ue.MITER,this.miterLimit=10}clone(){let t=new Ti;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1}};var Cl={},fa=class extends St{constructor(e=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new yr,this._lineStyle=new Ti,this._matrix=null,this._holeMode=!1,this.state=Nt.for2d(),this._geometry=e||new da,this._geometry.refCount++,this._transformID=-1,this._tintColor=new tt(16777215),this.blendMode=q.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new fa(this._geometry)}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(e=null,t=0,r,i=.5,s=!1){return typeof e=="number"&&(e={width:e,color:t,alpha:r,alignment:i,native:s}),this.lineTextureStyle(e)}lineTextureStyle(e){let t={width:0,texture:H.WHITE,color:e?.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:$e.BUTT,join:ue.MITER,miterLimit:10};e=Object.assign(t,e),this.normalizeColor(e),this.currentPath&&this.startPoly();let r=e.width>0&&e.alpha>0;return r?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:r},e)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){let e=this.currentPath.points,t=this.currentPath.points.length;t>2&&(this.drawShape(this.currentPath),this.currentPath=new Ge,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[t-2],e[t-1]))}else this.currentPath=new Ge,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(e,t){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=t,this}lineTo(e,t){this.currentPath||this.moveTo(0,0);let r=this.currentPath.points,i=r[r.length-2],s=r[r.length-1];return(i!==e||s!==t)&&r.push(e,t),this}_initCurve(e=0,t=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[e,t]):this.moveTo(e,t)}quadraticCurveTo(e,t,r,i){this._initCurve();let s=this.currentPath.points;return s.length===0&&this.moveTo(0,0),Vr.curveTo(e,t,r,i,s),this}bezierCurveTo(e,t,r,i,s,n){return this._initCurve(),Xr.curveTo(e,t,r,i,s,n,this.currentPath.points),this}arcTo(e,t,r,i,s){this._initCurve(e,t);let n=this.currentPath.points,o=vi.curveTo(e,t,r,i,s,n);if(o){let{cx:a,cy:h,radius:l,startAngle:c,endAngle:u,anticlockwise:d}=o;this.arc(a,h,l,c,u,d)}return this}arc(e,t,r,i,s,n=!1){if(i===s)return this;if(!n&&s<=i?s+=Br:n&&i<=s&&(i+=Br),s-i===0)return this;let a=e+Math.cos(i)*r,h=t+Math.sin(i)*r,l=this._geometry.closePointEps,c=this.currentPath?this.currentPath.points:null;if(c){let u=Math.abs(c[c.length-2]-a),d=Math.abs(c[c.length-1]-h);u<l&&d<l||c.push(a,h)}else this.moveTo(a,h),c=this.currentPath.points;return vi.arc(a,h,e,t,r,i,s,n,c),this}beginFill(e=0,t){return this.beginTextureFill({texture:H.WHITE,color:e,alpha:t})}normalizeColor(e){let t=tt.shared.setValue(e.color??0);e.color=t.toNumber(),e.alpha??(e.alpha=t.alpha)}beginTextureFill(e){let t={texture:H.WHITE,color:16777215,matrix:null};e=Object.assign(t,e),this.normalizeColor(e),this.currentPath&&this.startPoly();let r=e.alpha>0;return r?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:r},e)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(e,t,r,i){return this.drawShape(new $(e,t,r,i))}drawRoundedRect(e,t,r,i,s){return this.drawShape(new oi(e,t,r,i,s))}drawCircle(e,t,r){return this.drawShape(new si(e,t,r))}drawEllipse(e,t,r,i){return this.drawShape(new ni(e,t,r,i))}drawPolygon(...e){let t,r=!0,i=e[0];i.points?(r=i.closeStroke,t=i.points):Array.isArray(e[0])?t=e[0]:t=e;let s=new Ge(t);return s.closeStroke=r,this.drawShape(s),this}drawShape(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){let e=this._geometry.graphicsData;return e.length===1&&e[0].shape.type===pt.RECT&&!e[0].matrix&&!e[0].holes.length&&!(e[0].lineStyle.visible&&e[0].lineStyle.width)}_render(e){this.finishPoly();let t=this._geometry;t.updateBatches(),t.batchable?(this.batchDirty!==t.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))}_populateBatches(){let e=this._geometry,t=this.blendMode,r=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=r,this.vertexData=new Float32Array(e.points);for(let i=0;i<r;i++){let s=e.batches[i],n=s.style.color,o=new Float32Array(this.vertexData.buffer,s.attribStart*4*2,s.attribSize*2),a=new Float32Array(e.uvsFloat32.buffer,s.attribStart*4*2,s.attribSize*2),h=new Uint16Array(e.indicesUint16.buffer,s.start*2,s.size),l={vertexData:o,blendMode:t,indices:h,uvs:a,_batchRGB:tt.shared.setValue(n).toRgbArray(),_tintRGB:n,_texture:s.style.texture,alpha:s.style.alpha,worldAlpha:1};this.batches[i]=l}}_renderBatched(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let t=0,r=this.batches.length;t<r;t++){let i=this.batches[t];i.worldAlpha=this.worldAlpha*i.alpha,e.plugins[this.pluginName].render(i)}}}_renderDirect(e){let t=this._resolveDirectShader(e),r=this._geometry,i=this.worldAlpha,s=t.uniforms,n=r.drawCalls;s.translationMatrix=this.transform.worldTransform,tt.shared.setValue(this._tintColor).premultiply(i).toArray(s.tint),e.shader.bind(t),e.geometry.bind(r,t),e.state.set(this.state);for(let o=0,a=n.length;o<a;o++)this._renderDrawCallDirect(e,r.drawCalls[o])}_renderDrawCallDirect(e,t){let{texArray:r,type:i,size:s,start:n}=t,o=r.count;for(let a=0;a<o;a++)e.texture.bind(r.elements[a],a);e.geometry.draw(i,s,n)}_resolveDirectShader(e){let t=this.shader,r=this.pluginName;if(!t){if(!Cl[r]){let{maxTextures:i}=e.plugins[r],s=new Int32Array(i);for(let a=0;a<i;a++)s[a]=a;let n={tint:new Float32Array([1,1,1,1]),translationMatrix:new st,default:Ut.from({uSamplers:s},!0)},o=e.plugins[r]._shader.program;Cl[r]=new Gt(o,n)}t=Cl[r]}return t}_calculateBounds(){this.finishPoly();let e=this._geometry;if(!e.graphicsData.length)return;let{minX:t,minY:r,maxX:i,maxY:s}=e.bounds;this._bounds.addFrame(this.transform,t,r,i,s)}containsPoint(e){return this.worldTransform.applyInverse(e,fa._TEMP_POINT),this._geometry.containsPoint(fa._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let e=0;e<this.batches.length;e++){let t=this.batches[e];t._tintRGB=tt.shared.setValue(this._tintColor).multiply(t._batchRGB).toLittleEndianNumber()}}}calculateVertices(){let e=this.transform._worldID;if(this._transformID===e)return;this._transformID=e;let t=this.transform.worldTransform,r=t.a,i=t.b,s=t.c,n=t.d,o=t.tx,a=t.ty,h=this._geometry.points,l=this.vertexData,c=0;for(let u=0;u<h.length;u+=2){let d=h[u],f=h[u+1];l[c++]=r*d+s*f+o,l[c++]=n*f+i*d+a}}closePath(){let e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this}setMatrix(e){return this._matrix=e,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(e){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(e)}},V=fa;V.curves=Le;V._TEMP_POINT=new Q;var wn=class{constructor(t,r){this.uvBuffer=t,this.uvMatrix=r,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(t){if(!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;let r=this.uvBuffer.data;(!this.data||this.data.length!==r.length)&&(this.data=new Float32Array(r.length)),this.uvMatrix.multiplyUvs(r,this.data),this._updateID++}};var Ml=new Q,pf=new Ge,mf=class extends St{constructor(e,t,r,i=me.TRIANGLES){super(),this.geometry=e,this.shader=t,this.state=r||Nt.for2d(),this.drawMode=i,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=w.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(e){this._geometry!==e&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=e,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(e){this.shader=e}get material(){return this.shader}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(e){this.shader.tint=e}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(e){this.shader.texture=e}_render(e){let t=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===me.TRIANGLES&&t.length<mf.BATCHABLE_SIZE*2?this._renderToBatch(e):this._renderDefault(e)}_renderDefault(e){let t=this.shader;t.alpha=this.worldAlpha,t.update&&t.update(),e.batch.flush(),t.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),e.shader.bind(t),e.state.set(this.state),e.geometry.bind(this.geometry,t),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(e){let t=this.geometry,r=this.shader;r.uvMatrix&&(r.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=t.indexBuffer.data,this._tintRGB=r._tintRGB,this._texture=r.texture;let i=this.material.pluginName;e.batch.setObjectRenderer(e.plugins[i]),e.plugins[i].render(this)}calculateVertices(){let t=this.geometry.buffers[0],r=t.data,i=t._updateID;if(i===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==r.length&&(this.vertexData=new Float32Array(r.length));let s=this.transform.worldTransform,n=s.a,o=s.b,a=s.c,h=s.d,l=s.tx,c=s.ty,u=this.vertexData;for(let d=0;d<u.length/2;d++){let f=r[d*2],p=r[d*2+1];u[d*2]=n*f+a*p+l,u[d*2+1]=o*f+h*p+c}if(this._roundPixels){let d=w.RESOLUTION;for(let f=0;f<u.length;++f)u[f]=Math.round(u[f]*d)/d}this.vertexDirty=i}calculateUvs(){let e=this.geometry.buffers[1],t=this.shader;t.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new wn(e,t.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,Ml);let t=this.geometry.getBuffer("aVertexPosition").data,r=pf.points,i=this.geometry.getIndex().data,s=i.length,n=this.drawMode===4?3:1;for(let o=0;o+2<s;o+=n){let a=i[o]*2,h=i[o+1]*2,l=i[o+2]*2;if(r[0]=t[a],r[1]=t[a+1],r[2]=t[h],r[3]=t[h+1],r[4]=t[l],r[5]=t[l+1],pf.contains(Ml.x,Ml.y))return!0}return!1}destroy(e){super.destroy(e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}},Wr=mf;Wr.BATCHABLE_SIZE=100;var $r=class extends ie{constructor(t,r,i){super();let s=new ut(t),n=new ut(r,!0),o=new ut(i,!0,!0);this.addAttribute("aVertexPosition",s,2,!1,z.FLOAT).addAttribute("aTextureCoord",n,2,!1,z.FLOAT).addIndex(o),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}};var gf=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`;var xf=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;var vr=class extends Gt{constructor(t,r){let i={uSampler:t,alpha:1,uTextureMatrix:st.IDENTITY,uColor:new Float32Array([1,1,1,1])};r=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},r),r.uniforms&&Object.assign(i,r.uniforms),super(r.program||Wt.from(xf,gf),i),this._colorDirty=!1,this.uvMatrix=new Lr(t),this.batchable=r.program===void 0,this.pluginName=r.pluginName,this._tintColor=new tt(r.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=r.alpha}get texture(){return this.uniforms.uSampler}set texture(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)}set alpha(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(t){t!==this.tint&&(this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;let r=this.texture.baseTexture.alphaMode;tt.shared.setValue(this._tintColor).premultiply(this._alpha,r).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}};var En=class{constructor(t,r,i){this.geometry=new ie,this.indexBuffer=null,this.size=i,this.dynamicProperties=[],this.staticProperties=[];for(let s=0;s<t.length;++s){let n=t[s];n={attributeName:n.attributeName,size:n.size,uploadFunction:n.uploadFunction,type:n.type||z.FLOAT,offset:n.offset},r[s]?this.dynamicProperties.push(n):this.staticProperties.push(n)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){let t=this.geometry,r=0;this.indexBuffer=new ut(O.createIndicesForQuads(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(let o=0;o<this.dynamicProperties.length;++o){let a=this.dynamicProperties[o];a.offset=r,r+=a.size,this.dynamicStride+=a.size}let i=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(i),this.dynamicDataUint32=new Uint32Array(i),this.dynamicBuffer=new ut(this.dynamicData,!1,!1);let s=0;this.staticStride=0;for(let o=0;o<this.staticProperties.length;++o){let a=this.staticProperties[o];a.offset=s,s+=a.size,this.staticStride+=a.size}let n=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(n),this.staticDataUint32=new Uint32Array(n),this.staticBuffer=new ut(this.staticData,!0,!1);for(let o=0;o<this.dynamicProperties.length;++o){let a=this.dynamicProperties[o];t.addAttribute(a.attributeName,this.dynamicBuffer,0,a.type===z.UNSIGNED_BYTE,a.type,this.dynamicStride*4,a.offset*4)}for(let o=0;o<this.staticProperties.length;++o){let a=this.staticProperties[o];t.addAttribute(a.attributeName,this.staticBuffer,0,a.type===z.UNSIGNED_BYTE,a.type,this.staticStride*4,a.offset*4)}}uploadDynamic(t,r,i){for(let s=0;s<this.dynamicProperties.length;s++){let n=this.dynamicProperties[s];n.uploadFunction(t,r,i,n.type===z.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,n.offset)}this.dynamicBuffer._updateID++}uploadStatic(t,r,i){for(let s=0;s<this.staticProperties.length;s++){let n=this.staticProperties[s];n.uploadFunction(t,r,i,n.type===z.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,n.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}};var _f=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`;var yf=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;var Sn=class extends ke{constructor(t){super(t),this.shader=null,this.properties=null,this.tempMatrix=new st,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:z.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=Gt.from(yf,_f,{}),this.state=Nt.for2d()}render(t){let r=t.children,i=t._maxSize,s=t._batchSize,n=this.renderer,o=r.length;if(o===0)return;o>i&&!t.autoResize&&(o=i);let a=t._buffers;a||(a=t._buffers=this.generateBuffers(t));let h=r[0]._texture.baseTexture,l=h.alphaMode>0;this.state.blendMode=O.correctBlendMode(t.blendMode,l),n.state.set(this.state);let c=n.gl,u=t.worldTransform.copyTo(this.tempMatrix);u.prepend(n.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=u.toArray(!0),this.shader.uniforms.uColor=tt.shared.setValue(t.tintRgb).premultiply(t.worldAlpha,l).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=h,this.renderer.shader.bind(this.shader);let d=!1;for(let f=0,p=0;f<o;f+=s,p+=1){let g=o-f;g>s&&(g=s),p>=a.length&&a.push(this._generateOneMoreBuffer(t));let _=a[p];_.uploadDynamic(r,f,g);let y=t._bufferUpdateIDs[p]||0;d=d||_._updateID<y,d&&(_._updateID=t._updateID,_.uploadStatic(r,f,g)),n.geometry.bind(_.geometry),c.drawElements(c.TRIANGLES,g*6,c.UNSIGNED_SHORT,0)}}generateBuffers(t){let r=[],i=t._maxSize,s=t._batchSize,n=t._properties;for(let o=0;o<i;o+=s)r.push(new En(this.properties,n,s));return r}_generateOneMoreBuffer(t){let r=t._batchSize,i=t._properties;return new En(this.properties,i,r)}uploadVertices(t,r,i,s,n,o){let a=0,h=0,l=0,c=0;for(let u=0;u<i;++u){let d=t[r+u],f=d._texture,p=d.scale.x,g=d.scale.y,_=f.trim,y=f.orig;_?(h=_.x-d.anchor.x*y.width,a=h+_.width,c=_.y-d.anchor.y*y.height,l=c+_.height):(a=y.width*(1-d.anchor.x),h=y.width*-d.anchor.x,l=y.height*(1-d.anchor.y),c=y.height*-d.anchor.y),s[o]=h*p,s[o+1]=c*g,s[o+n]=a*p,s[o+n+1]=c*g,s[o+n*2]=a*p,s[o+n*2+1]=l*g,s[o+n*3]=h*p,s[o+n*3+1]=l*g,o+=n*4}}uploadPosition(t,r,i,s,n,o){for(let a=0;a<i;a++){let h=t[r+a].position;s[o]=h.x,s[o+1]=h.y,s[o+n]=h.x,s[o+n+1]=h.y,s[o+n*2]=h.x,s[o+n*2+1]=h.y,s[o+n*3]=h.x,s[o+n*3+1]=h.y,o+=n*4}}uploadRotation(t,r,i,s,n,o){for(let a=0;a<i;a++){let h=t[r+a].rotation;s[o]=h,s[o+n]=h,s[o+n*2]=h,s[o+n*3]=h,o+=n*4}}uploadUvs(t,r,i,s,n,o){for(let a=0;a<i;++a){let h=t[r+a]._texture._uvs;h?(s[o]=h.x0,s[o+1]=h.y0,s[o+n]=h.x1,s[o+n+1]=h.y1,s[o+n*2]=h.x2,s[o+n*2+1]=h.y2,s[o+n*3]=h.x3,s[o+n*3+1]=h.y3,o+=n*4):(s[o]=0,s[o+1]=0,s[o+n]=0,s[o+n+1]=0,s[o+n*2]=0,s[o+n*2+1]=0,s[o+n*3]=0,s[o+n*3+1]=0,o+=n*4)}}uploadTint(t,r,i,s,n,o){for(let a=0;a<i;++a){let h=t[r+a],l=tt.shared.setValue(h._tintRGB).toPremultiplied(h.alpha,h.texture.baseTexture.alphaMode>0);s[o]=l,s[o+n]=l,s[o+n*2]=l,s[o+n*3]=l,o+=n*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}};Sn.extension={name:"particle",type:S.RendererPlugin};P.add(Sn);var jr=(e=>(e[e.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",e[e.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",e))(jr||{});var pa={willReadFrequently:!0},j=class{static get experimentalLetterSpacingSupported(){let e=j._experimentalLetterSpacingSupported;if(e!==void 0){let t=w.ADAPTER.getCanvasRenderingContext2D().prototype;e=j._experimentalLetterSpacingSupported="letterSpacing"in t||"textLetterSpacing"in t}return e}constructor(e,t,r,i,s,n,o,a,h){this.text=e,this.style=t,this.width=r,this.height=i,this.lines=s,this.lineWidths=n,this.lineHeight=o,this.maxLineWidth=a,this.fontProperties=h}static measureText(e,t,r,i=j._canvas){r=r??t.wordWrap;let s=t.toFontString(),n=j.measureFont(s);n.fontSize===0&&(n.fontSize=t.fontSize,n.ascent=t.fontSize);let o=i.getContext("2d",pa);o.font=s;let h=(r?j.wordWrap(e,t,i):e).split(/(?:\r\n|\r|\n)/),l=new Array(h.length),c=0;for(let p=0;p<h.length;p++){let g=j._measureText(h[p],t.letterSpacing,o);l[p]=g,c=Math.max(c,g)}let u=c+t.strokeThickness;t.dropShadow&&(u+=t.dropShadowDistance);let d=t.lineHeight||n.fontSize+t.strokeThickness,f=Math.max(d,n.fontSize+t.strokeThickness*2)+(h.length-1)*(d+t.leading);return t.dropShadow&&(f+=t.dropShadowDistance),new j(e,t,u,f,h,l,d+t.leading,c,n)}static _measureText(e,t,r){let i=!1;j.experimentalLetterSpacingSupported&&(j.experimentalLetterSpacing?(r.letterSpacing=`${t}px`,r.textLetterSpacing=`${t}px`,i=!0):(r.letterSpacing="0px",r.textLetterSpacing="0px"));let s=r.measureText(e).width;return s>0&&(i?s-=t:s+=(j.graphemeSegmenter(e).length-1)*t),s}static wordWrap(e,t,r=j._canvas){let i=r.getContext("2d",pa),s=0,n="",o="",a=Object.create(null),{letterSpacing:h,whiteSpace:l}=t,c=j.collapseSpaces(l),u=j.collapseNewlines(l),d=!c,f=t.wordWrapWidth+h,p=j.tokenize(e);for(let g=0;g<p.length;g++){let _=p[g];if(j.isNewline(_)){if(!u){o+=j.addLine(n),d=!c,n="",s=0;continue}_=" "}if(c){let T=j.isBreakingSpace(_),x=j.isBreakingSpace(n[n.length-1]);if(T&&x)continue}let y=j.getFromCache(_,h,a,i);if(y>f)if(n!==""&&(o+=j.addLine(n),n="",s=0),j.canBreakWords(_,t.breakWords)){let T=j.wordWrapSplit(_);for(let x=0;x<T.length;x++){let v=T[x],N=v,k=1;for(;T[x+k];){let R=T[x+k];if(!j.canBreakChars(N,R,_,x,t.breakWords))v+=R;else break;N=R,k++}x+=k-1;let B=j.getFromCache(v,h,a,i);B+s>f&&(o+=j.addLine(n),d=!1,n="",s=0),n+=v,s+=B}}else{n.length>0&&(o+=j.addLine(n),n="",s=0);let T=g===p.length-1;o+=j.addLine(_,!T),d=!1,n="",s=0}else y+s>f&&(d=!1,o+=j.addLine(n),n="",s=0),(n.length>0||!j.isBreakingSpace(_)||d)&&(n+=_,s+=y)}return o+=j.addLine(n,!1),o}static addLine(e,t=!0){return e=j.trimRight(e),e=t?`${e}
`:e,e}static getFromCache(e,t,r,i){let s=r[e];return typeof s!="number"&&(s=j._measureText(e,t,i)+t,r[e]=s),s}static collapseSpaces(e){return e==="normal"||e==="pre-line"}static collapseNewlines(e){return e==="normal"}static trimRight(e){if(typeof e!="string")return"";for(let t=e.length-1;t>=0;t--){let r=e[t];if(!j.isBreakingSpace(r))break;e=e.slice(0,-1)}return e}static isNewline(e){return typeof e!="string"?!1:j._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,t){return typeof e!="string"?!1:j._breakingSpaces.includes(e.charCodeAt(0))}static tokenize(e){let t=[],r="";if(typeof e!="string")return t;for(let i=0;i<e.length;i++){let s=e[i],n=e[i+1];if(j.isBreakingSpace(s,n)||j.isNewline(s)){r!==""&&(t.push(r),r=""),t.push(s);continue}r+=s}return r!==""&&t.push(r),t}static canBreakWords(e,t){return t}static canBreakChars(e,t,r,i,s){return!0}static wordWrapSplit(e){return j.graphemeSegmenter(e)}static measureFont(e){if(j._fonts[e])return j._fonts[e];let t={ascent:0,descent:0,fontSize:0},r=j._canvas,i=j._context;i.font=e;let s=j.METRICS_STRING+j.BASELINE_SYMBOL,n=Math.ceil(i.measureText(s).width),o=Math.ceil(i.measureText(j.BASELINE_SYMBOL).width),a=Math.ceil(j.HEIGHT_MULTIPLIER*o);if(o=o*j.BASELINE_MULTIPLIER|0,n===0||a===0)return j._fonts[e]=t,t;r.width=n,r.height=a,i.fillStyle="#f00",i.fillRect(0,0,n,a),i.font=e,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(s,0,o);let h=i.getImageData(0,0,n,a).data,l=h.length,c=n*4,u=0,d=0,f=!1;for(u=0;u<o;++u){for(let p=0;p<c;p+=4)if(h[d+p]!==255){f=!0;break}if(!f)d+=c;else break}for(t.ascent=o-u,d=l-c,f=!1,u=a;u>o;--u){for(let p=0;p<c;p+=4)if(h[d+p]!==255){f=!0;break}if(!f)d-=c;else break}return t.descent=u-o,t.fontSize=t.ascent+t.descent,j._fonts[e]=t,t}static clearMetrics(e=""){e?delete j._fonts[e]:j._fonts={}}static get _canvas(){if(!j.__canvas){let e;try{let t=new OffscreenCanvas(0,0);if(t.getContext("2d",pa)?.measureText)return j.__canvas=t,t;e=w.ADAPTER.createCanvas()}catch{e=w.ADAPTER.createCanvas()}e.width=e.height=10,j.__canvas=e}return j.__canvas}static get _context(){return j.__context||(j.__context=j._canvas.getContext("2d",pa)),j.__context}},Ct=j;Ct.METRICS_STRING="|\xC9q\xC5";Ct.BASELINE_SYMBOL="M";Ct.BASELINE_MULTIPLIER=1.4;Ct.HEIGHT_MULTIPLIER=2;Ct.graphemeSegmenter=(()=>{if(typeof Intl?.Segmenter=="function"){let e=new Intl.Segmenter;return t=>[...e.segment(t)].map(r=>r.segment)}return e=>[...e]})();Ct.experimentalLetterSpacing=!1;Ct._fonts={};Ct._newlines=[10,13];Ct._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var p_=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],An=class{constructor(e){this.styleID=0,this.reset(),Dl(this,e,e)}clone(){let e={};return Dl(e,this,An.defaultStyle),new An(e)}reset(){Dl(this,An.defaultStyle,An.defaultStyle)}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(e){let t=Bl(e);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)}get fill(){return this._fill}set fill(e){let t=Bl(e);this._fill!==t&&(this._fill=t,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(e){m_(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.styleID++)}get stroke(){return this._stroke}set stroke(e){let t=Bl(e);this._stroke!==t&&(this._stroke=t,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)}toFontString(){let e=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize,t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(let r=t.length-1;r>=0;r--){let i=t[r].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&!p_.includes(i)&&(i=`"${i}"`),t[r]=i}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${e} ${t.join(",")}`}},de=An;de.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:jr.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};function Bl(e){let t=tt.shared;return Array.isArray(e)?e.map(r=>t.setValue(r).toHex()):t.setValue(e).toHex()}function m_(e,t){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}function Dl(e,t,r){for(let i in r)Array.isArray(t[i])?e[i]=t[i].slice():e[i]=t[i]}var g_={texture:!0,children:!1,baseTexture:!0},Ol=class extends be{constructor(e,t,r){let i=!1;r||(r=w.ADAPTER.createCanvas(),i=!0),r.width=3,r.height=3;let s=H.from(r);s.orig=new $,s.trim=new $,super(s),this._ownCanvas=i,this.canvas=r,this.context=r.getContext("2d",{willReadFrequently:!0}),this._resolution=Ol.defaultResolution??w.RESOLUTION,this._autoResolution=Ol.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=e,this.style=t,this.localStyleID=-1}static get experimentalLetterSpacing(){return Ct.experimentalLetterSpacing}static set experimentalLetterSpacing(e){O.deprecation("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),Ct.experimentalLetterSpacing=e}updateText(e){let t=this._style;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&e)return;this._font=this._style.toFontString();let r=this.context,i=Ct.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),s=i.width,n=i.height,o=i.lines,a=i.lineHeight,h=i.lineWidths,l=i.maxLineWidth,c=i.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,s)+t.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,n)+t.padding*2)*this._resolution),r.scale(this._resolution,this._resolution),r.clearRect(0,0,this.canvas.width,this.canvas.height),r.font=this._font,r.lineWidth=t.strokeThickness,r.textBaseline=t.textBaseline,r.lineJoin=t.lineJoin,r.miterLimit=t.miterLimit;let u,d,f=t.dropShadow?2:1;for(let p=0;p<f;++p){let g=t.dropShadow&&p===0,_=g?Math.ceil(Math.max(1,n)+t.padding*2):0,y=_*this._resolution;if(g){r.fillStyle="black",r.strokeStyle="black";let x=t.dropShadowColor,v=t.dropShadowBlur*this._resolution,N=t.dropShadowDistance*this._resolution;r.shadowColor=tt.shared.setValue(x).setAlpha(t.dropShadowAlpha).toRgbaString(),r.shadowBlur=v,r.shadowOffsetX=Math.cos(t.dropShadowAngle)*N,r.shadowOffsetY=Math.sin(t.dropShadowAngle)*N+y}else r.fillStyle=this._generateFillStyle(t,o,i),r.strokeStyle=t.stroke,r.shadowColor="black",r.shadowBlur=0,r.shadowOffsetX=0,r.shadowOffsetY=0;let T=(a-c.fontSize)/2;a-c.fontSize<0&&(T=0);for(let x=0;x<o.length;x++)u=t.strokeThickness/2,d=t.strokeThickness/2+x*a+c.ascent+T,t.align==="right"?u+=l-h[x]:t.align==="center"&&(u+=(l-h[x])/2),t.stroke&&t.strokeThickness&&this.drawLetterSpacing(o[x],u+t.padding,d+t.padding-_,!0),t.fill&&this.drawLetterSpacing(o[x],u+t.padding,d+t.padding-_)}this.updateTexture()}drawLetterSpacing(e,t,r,i=!1){let n=this._style.letterSpacing,o=!1;if(Ct.experimentalLetterSpacingSupported&&(Ct.experimentalLetterSpacing?(this.context.letterSpacing=`${n}px`,this.context.textLetterSpacing=`${n}px`,o=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),n===0||o){i?this.context.strokeText(e,t,r):this.context.fillText(e,t,r);return}let a=t,h=Ct.graphemeSegmenter(e),l=this.context.measureText(e).width,c=0;for(let u=0;u<h.length;++u){let d=h[u];i?this.context.strokeText(d,a,r):this.context.fillText(d,a,r);let f="";for(let p=u+1;p<h.length;++p)f+=h[p];c=this.context.measureText(f).width,a+=l-c+n,l=c}}updateTexture(){let e=this.canvas;if(this._style.trim){let n=O.trimCanvas(e);n.data&&(e.width=n.width,e.height=n.height,this.context.putImageData(n.data,0,0))}let t=this._texture,r=this._style,i=r.trim?0:r.padding,s=t.baseTexture;t.trim.width=t._frame.width=e.width/this._resolution,t.trim.height=t._frame.height=e.height/this._resolution,t.trim.x=-i,t.trim.y=-i,t.orig.width=t._frame.width-i*2,t.orig.height=t._frame.height-i*2,this._onTextureUpdate(),s.setRealSize(e.width,e.height,this._resolution),t.updateUvs(),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(e,t){return this.updateText(!0),this._textureID===-1&&(e=!1),super.getBounds(e,t)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds.call(this,e)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(e,t,r){let i=e.fill;if(Array.isArray(i)){if(i.length===1)return i[0]}else return i;let s,n=e.dropShadow?e.dropShadowDistance:0,o=e.padding||0,a=this.canvas.width/this._resolution-n-o*2,h=this.canvas.height/this._resolution-n-o*2,l=i.slice(),c=e.fillGradientStops.slice();if(!c.length){let u=l.length+1;for(let d=1;d<u;++d)c.push(d/u)}if(l.unshift(i[0]),c.unshift(0),l.push(i[i.length-1]),c.push(1),e.fillGradientType===jr.LINEAR_VERTICAL){s=this.context.createLinearGradient(a/2,o,a/2,h+o);let u=r.fontProperties.fontSize+e.strokeThickness;for(let d=0;d<t.length;d++){let f=r.lineHeight*(d-1)+u,p=r.lineHeight*d,g=p;d>0&&f>p&&(g=(p+f)/2);let _=p+u,y=r.lineHeight*(d+1),T=_;d+1<t.length&&y<_&&(T=(_+y)/2);let x=(T-g)/h;for(let v=0;v<l.length;v++){let N=0;typeof c[v]=="number"?N=c[v]:N=v/l.length;let k=Math.min(1,Math.max(0,g/h+N*x));k=Number(k.toFixed(5)),s.addColorStop(k,l[v])}}}else{s=this.context.createLinearGradient(o,h/2,a+o,h/2);let u=l.length+1,d=1;for(let f=0;f<l.length;f++){let p;typeof c[f]=="number"?p=c[f]:p=d/u,s.addColorStop(p,l[f]),d++}}return s}destroy(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},g_,e),super.destroy(e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this.updateText(!0);let t=O.sign(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this.updateText(!0);let t=O.sign(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}get style(){return this._style}set style(e){e=e||{},e instanceof de?this._style=e:this._style=new de(e),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}},Pn=Ol;Pn.defaultAutoResolution=!0;var In=class{constructor(t){this.maxItemsPerFrame=t,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}};function x_(e,t){let r=!1;if(e?._textures?.length){for(let i=0;i<e._textures.length;i++)if(e._textures[i]instanceof H){let s=e._textures[i].baseTexture;t.includes(s)||(t.push(s),r=!0)}}return r}function __(e,t){if(e.baseTexture instanceof W){let r=e.baseTexture;return t.includes(r)||t.push(r),!0}return!1}function y_(e,t){if(e._texture&&e._texture instanceof H){let r=e._texture.baseTexture;return t.includes(r)||t.push(r),!0}return!1}function v_(e,t){return t instanceof Pn?(t.updateText(!0),!0):!1}function b_(e,t){if(t instanceof de){let r=t.toFontString();return Ct.measureFont(r),!0}return!1}function T_(e,t){if(e instanceof Pn){t.includes(e.style)||t.push(e.style),t.includes(e)||t.push(e);let r=e._texture.baseTexture;return t.includes(r)||t.push(r),!0}return!1}function w_(e,t){return e instanceof de?(t.includes(e)||t.push(e),!0):!1}var vf=class{constructor(e){this.limiter=new In(vf.uploadsPerFrame),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(T_),this.registerFindHook(w_),this.registerFindHook(x_),this.registerFindHook(__),this.registerFindHook(y_),this.registerUploadHook(v_),this.registerUploadHook(b_)}upload(e){return new Promise(t=>{e&&this.add(e),this.queue.length?(this.completes.push(t),this.ticking||(this.ticking=!0,bt.system.addOnce(this.tick,this,Ie.UTILITY))):t()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){let e=this.queue[0],t=!1;if(e&&!e._destroyed){for(let r=0,i=this.uploadHooks.length;r<i;r++)if(this.uploadHooks[r](this.uploadHookHelper,e)){this.queue.shift(),t=!0;break}}t||this.queue.shift()}if(this.queue.length)bt.system.addOnce(this.tick,this,Ie.UTILITY);else{this.ticking=!1;let e=this.completes.slice(0);this.completes.length=0;for(let t=0,r=e.length;t<r;t++)e[t]()}}registerFindHook(e){return e&&this.addHooks.push(e),this}registerUploadHook(e){return e&&this.uploadHooks.push(e),this}add(e){for(let t=0,r=this.addHooks.length;t<r&&!this.addHooks[t](e,this.queue);t++);if(e instanceof St)for(let t=e.children.length-1;t>=0;t--)this.add(e.children[t]);return this}destroy(){this.ticking&&bt.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}},wi=vf;wi.uploadsPerFrame=4;Object.defineProperties(w,{UPLOADS_PER_FRAME:{get(){return wi.uploadsPerFrame},set(e){O.deprecation("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),wi.uploadsPerFrame=e}}});function bf(e,t){return t instanceof W?(t._glTextures[e.CONTEXT_UID]||e.texture.bind(t),!0):!1}function E_(e,t){if(!(t instanceof V))return!1;let{geometry:r}=t;t.finishPoly(),r.updateBatches();let{batches:i}=r;for(let s=0;s<i.length;s++){let{texture:n}=i[s].style;n&&bf(e,n.baseTexture)}return r.batchable||e.geometry.bind(r,t._resolveDirectShader(e)),!0}function S_(e,t){return e instanceof V?(t.push(e),!0):!1}var Rn=class extends wi{constructor(t){super(t),this.uploadHookHelper=this.renderer,this.registerFindHook(S_),this.registerUploadHook(bf),this.registerUploadHook(E_)}};Rn.extension={name:"prepare",type:S.RendererSystem};P.add(Rn);var u3=new Q;var Tf=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`;var wf=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`;var Ef=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`;var Fl=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`;var Sf=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;var ma=new st,Cn=class extends ke{constructor(t){super(t),t.runners.contextChange.add(this),this.quad=new fi,this.state=Nt.for2d()}contextChange(){let t=this.renderer,r={globals:t.globalUniforms};this.simpleShader=Gt.from(Fl,Sf,r),this.shader=t.context.webGLVersion>1?Gt.from(wf,Tf,r):Gt.from(Fl,Ef,r)}render(t){let r=this.renderer,i=this.quad,s=i.vertices;s[0]=s[6]=t._width*-t.anchor.x,s[1]=s[3]=t._height*-t.anchor.y,s[2]=s[4]=t._width*(1-t.anchor.x),s[5]=s[7]=t._height*(1-t.anchor.y);let n=t.uvRespectAnchor?t.anchor.x:0,o=t.uvRespectAnchor?t.anchor.y:0;s=i.uvs,s[0]=s[6]=-n,s[1]=s[3]=-o,s[2]=s[4]=1-n,s[5]=s[7]=1-o,i.invalidate();let a=t._texture,h=a.baseTexture,l=h.alphaMode>0,c=t.tileTransform.localTransform,u=t.uvMatrix,d=h.isPowerOfTwo&&a.frame.width===h.width&&a.frame.height===h.height;d&&(h._glTextures[r.CONTEXT_UID]?d=h.wrapMode!==Ee.CLAMP:h.wrapMode===Ee.CLAMP&&(h.wrapMode=Ee.REPEAT));let f=d?this.simpleShader:this.shader,p=a.width,g=a.height,_=t._width,y=t._height;ma.set(c.a*p/_,c.b*p/y,c.c*g/_,c.d*g/y,c.tx/_,c.ty/y),ma.invert(),d?ma.prepend(u.mapCoord):(f.uniforms.uMapCoord=u.mapCoord.toArray(!0),f.uniforms.uClampFrame=u.uClampFrame,f.uniforms.uClampOffset=u.uClampOffset),f.uniforms.uTransform=ma.toArray(!0),f.uniforms.uColor=tt.shared.setValue(t.tint).premultiply(t.worldAlpha,l).toArray(f.uniforms.uColor),f.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),f.uniforms.uSampler=a,r.shader.bind(f),r.geometry.bind(i),this.state.blendMode=O.correctBlendMode(t.blendMode,l),r.state.set(this.state),r.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}};Cn.extension={name:"tilingSprite",type:S.RendererPlugin};P.add(Cn);var Mn=class{constructor(e,t,r=null){this.linkedSheets=[],this._texture=e instanceof H?e:null,this.baseTexture=e instanceof W?e:this._texture.baseTexture,this.textures={},this.animations={},this.data=t;let i=this.baseTexture.resource;this.resolution=this._updateResolution(r||(i?i.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(e=null){let{scale:t}=this.data.meta,r=O.getResolutionOfUrl(e,null);return r===null&&(r=parseFloat(t??"1")),r!==1&&this.baseTexture.setResolution(r),r}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=Mn.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let t=e,r=Mn.BATCH_SIZE;for(;t-e<r&&t<this._frameKeys.length;){let i=this._frameKeys[t],s=this._frames[i],n=s.frame;if(n){let o=null,a=null,h=s.trimmed!==!1&&s.sourceSize?s.sourceSize:s.frame,l=new $(0,0,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution);s.rotated?o=new $(Math.floor(n.x)/this.resolution,Math.floor(n.y)/this.resolution,Math.floor(n.h)/this.resolution,Math.floor(n.w)/this.resolution):o=new $(Math.floor(n.x)/this.resolution,Math.floor(n.y)/this.resolution,Math.floor(n.w)/this.resolution,Math.floor(n.h)/this.resolution),s.trimmed!==!1&&s.spriteSourceSize&&(a=new $(Math.floor(s.spriteSourceSize.x)/this.resolution,Math.floor(s.spriteSourceSize.y)/this.resolution,Math.floor(n.w)/this.resolution,Math.floor(n.h)/this.resolution)),this.textures[i]=new H(this.baseTexture,o,l,a,s.rotated?2:0,s.anchor,s.borders),H.addToCache(this.textures[i],i)}t++}}_processAnimations(){let e=this.data.animations||{};for(let t in e){this.animations[t]=[];for(let r=0;r<e[t].length;r++){let i=e[t][r];this.animations[t].push(this.textures[i])}}}_parseComplete(){let e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*Mn.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*Mn.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){for(let t in this.textures)this.textures[t].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&(this._texture?.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}},Bn=Mn;Bn.BATCH_SIZE=1e3;var A_=["jpg","png","jpeg","avif","webp"];function Af(e,t,r){let i={};if(e.forEach(s=>{i[s]=t}),Object.keys(t.textures).forEach(s=>{i[s]=t.textures[s]}),!r){let s=O.path.dirname(e[0]);t.linkedSheets.forEach((n,o)=>{let a=Af([`${s}/${t.data.meta.related_multi_packs[o]}`],n,!0);Object.assign(i,a)})}return i}var Pf={extension:S.Asset,cache:{test:e=>e instanceof Bn,getCacheableAssets:(e,t)=>Af(e,t,!1)},resolver:{test:e=>{let r=e.split("?")[0].split("."),i=r.pop(),s=r.pop();return i==="json"&&A_.includes(s)},parse:e=>{let t=e.split(".");return{resolution:parseFloat(w.RETINA_PREFIX.exec(e)?.[1]??"1"),format:t[t.length-2],src:e}}},loader:{name:"spritesheetLoader",extension:{type:S.LoadParser,priority:Rt.Normal},async testParse(e,t){return O.path.extname(t.src).toLowerCase()===".json"&&!!e.frames},async parse(e,t,r){let i=O.path.dirname(t.src);i&&i.lastIndexOf("/")!==i.length-1&&(i+="/");let s=i+e.meta.image;s=yi(s,t.src);let o=(await r.load([s]))[s],a=new Bn(o.baseTexture,e,t.src);await a.parse();let h=e?.meta?.related_multi_packs;if(Array.isArray(h)){let l=[];for(let u of h){if(typeof u!="string")continue;let d=i+u;t.data?.ignoreMultiPack||(d=yi(d,t.src),l.push(r.load({src:d,data:{ignoreMultiPack:!0}})))}let c=await Promise.all(l);a.linkedSheets=c,c.forEach(u=>{u.linkedSheets=[a].concat(a.linkedSheets.filter(d=>d!==u))})}return a},unload(e){e.destroy(!0)}}};P.add(Pf);var ir=class{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}};var sr=class{static test(t){return typeof t=="string"&&t.startsWith("info face=")}static parse(t){let r=t.match(/^[a-z]+\s+.+$/gm),i={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(let n in r){let o=r[n].match(/^[a-z]+/gm)[0],a=r[n].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),h={};for(let l in a){let c=a[l].split("="),u=c[0],d=c[1].replace(/"/gm,""),f=parseFloat(d),p=isNaN(f)?d:f;h[u]=p}i[o].push(h)}let s=new ir;return i.info.forEach(n=>s.info.push({face:n.face,size:parseInt(n.size,10)})),i.common.forEach(n=>s.common.push({lineHeight:parseInt(n.lineHeight,10)})),i.page.forEach(n=>s.page.push({id:parseInt(n.id,10),file:n.file})),i.char.forEach(n=>s.char.push({id:parseInt(n.id,10),page:parseInt(n.page,10),x:parseInt(n.x,10),y:parseInt(n.y,10),width:parseInt(n.width,10),height:parseInt(n.height,10),xoffset:parseInt(n.xoffset,10),yoffset:parseInt(n.yoffset,10),xadvance:parseInt(n.xadvance,10)})),i.kerning.forEach(n=>s.kerning.push({first:parseInt(n.first,10),second:parseInt(n.second,10),amount:parseInt(n.amount,10)})),i.distanceField.forEach(n=>s.distanceField.push({distanceRange:parseInt(n.distanceRange,10),fieldType:n.fieldType})),s}};var br=class{static test(t){let r=t;return"getElementsByTagName"in r&&r.getElementsByTagName("page").length&&r.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(t){let r=new ir,i=t.getElementsByTagName("info"),s=t.getElementsByTagName("common"),n=t.getElementsByTagName("page"),o=t.getElementsByTagName("char"),a=t.getElementsByTagName("kerning"),h=t.getElementsByTagName("distanceField");for(let l=0;l<i.length;l++)r.info.push({face:i[l].getAttribute("face"),size:parseInt(i[l].getAttribute("size"),10)});for(let l=0;l<s.length;l++)r.common.push({lineHeight:parseInt(s[l].getAttribute("lineHeight"),10)});for(let l=0;l<n.length;l++)r.page.push({id:parseInt(n[l].getAttribute("id"),10)||0,file:n[l].getAttribute("file")});for(let l=0;l<o.length;l++){let c=o[l];r.char.push({id:parseInt(c.getAttribute("id"),10),page:parseInt(c.getAttribute("page"),10)||0,x:parseInt(c.getAttribute("x"),10),y:parseInt(c.getAttribute("y"),10),width:parseInt(c.getAttribute("width"),10),height:parseInt(c.getAttribute("height"),10),xoffset:parseInt(c.getAttribute("xoffset"),10),yoffset:parseInt(c.getAttribute("yoffset"),10),xadvance:parseInt(c.getAttribute("xadvance"),10)})}for(let l=0;l<a.length;l++)r.kerning.push({first:parseInt(a[l].getAttribute("first"),10),second:parseInt(a[l].getAttribute("second"),10),amount:parseInt(a[l].getAttribute("amount"),10)});for(let l=0;l<h.length;l++)r.distanceField.push({fieldType:h[l].getAttribute("fieldType"),distanceRange:parseInt(h[l].getAttribute("distanceRange"),10)});return r}};var Tr=class{static test(t){return typeof t=="string"&&t.includes("<font>")?br.test(w.ADAPTER.parseXML(t)):!1}static parse(t){return br.parse(w.ADAPTER.parseXML(t))}};var Ll=[sr,br,Tr];function Nl(e){for(let t=0;t<Ll.length;t++)if(Ll[t].test(e))return Ll[t];return null}function Ul(e,t,r,i,s,n){let o=r.fill;if(Array.isArray(o)){if(o.length===1)return o[0]}else return o;let a,h=r.dropShadow?r.dropShadowDistance:0,l=r.padding||0,c=e.width/i-h-l*2,u=e.height/i-h-l*2,d=o.slice(),f=r.fillGradientStops.slice();if(!f.length){let p=d.length+1;for(let g=1;g<p;++g)f.push(g/p)}if(d.unshift(o[0]),f.unshift(0),d.push(o[o.length-1]),f.push(1),r.fillGradientType===jr.LINEAR_VERTICAL){a=t.createLinearGradient(c/2,l,c/2,u+l);let p=0,_=(n.fontProperties.fontSize+r.strokeThickness)/u;for(let y=0;y<s.length;y++){let T=n.lineHeight*y;for(let x=0;x<d.length;x++){let v=0;typeof f[x]=="number"?v=f[x]:v=x/d.length;let N=T/u+v*_,k=Math.max(p,N);k=Math.min(k,1),a.addColorStop(k,d[x]),p=k}}}else{a=t.createLinearGradient(l,u/2,c+l,u/2);let p=d.length+1,g=1;for(let _=0;_<d.length;_++){let y;typeof f[_]=="number"?y=f[_]:y=g/p,a.addColorStop(y,d[_]),g++}}return a}function Gl(e,t,r,i,s,n,o){let a=r.text,h=r.fontProperties;t.translate(i,s),t.scale(n,n);let l=o.strokeThickness/2,c=-(o.strokeThickness/2);if(t.font=o.toFontString(),t.lineWidth=o.strokeThickness,t.textBaseline=o.textBaseline,t.lineJoin=o.lineJoin,t.miterLimit=o.miterLimit,t.fillStyle=Ul(e,t,o,n,[a],r),t.strokeStyle=o.stroke,o.dropShadow){let u=o.dropShadowColor,d=o.dropShadowBlur*n,f=o.dropShadowDistance*n;t.shadowColor=tt.shared.setValue(u).setAlpha(o.dropShadowAlpha).toRgbaString(),t.shadowBlur=d,t.shadowOffsetX=Math.cos(o.dropShadowAngle)*f,t.shadowOffsetY=Math.sin(o.dropShadowAngle)*f}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;o.stroke&&o.strokeThickness&&t.strokeText(a,l,c+r.lineHeight-h.descent),o.fill&&t.fillText(a,l,c+r.lineHeight-h.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function Ei(e){return e.codePointAt?e.codePointAt(0):e.charCodeAt(0)}function Dn(e){return Array.from?Array.from(e):e.split("")}function kl(e){typeof e=="string"&&(e=[e]);let t=[];for(let r=0,i=e.length;r<i;r++){let s=e[r];if(Array.isArray(s)){if(s.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${s.length}.`);let n=s[0].charCodeAt(0),o=s[1].charCodeAt(0);if(o<n)throw new Error("[BitmapFont]: Invalid character range.");for(let a=n,h=o;a<=h;a++)t.push(String.fromCharCode(a))}else t.push(...Dn(s))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}var je=class{constructor(e,t,r){let[i]=e.info,[s]=e.common,[n]=e.page,[o]=e.distanceField,a=O.getResolutionOfUrl(n.file),h={};this._ownsTextures=r,this.font=i.face,this.size=i.size,this.lineHeight=s.lineHeight/a,this.chars={},this.pageTextures=h;for(let l=0;l<e.page.length;l++){let{id:c,file:u}=e.page[l];h[c]=t instanceof Array?t[l]:t[u],o?.fieldType&&o.fieldType!=="none"&&(h[c].baseTexture.alphaMode=Bt.NO_PREMULTIPLIED_ALPHA,h[c].baseTexture.mipmap=Kt.OFF)}for(let l=0;l<e.char.length;l++){let{id:c,page:u}=e.char[l],{x:d,y:f,width:p,height:g,xoffset:_,yoffset:y,xadvance:T}=e.char[l];d/=a,f/=a,p/=a,g/=a,_/=a,y/=a,T/=a;let x=new $(d+h[u].frame.x/a,f+h[u].frame.y/a,p,g);this.chars[c]={xOffset:_,yOffset:y,xAdvance:T,kerning:{},texture:new H(h[u].baseTexture,x),page:u}}for(let l=0;l<e.kerning.length;l++){let{first:c,second:u,amount:d}=e.kerning[l];c/=a,u/=a,d/=a,this.chars[u]&&(this.chars[u].kerning[c]=d)}this.distanceFieldRange=o?.distanceRange,this.distanceFieldType=o?.fieldType?.toLowerCase()??"none"}destroy(){for(let e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(let e in this.pageTextures)this._ownsTextures&&this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null}static install(e,t,r){let i;if(e instanceof ir)i=e;else{let n=Nl(e);if(!n)throw new Error("Unrecognized data format for font.");i=n.parse(e)}t instanceof H&&(t=[t]);let s=new je(i,t,r);return je.available[s.font]=s,s}static uninstall(e){let t=je.available[e];if(!t)throw new Error(`No font found named '${e}'`);t.destroy(),delete je.available[e]}static from(e,t,r){if(!e)throw new Error("[BitmapFont] Property `name` is required.");let{chars:i,padding:s,resolution:n,textureWidth:o,textureHeight:a,...h}=Object.assign({},je.defaultOptions,r),l=kl(i),c=t instanceof de?t:new de(t),u=o,d=new ir;d.info[0]={face:c.fontFamily,size:c.fontSize},d.common[0]={lineHeight:c.fontSize};let f=0,p=0,g,_,y,T=0,x=[],v=[];for(let k=0;k<l.length;k++){g||(g=w.ADAPTER.createCanvas(),g.width=o,g.height=a,_=g.getContext("2d"),y=new W(g,{resolution:n,...h}),x.push(y),v.push(new H(y)),d.page.push({id:v.length-1,file:""}));let B=l[k],R=Ct.measureText(B,c,!1,g),U=R.width,C=Math.ceil(R.height),F=Math.ceil((c.fontStyle==="italic"?2:1)*U);if(p>=a-C*n){if(p===0)throw new Error(`[BitmapFont] textureHeight ${a}px is too small (fontFamily: '${c.fontFamily}', fontSize: ${c.fontSize}px, char: '${B}')`);--k,g=null,_=null,y=null,p=0,f=0,T=0;continue}if(T=Math.max(C+R.fontProperties.descent,T),F*n+f>=u){if(f===0)throw new Error(`[BitmapFont] textureWidth ${o}px is too small (fontFamily: '${c.fontFamily}', fontSize: ${c.fontSize}px, char: '${B}')`);--k,p+=T*n,p=Math.ceil(p),f=0,T=0;continue}Gl(g,_,R,f,p,n,c);let K=Ei(R.text);d.char.push({id:K,page:v.length-1,x:f/n,y:p/n,width:F,height:C,xoffset:0,yoffset:0,xadvance:U-(c.dropShadow?c.dropShadowDistance:0)-(c.stroke?c.strokeThickness:0)}),f+=(F+2*s)*n,f=Math.ceil(f)}for(let k=0,B=l.length;k<B;k++){let R=l[k];for(let U=0;U<B;U++){let C=l[U],F=_.measureText(R).width,K=_.measureText(C).width,I=_.measureText(R+C).width-(F+K);I&&d.kerning.push({first:Ei(R),second:Ei(C),amount:I})}}let N=new je(d,v,!0);return je.available[e]!==void 0&&je.uninstall(e),je.available[e]=N,N}},Jt=je;Jt.ALPHA=[["a","z"],["A","Z"]," "];Jt.NUMERIC=[["0","9"]];Jt.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "];Jt.ASCII=[[" ","~"]];Jt.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:je.ALPHANUMERIC};Jt.available={};var If=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`;var Rf=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;var Cf=[],Mf=[],Bf=[],Df=class extends St{constructor(e,t={}){super();let{align:r,tint:i,maxWidth:s,letterSpacing:n,fontName:o,fontSize:a}=Object.assign({},Df.styleDefaults,t);if(!Jt.available[o])throw new Error(`Missing BitmapFont "${o}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=r,this._tintColor=new tt(i),this._font=void 0,this._fontName=o,this._fontSize=a,this.text=e,this._maxWidth=s,this._maxLineHeight=0,this._letterSpacing=n,this._anchor=new _e(()=>{this.dirty=!0},this,0,0),this._roundPixels=w.ROUND_PIXELS,this.dirty=!0,this._resolution=w.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){let e=Jt.available[this._fontName],t=this.fontSize,r=t/e.size,i=new Q,s=[],n=[],o=[],a=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",h=Dn(a),l=this._maxWidth*e.size/t,c=e.distanceFieldType==="none"?Cf:Mf,u=null,d=0,f=0,p=0,g=-1,_=0,y=0,T=0,x=0;for(let C=0;C<h.length;C++){let F=h[C],K=Ei(F);if(/(?:\s)/.test(F)&&(g=C,_=d,x++),F==="\r"||F===`
`){n.push(d),o.push(-1),f=Math.max(f,d),++p,++y,i.x=0,i.y+=e.lineHeight,u=null,x=0;continue}let A=e.chars[K];if(!A)continue;u&&A.kerning[u]&&(i.x+=A.kerning[u]);let I=Bf.pop()||{texture:H.EMPTY,line:0,charCode:0,prevSpaces:0,position:new Q};I.texture=A.texture,I.line=p,I.charCode=K,I.position.x=Math.round(i.x+A.xOffset+this._letterSpacing/2),I.position.y=Math.round(i.y+A.yOffset),I.prevSpaces=x,s.push(I),d=I.position.x+Math.max(A.xAdvance-A.xOffset,A.texture.orig.width),i.x+=A.xAdvance+this._letterSpacing,T=Math.max(T,A.yOffset+A.texture.height),u=K,g!==-1&&l>0&&i.x>l&&(++y,O.removeItems(s,1+g-y,1+C-g),C=g,g=-1,n.push(_),o.push(s.length>0?s[s.length-1].prevSpaces:0),f=Math.max(f,_),p++,i.x=0,i.y+=e.lineHeight,u=null,x=0)}let v=h[h.length-1];v!=="\r"&&v!==`
`&&(/(?:\s)/.test(v)&&(d=_),n.push(d),f=Math.max(f,d),o.push(-1));let N=[];for(let C=0;C<=p;C++){let F=0;this._align==="right"?F=f-n[C]:this._align==="center"?F=(f-n[C])/2:this._align==="justify"&&(F=o[C]<0?0:(f-n[C])/o[C]),N.push(F)}let k=s.length,B={},R=[],U=this._activePagesMeshData;c.push(...U);for(let C=0;C<k;C++){let F=s[C].texture,K=F.baseTexture.uid;if(!B[K]){let A=c.pop();if(!A){let it=new $r,Y,et;e.distanceFieldType==="none"?(Y=new vr(H.EMPTY),et=q.NORMAL):(Y=new vr(H.EMPTY,{program:Wt.from(Rf,If),uniforms:{uFWidth:0}}),et=q.NORMAL_NPM);let G=new Wr(it,Y);G.blendMode=et,A={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:G,vertices:null,uvs:null,indices:null}}A.index=0,A.indexCount=0,A.vertexCount=0,A.uvsCount=0,A.total=0;let{_textureCache:I}=this;I[K]=I[K]||new H(F.baseTexture),A.mesh.texture=I[K],A.mesh.tint=this._tintColor.value,R.push(A),B[K]=A}B[K].total++}for(let C=0;C<U.length;C++)R.includes(U[C])||this.removeChild(U[C].mesh);for(let C=0;C<R.length;C++)R[C].mesh.parent!==this&&this.addChild(R[C].mesh);this._activePagesMeshData=R;for(let C in B){let F=B[C],K=F.total;if(!(F.indices?.length>6*K)||F.vertices.length<Wr.BATCHABLE_SIZE*2)F.vertices=new Float32Array(4*2*K),F.uvs=new Float32Array(4*2*K),F.indices=new Uint16Array(6*K);else{let A=F.total,I=F.vertices;for(let it=A*4*2;it<I.length;it++)I[it]=0}F.mesh.size=6*K}for(let C=0;C<k;C++){let F=s[C],K=F.position.x+N[F.line]*(this._align==="justify"?F.prevSpaces:1);this._roundPixels&&(K=Math.round(K));let A=K*r,I=F.position.y*r,it=F.texture,Y=B[it.baseTexture.uid],et=it.frame,G=it._uvs,m=Y.index++;Y.indices[m*6+0]=0+m*4,Y.indices[m*6+1]=1+m*4,Y.indices[m*6+2]=2+m*4,Y.indices[m*6+3]=0+m*4,Y.indices[m*6+4]=2+m*4,Y.indices[m*6+5]=3+m*4,Y.vertices[m*8+0]=A,Y.vertices[m*8+1]=I,Y.vertices[m*8+2]=A+et.width*r,Y.vertices[m*8+3]=I,Y.vertices[m*8+4]=A+et.width*r,Y.vertices[m*8+5]=I+et.height*r,Y.vertices[m*8+6]=A,Y.vertices[m*8+7]=I+et.height*r,Y.uvs[m*8+0]=G.x0,Y.uvs[m*8+1]=G.y0,Y.uvs[m*8+2]=G.x1,Y.uvs[m*8+3]=G.y1,Y.uvs[m*8+4]=G.x2,Y.uvs[m*8+5]=G.y2,Y.uvs[m*8+6]=G.x3,Y.uvs[m*8+7]=G.y3}this._textWidth=f*r,this._textHeight=(i.y+e.lineHeight)*r;for(let C in B){let F=B[C];if(this.anchor.x!==0||this.anchor.y!==0){let it=0,Y=this._textWidth*this.anchor.x,et=this._textHeight*this.anchor.y;for(let G=0;G<F.total;G++)F.vertices[it++]-=Y,F.vertices[it++]-=et,F.vertices[it++]-=Y,F.vertices[it++]-=et,F.vertices[it++]-=Y,F.vertices[it++]-=et,F.vertices[it++]-=Y,F.vertices[it++]-=et}this._maxLineHeight=T*r;let K=F.mesh.geometry.getBuffer("aVertexPosition"),A=F.mesh.geometry.getBuffer("aTextureCoord"),I=F.mesh.geometry.getIndex();K.data=F.vertices,A.data=F.uvs,I.data=F.indices,K.update(),A.update(),I.update()}for(let C=0;C<s.length;C++)Bf.push(s[C]);this._font=e,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);let{distanceFieldRange:t,distanceFieldType:r,size:i}=Jt.available[this._fontName];if(r!=="none"){let{a:s,b:n,c:o,d:a}=this.worldTransform,h=Math.sqrt(s*s+n*n),l=Math.sqrt(o*o+a*a),c=(Math.abs(h)+Math.abs(l))/2,u=this.fontSize/i,d=e._view.resolution;for(let f of this._activePagesMeshData)f.mesh.shader.uniforms.uFWidth=c*t*u*d}super._render(e)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){let e=Jt.available[this._fontName];if(!e)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==e&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(e){if(this.tint!==e){this._tintColor.setValue(e);for(let t=0;t<this._activePagesMeshData.length;t++)this._activePagesMeshData[t].mesh.tint=e}}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.dirty=!0)}get fontName(){return this._fontName}set fontName(e){if(!Jt.available[e])throw new Error(`Missing BitmapFont "${e}"`);this._fontName!==e&&(this._fontName=e,this.dirty=!0)}get fontSize(){return this._fontSize??Jt.available[this._fontName].size}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}destroy(e){let{_textureCache:t}=this,i=Jt.available[this._fontName].distanceFieldType==="none"?Cf:Mf;i.push(...this._activePagesMeshData);for(let s of this._activePagesMeshData)this.removeChild(s.mesh);this._activePagesMeshData=[],i.filter(s=>t[s.mesh.texture.baseTexture.uid]).forEach(s=>{s.mesh.texture=H.EMPTY});for(let s in t)t[s].destroy(),delete t[s];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(e)}},Of=Df;Of.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};var P_=[".xml",".fnt"],Ff={extension:{type:S.LoadParser,priority:Rt.Normal},name:"loadBitmapFont",test(e){return P_.includes(O.path.extname(e).toLowerCase())},async testParse(e){return sr.test(e)||Tr.test(e)},async parse(e,t,r){let i=sr.test(e)?sr.parse(e):Tr.parse(e),{src:s}=t,{page:n}=i,o=[];for(let l=0;l<n.length;++l){let c=n[l].file,u=O.path.join(O.path.dirname(s),c);u=yi(u,s),o.push(u)}let a=await r.load(o),h=o.map(l=>a[l]);return Jt.install(i,h,!0)},async load(e,t){return(await w.ADAPTER.fetch(e)).text()},unload(e){e.destroy()}};P.add(Ff);var bs=class extends de{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(e){return new bs(Object.keys(bs.defaultOptions).reduce((t,r)=>({...t,[r]:e[r]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(e=>{URL.revokeObjectURL(e.src),e.refs--,e.refs===0&&(e.fontFace&&document.fonts.delete(e.fontFace),delete bs.availableFonts[e.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(e,t={}){let{availableFonts:r}=bs;if(r[e]){let i=r[e];return this._fonts.push(i),i.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return w.ADAPTER.fetch(e).then(i=>i.blob()).then(async i=>new Promise((s,n)=>{let o=URL.createObjectURL(i),a=new FileReader;a.onload=()=>s([o,a.result]),a.onerror=n,a.readAsDataURL(i)})).then(async([i,s])=>{let n=Object.assign({family:O.path.basename(e,O.path.extname(e)),weight:"normal",style:"normal",src:i,dataSrc:s,refs:1,originalUrl:e,fontFace:null},t);r[e]=n,this._fonts.push(n),this.styleID++;let o=new FontFace(n.family,`url(${n.src})`,{weight:n.weight,style:n.style});n.fontFace=o,await o.load(),document.fonts.add(o),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...e){let t=e.filter(r=>!this._overrides.includes(r));t.length>0&&(this._overrides.push(...t),this.styleID++)}removeOverride(...e){let t=e.filter(r=>this._overrides.includes(r));t.length>0&&(this._overrides=this._overrides.filter(r=>!t.includes(r)),this.styleID++)}toCSS(e){return[`transform: scale(${e})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((e,t)=>`${e}
            @font-face {
                font-family: "${t.family}";
                src: url('${t.dataSrc}');
                font-weight: ${t.weight};
                font-style: ${t.style}; 
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(e){this._stylesheet!==e&&(this._stylesheet=e,this.styleID++)}normalizeColor(e){return Array.isArray(e)&&(e=O.rgb2hex(e)),typeof e=="number"?O.hex2string(e):e}dropShadowToCSS(){let e=this.normalizeColor(this.dropShadowColor),t=this.dropShadowAlpha,r=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),i=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);e.startsWith("#")&&t<1&&(e+=(t*255|0).toString(16).padStart(2,"0"));let s=`${r}px ${i}px`;return this.dropShadowBlur>0?`text-shadow: ${s} ${this.dropShadowBlur}px ${e}`:`text-shadow: ${s} ${e}`}reset(){Object.assign(this,bs.defaultOptions)}onBeforeDraw(){let{fontsDirty:e}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&e?new Promise(t=>setTimeout(t,100)):Promise.resolve()}get isSafari(){let{userAgent:e}=w.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(e)}set fillGradientStops(e){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(e){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(e){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(e){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(e){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(e){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(e){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}},Si=bs;Si.availableFonts={};Si.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};var Ts=class extends be{constructor(e="",t={}){super(H.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this._loading=!1,this.localStyleID=-1,this.dirty=!1,this.ownsStyle=!1;let r=new Image,i=H.from(r,{scaleMode:w.SCALE_MODE,resourceOptions:{autoLoad:!1}});i.orig=new $,i.trim=new $,this.texture=i;let s="http://www.w3.org/2000/svg",n="http://www.w3.org/1999/xhtml",o=document.createElementNS(s,"svg"),a=document.createElementNS(s,"foreignObject"),h=document.createElementNS(n,"div"),l=document.createElementNS(n,"style");a.setAttribute("width","10000"),a.setAttribute("height","10000"),a.style.overflow="hidden",o.appendChild(a),this.maxWidth=Ts.defaultMaxWidth,this.maxHeight=Ts.defaultMaxHeight,this._domElement=h,this._styleElement=l,this._svgRoot=o,this._foreignObject=a,this._foreignObject.appendChild(l),this._foreignObject.appendChild(h),this._image=r,this._loadImage=new Image,this._autoResolution=Ts.defaultAutoResolution,this._resolution=Ts.defaultResolution??w.RESOLUTION,this.text=e,this.style=t}measureText(e){let{text:t,style:r,resolution:i}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},e);Object.assign(this._domElement,{innerHTML:t,style:r.toCSS(i)}),this._styleElement.textContent=r.toGlobalCSS(),document.body.appendChild(this._svgRoot);let s=this._domElement.getBoundingClientRect();this._svgRoot.remove();let n=Math.min(this.maxWidth,Math.ceil(s.width)),o=Math.min(this.maxHeight,Math.ceil(s.height));return this._svgRoot.setAttribute("width",n.toString()),this._svgRoot.setAttribute("height",o.toString()),t!==this._text&&(this._domElement.innerHTML=this._text),r!==this._style&&(Object.assign(this._domElement,{style:this._style?.toCSS(i)}),this._styleElement.textContent=this._style?.toGlobalCSS()),{width:n+r.padding*2,height:o+r.padding*2}}async updateText(e=!0){let{style:t,_image:r,_loadImage:i}=this;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&e)return;let{width:s,height:n}=this.measureText();r.width=i.width=Math.ceil(Math.max(1,s)),r.height=i.height=Math.ceil(Math.max(1,n)),this._loading||(this._loading=!0,await new Promise(o=>{i.onload=async()=>{await t.onBeforeDraw(),this._loading=!1,r.src=i.src,i.onload=null,i.src="",this.updateTexture(),o()};let a=new XMLSerializer().serializeToString(this._svgRoot);i.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(a)}`}))}get source(){return this._image}updateTexture(){let{style:e,texture:t,_image:r,resolution:i}=this,{padding:s}=e,{baseTexture:n}=t;t.trim.width=t._frame.width=r.width/i,t.trim.height=t._frame.height=r.height/i,t.trim.x=-s,t.trim.y=-s,t.orig.width=t._frame.width-s*2,t.orig.height=t._frame.height-s*2,this._onTextureUpdate(),n.setRealSize(r.width,r.height,i),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}_renderCanvas(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(e)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds(e)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},Ts.defaultDestroyOptions,e),super.destroy(e);let t=null;this.ownsStyle&&this._style?.cleanFonts(),this._style=t,this._svgRoot?.remove(),this._svgRoot=t,this._domElement?.remove(),this._domElement=t,this._foreignObject?.remove(),this._foreignObject=t,this._styleElement?.remove(),this._styleElement=t,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=t,this._image.src="",this._image=t}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(e){this.updateText(!0);let t=O.sign(this.scale.x)||1;this.scale.x=t*e/this._image.width/this.resolution,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(e){this.updateText(!0);let t=O.sign(this.scale.y)||1;this.scale.y=t*e/this._image.height/this.resolution,this._height=e}get style(){return this._style}set style(e){this._style!==e&&(e=e||{},e instanceof Si?(this.ownsStyle=!1,this._style=e):e instanceof de?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=Si.from(e)):(this.ownsStyle=!0,this._style=new Si(e)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(e){e=String(e===""||e===null||e===void 0?" ":e),e=this.sanitiseText(e),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}sanitiseText(e){return e.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}},On=Ts;On.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0};On.defaultMaxWidth=2024;On.defaultMaxHeight=2024;On.defaultAutoResolution=!0;var Kr=xt(Lf());var Dt=xt(Mt());var Tt=Math.pow,ga=Math.sqrt,Fn=Math.sin,kf=Math.cos,Ln=Math.PI,ya=1.70158,xa=ya*1.525,Hf=ya+1,Xf=2*Ln/3,Vf=2*Ln/4.5,_a=function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},O_={linear:e=>e,easeInQuad:function(e){return e*e},easeOutQuad:function(e){return 1-(1-e)*(1-e)},easeInOutQuad:function(e){return e<.5?2*e*e:1-Tt(-2*e+2,2)/2},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return 1-Tt(1-e,3)},easeInOutCubic:function(e){return e<.5?4*e*e*e:1-Tt(-2*e+2,3)/2},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return 1-Tt(1-e,4)},easeInOutQuart:function(e){return e<.5?8*e*e*e*e:1-Tt(-2*e+2,4)/2},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return 1-Tt(1-e,5)},easeInOutQuint:function(e){return e<.5?16*e*e*e*e*e:1-Tt(-2*e+2,5)/2},easeInSine:function(e){return 1-kf(e*Ln/2)},easeOutSine:function(e){return Fn(e*Ln/2)},easeInOutSine:function(e){return-(kf(Ln*e)-1)/2},easeInExpo:function(e){return e===0?0:Tt(2,10*e-10)},easeOutExpo:function(e){return e===1?1:1-Tt(2,-10*e)},easeInOutExpo:function(e){return e===0?0:e===1?1:e<.5?Tt(2,20*e-10)/2:(2-Tt(2,-20*e+10))/2},easeInCirc:function(e){return 1-ga(1-Tt(e,2))},easeOutCirc:function(e){return ga(1-Tt(e-1,2))},easeInOutCirc:function(e){return e<.5?(1-ga(1-Tt(2*e,2)))/2:(ga(1-Tt(-2*e+2,2))+1)/2},easeInBack:function(e){return Hf*e*e*e-ya*e*e},easeOutBack:function(e){return 1+Hf*Tt(e-1,3)+ya*Tt(e-1,2)},easeInOutBack:function(e){return e<.5?Tt(2*e,2)*((xa+1)*2*e-xa)/2:(Tt(2*e-2,2)*((xa+1)*(e*2-2)+xa)+2)/2},easeInElastic:function(e){return e===0?0:e===1?1:-Tt(2,10*e-10)*Fn((e*10-10.75)*Xf)},easeOutElastic:function(e){return e===0?0:e===1?1:Tt(2,-10*e)*Fn((e*10-.75)*Xf)+1},easeInOutElastic:function(e){return e===0?0:e===1?1:e<.5?-(Tt(2,20*e-10)*Fn((20*e-11.125)*Vf))/2:Tt(2,-20*e+10)*Fn((20*e-11.125)*Vf)/2+1},easeInBounce:function(e){return 1-_a(1-e)},easeOutBounce:_a,easeInOutBounce:function(e){return e<.5?(1-_a(1-2*e))/2:(1+_a(2*e-1))/2}},zf=O_;var Ai=xt(Mt());var Wf=xt(Mt()),Nn=class{constructor(t,r){this.joints=[];t.forEach((i,s)=>{this.joints[s]={model:i,live:r!=null?r[s]:new Wf.Vector(i.clone())}})}get socketIndex(){return 0}get clawIndex(){return this.joints.length-1}updateLiveJoint(t,r){this.joints[t].live.x=r.x,this.joints[t].live.y=r.y,this.joints[t].live.radians=r.radians}getModelJoint(t){return this.joints[t].model.clone()}getLiveJoint(t){return this.joints[t].live.clone()}getAllModelJoints(){return this.joints.map(t=>t.model.clone())}getAllLiveJoints(){return this.joints.map(t=>t.live.clone())}};var va=class{constructor(t,r){this.offsetPosition=r.position,this.maxDistance=Ai.Point.distance(new Ai.Point,this.offsetPosition),this.position=this.calculateStartingVector(t,r.position),this.legs=this.createLegs(r.legs)}get data(){return{position:this.position.clone(),legs:{left:this.legs.left.map(t=>t.getAllLiveJoints()),right:this.legs.right.map(t=>t.getAllLiveJoints())}}}calculateStartingVector(t,r){return new Ai.Vector(r.x+t.x,r.y+t.y,t.radians)}createLegs(t){let r={left:[],right:[]};return t==null||t.left.forEach((i,s)=>{i.splice(1,0,new Ai.Point((i[0].x+i[1].x)*.5,(i[0].y+i[1].y)*.5)),r.left[s]=new Nn(i)}),t==null||t.right.forEach((i,s)=>{i.splice(1,0,new Ai.Point((i[0].x+i[1].x)*.5,(i[0].y+i[1].y)*.5)),r.right[s]=new Nn(i)}),r}};var Qt=xt(Mt()),$f=()=>({activeSide:"left",millisecondsPerStep:250,maxStepPx:16,position:new Qt.Vector,segments:[{position:new Qt.Point,legs:{left:[[new Qt.Point(-9,0),new Qt.Point(-18,-15)],[new Qt.Point(-9,2),new Qt.Point(-20,-2)],[new Qt.Point(-9,4),new Qt.Point(-16,8)]],right:[[new Qt.Point(9,0),new Qt.Point(18,-15)],[new Qt.Point(9,2),new Qt.Point(20,-2)],[new Qt.Point(9,4),new Qt.Point(16,8)]]}}],jointOffset:.25,repulsionPx:0,maxJigglePx:3,maxDistractionPx:24,timingFunction:"easeOutCubic",target:new Qt.Vector});var _t=class{constructor(t){this.stepProgress=1;this.stepMs=0;this.stepTarget=new Dt.Vector;this.listeners={targetReached:[]};var i,s,n,o,a,h,l,c,u;let r=$f();this.activeSide=(i=t==null?void 0:t.activeSide)!=null?i:r.activeSide,this.millisecondsPerStep=(s=t==null?void 0:t.millisecondsPerStep)!=null?s:r.millisecondsPerStep,this.maxStepPx=(n=t==null?void 0:t.maxStepPx)!=null?n:r.maxStepPx,this.jointOffset=(o=t==null?void 0:t.jointOffset)!=null?o:r.jointOffset,this.repulsionPx=(a=t==null?void 0:t.repulsionPx)!=null?a:r.repulsionPx,this.maxJigglePx=(h=t==null?void 0:t.maxJigglePx)!=null?h:r.maxJigglePx,this.maxDistractionPx=(l=t==null?void 0:t.maxDistractionPx)!=null?l:r.maxDistractionPx,this.timingFunction=(c=t==null?void 0:t.timingFunction)!=null?c:r.timingFunction,this.segments=this.createSegments(r,t==null?void 0:t.position,t==null?void 0:t.segments,t==null?void 0:t.stageRect),this.target=(u=t==null?void 0:t.target)!=null?u:r.target,this.current={activeSide:this.activeSide,segments:this.segments.map(d=>d.data),target:this.target.point},this.updateBug({deltaMs:this.millisecondsPerStep})}tick({deltaMs:t=0,stageRect:r}){let i=this.stepMs/this.millisecondsPerStep;if(this.stepProgress=zf[this.timingFunction](i),this.updateBug({deltaMs:t,stageRect:r}),Dt.Point.distance(this.target.point,this.segments[0].position.point)<this.maxStepPx+this.repulsionPx){let s=this.getRender();this.listeners.targetReached.forEach(n=>n(s))}return this.getRender()}on(t,r){this.listeners[t].includes(r)||this.listeners[t].push(r)}off(t,r){let i=this.listeners[t].findIndex(s=>s===r);i!==-1&&this.listeners[t].splice(i,1)}updateTarget(t){this.target.x=t.x,this.target.y=t.y}getRender(){return{activeSide:this.activeSide,segments:this.getSegmentsData(),target:this.target.point}}getSegmentsData(){return this.segments.map(t=>t.data)}createSegments(t,r,i,s){let n=r!=null?r:new Dt.Vector(s!=null?s.x+Math.random()*s.width:0,s!=null?s.y+Math.random()*s.height:0,Math.random()*Math.PI*2);return(i!=null?i:t.segments).map(a=>new va(n,a))}updateBug({deltaMs:t,stageRect:r}){let i=r!=null?{x:r.x+this.repulsionPx,y:r.y+this.repulsionPx,width:r.width-this.repulsionPx*2,height:r.height-this.repulsionPx*2}:r;this.updateAllSegments(i),this.updateStepProgress(t)}updateStepProgress(t){this.stepMs=Math.min(this.millisecondsPerStep,this.stepMs+t),this.stepMs>=this.millisecondsPerStep&&(this.stepMs=0,this.activeSide=this.activeSide==="left"?"right":"left",this.current.segments=this.getSegmentsData(),this.updateTargetRadians())}updateTargetRadians(){this.stepTarget.x=this.target.x+Math.random()*this.maxDistractionPx-this.maxDistractionPx*.5,this.stepTarget.y=this.target.y+Math.random()*this.maxDistractionPx-this.maxDistractionPx*.5;let t=this.current.segments[0].position;this.stepTarget.radians=Math.atan2(this.stepTarget.y-t.y,this.stepTarget.x-t.x)+Math.PI*.5,this.stepTarget.radians=Dt.Angle.normalize(this.stepTarget.radians);let r=Math.PI*.25,i=Dt.Angle.normalize(this.stepTarget.radians)-Dt.Angle.normalize(t.radians);Math.abs(i)>Math.PI&&(i=Dt.Angle.normalize(t.radians)-Dt.Angle.normalize(this.stepTarget.radians));let s=Math.PI*2;if(Math.abs(i)>Math.PI)if(i<0){let n=t.radians+s;i=this.stepTarget.radians-n}else i>0&&(i=this.stepTarget.radians+s-t.radians);i>r?this.stepTarget.radians=t.radians+r:i<-r&&(this.stepTarget.radians=t.radians-r)}updateAllSegments(t){let r;this.segments.forEach((i,s)=>{s===0?this.updateHead(i,this.current.segments[s],t):this.updateSegment(i,this.current.segments[s],r,t),r=i.position})}updateHead(t,r,i){let s=r.position;t.position.radians=Dt.Angle.interpolate(s.radians,this.stepTarget.radians,Math.min(1,this.stepProgress)),t.position.x=s.x+Math.max(-this.maxStepPx,Math.min(this.maxStepPx,this.stepTarget.x-s.x))*this.stepProgress+Math.random()*this.maxJigglePx-this.maxJigglePx*.5,t.position.y=s.y+Math.max(-this.maxStepPx,Math.min(this.maxStepPx,this.stepTarget.y-s.y))*this.stepProgress+Math.random()*this.maxJigglePx-this.maxJigglePx*.5,i!=null&&(t.position.x=Math.max(i.x,Math.min(i.x+i.width,t.position.x)),t.position.y=Math.max(i.y,Math.min(i.y+i.height,t.position.y))),this.updateLegsPerSegment(t,r,i)}updateSegment(t,r,i,s){let n=i.radians+Math.PI*.5,o=new Dt.Vector(i.x+Math.cos(n)*t.maxDistance,i.y+Math.sin(n)*t.maxDistance,i.radians),h=Dt.Point.distance(o.point,t.position.point)*.02,l=Math.atan2(o.y-t.position.y,o.x-t.position.x),c=t.position.x+Math.cos(l)*h,u=t.position.y+Math.sin(l)*h,d=Math.atan2(u-i.y,c-i.x);t.position.x=i.x+Math.cos(d)*t.maxDistance+Math.random()*this.maxJigglePx-this.maxJigglePx*.5,t.position.y=i.y+Math.sin(d)*t.maxDistance+Math.random()*this.maxJigglePx-this.maxJigglePx*.5,t.position.radians=Math.atan2(i.y-t.position.y,i.x-t.position.x)+Math.PI*.5,this.updateLegsPerSegment(t,r,s)}updateLegsPerSegment(t,r,i){["left","right"].forEach(s=>{t.legs[s].forEach((n,o)=>{if(this.updateLeg(t.position,n,r.legs[s][o],n.socketIndex,i),s===this.activeSide&&this.updateLeg(t.position,n,r.legs[s][o],n.clawIndex,i),n.clawIndex>1){let a=n.getLiveJoint(n.socketIndex).point,h=n.getLiveJoint(n.clawIndex).point,l=Math.atan2(a.y-h.y,a.x-h.x)-Math.PI*2,u=Dt.Point.distance(n.getModelJoint(0),n.getModelJoint(2))*this.jointOffset;n.updateLiveJoint(1,new Dt.Vector((a.x+h.x)*.5-Math.cos(l)*u,(a.y+h.y)*.5+Math.sin(l)*u))}})})}updateLeg(t,r,i,s,n){let o=r.getModelJoint(s),a=Dt.Point.distance(t.point,t.point.subtract(o)),h=Math.atan2(o.y,o.x)+t.radians,l=Dt.Angle.interpolate(i[s].radians,h,Math.min(1,this.stepProgress)),c=new Dt.Point(Math.cos(l)*a+t.x,Math.sin(l)*a+t.y);n!=null&&(c.x=Math.max(n.x,Math.min(n.x+n.width,c.x)),c.y=Math.max(n.y,Math.min(n.y+n.height,c.y))),r.updateLiveJoint(s,new Dt.Vector(c,l))}};var lt=xt(Mt());var ip=xt(Mt());var ba=xt(Mt()),Un=0,Gn=0,jf=1,Yf=e=>{let t=!1;Gn>=e&&(Gn=0,Un=0,jf*=-1,t=!0);let r=Math.cos(Un)*Gn,i=Math.sin(Un)*Gn;return Un=ba.Angle.normalize(Un-Math.PI*.05*jf),Gn+=1,{point:new ba.Point(r,i),complete:t}};var Kf=xt(Mt()),kn=0,qf=10,Zf=(e,t)=>{kn===10&&(kn=0);let r=kn*e/10+Math.random()*qf,i=Math.random()*20+qf;return{point:new Kf.Point(r,kn%2===0?i:t-i),complete:++kn===10}};var Qf=xt(Mt()),Hn=0,Jf=10,tp=(e,t)=>{Hn===10&&(Hn=0);let r=Math.random()*20+Jf,i=Hn*t/10+Math.random()*Jf;return{point:new Qf.Point(Hn%2===0?r:e-r,i),complete:++Hn===10}};var ep=xt(Mt()),jl=0,Ta=10,rp=(e,t)=>(jl===10&&(jl=0),{point:new ep.Point(Ta+Math.floor(Math.random()*(e-Ta*2)),Ta+Math.floor(Math.random()*(t-Ta*2))),complete:++jl===10});var yt=class{constructor(t){this.app=t;this.targetColor=8947848;this.targetGfx=new V;this.handleTargetReached=()=>{this.updateTargetPattern()};this.handlePointerDown=t=>{if(this.app.view.getBoundingClientRect!=null){let r=this.app.view.getBoundingClientRect();"clientX"in t&&"clientY"in t&&this.changeTarget(new ip.Point(t.clientX-r.x,t.clientY-r.y))}};this.pattern=this.updatePattern(),t.view.addEventListener!=null&&t.view.addEventListener("pointerdown",this.handlePointerDown)}render(t=0){}changeTarget(t){}destroy(){this.app.view.removeEventListener!=null&&this.app.view.removeEventListener("pointerdown",this.handlePointerDown)}clearGfx(){this.targetGfx.clear()}renderTarget({x:t,y:r}){this.targetGfx.beginFill(this.targetColor),this.targetGfx.drawCircle(t,r,2),this.targetGfx.endFill()}updateTargetPattern(){if(this.pattern==="random"){let{point:t,complete:r}=rp(this.app.view.width,this.app.view.height);this.changeTarget(t),r&&this.updatePattern()}else if(this.pattern==="vertical"){let{point:t,complete:r}=Zf(this.app.view.width,this.app.view.height);this.changeTarget(t),r&&this.updatePattern()}else if(this.pattern==="horizontal"){let{point:t,complete:r}=tp(this.app.view.width,this.app.view.height);this.changeTarget(t),r&&this.updatePattern()}else if(this.pattern==="spiral"){let{point:t,complete:r}=Yf(Math.min(this.app.view.width,this.app.view.height)*.5);t.x+=this.app.view.width/2,t.y+=this.app.view.height/2,this.changeTarget(t),r&&this.updatePattern()}}updatePattern(){let t=Math.floor(Math.random()*4),r=["random","horizontal","vertical","spiral"];return this.pattern=r[t]}};var $t=class{constructor(t,r=0){this.app=t;this.bgColor=r;this.pointerDownHandler=()=>{};this.handlePointerDown=t=>{this.pointerDownHandler(t)}}render(t=this.app){let r=new V;r.beginFill(this.bgColor),r.drawRect(0,0,this.app.view.width,this.app.view.height),r.endFill(),r.eventMode="static",r.on("pointerdown",this.handlePointerDown),this.app=t,this.app.stage.addChild(r)}onPointerDown(t){this.pointerDownHandler=t}};var sp=1127253,wa=10,nr=class extends $t{render(t){super.render(t);let r=wa;for(;r<this.app.view.height;){let i=new V;i.beginFill(sp),i.drawRect(0,r,this.app.view.width,1),this.app.stage.addChild(i),r+=wa}for(r=wa;r<this.app.view.width;){let i=new V;i.beginFill(sp),i.drawRect(r,0,1,this.app.view.height),this.app.stage.addChild(i),r+=wa}}};var Ea=class extends yt{constructor(r){super(r);this.segmentsGfx=new V;this.legsGfx=new V;this.bug=new _t({segments:[{position:new lt.Point,legs:{left:[[new lt.Point(-9,0),new lt.Point(-18,-15)],[new lt.Point(-9,2),new lt.Point(-20,-2)],[new lt.Point(-9,4),new lt.Point(-16,8)]],right:[[new lt.Point(9,0),new lt.Point(18,-15)],[new lt.Point(9,2),new lt.Point(20,-2)],[new lt.Point(9,4),new lt.Point(16,8)]]}},{position:new lt.Point(0,20),legs:{left:[[new lt.Point(-9,2),new lt.Point(-20,-2)]],right:[[new lt.Point(9,2),new lt.Point(20,-2)]]}},{position:new lt.Point(0,20),legs:{left:[[new lt.Point(-9,2),new lt.Point(-20,-2)]],right:[[new lt.Point(9,2),new lt.Point(20,-2)]]}},{position:new lt.Point(0,20),legs:{left:[[new lt.Point(-9,2),new lt.Point(-20,-2)]],right:[[new lt.Point(9,2),new lt.Point(20,-2)]]}},{position:new lt.Point(0,20),legs:{left:[[new lt.Point(-9,2),new lt.Point(-20,-2)]],right:[[new lt.Point(9,2),new lt.Point(20,-2)]]}}],maxDistractionPx:0,maxJigglePx:3,maxStepPx:10,millisecondsPerStep:100,timingFunction:"easeOutSine"}),this.grid=new nr(this.app),this.grid.render(),this.app.stage.addChild(this.targetGfx),this.app.stage.addChild(this.legsGfx),this.app.stage.addChild(this.segmentsGfx),this.updateTargetPattern()}render(r=0){let i=this.bug.tick({deltaMs:r,stageRect:{x:5,y:5,width:this.app.view.width-5,height:this.app.view.height-5}});this.bug.on("targetReached",this.handleTargetReached),this.clearGfx(),this.renderTarget(i.target),this.renderAllSegments(i)}changeTarget(r){super.changeTarget(r),this.bug.updateTarget(r)}destroy(){super.destroy(),this.clearGfx()}clearGfx(){super.clearGfx(),this.segmentsGfx.clear(),this.segmentsGfx.removeChildren(),this.legsGfx.clear(),this.legsGfx.removeChildren()}renderAllSegments(r){for(let i=r.segments.length-1;i>=0;i--)this.renderSegment(r.segments[i],r.activeSide,i)}renderSegment(r,i,s){let n=s===0?14544639:16776960,o=new V;this.segmentsGfx.addChild(o),o.lineStyle({width:1,color:n}),o.drawCircle(0,0,9),o.lineStyle({width:0}),o.beginFill(n),o.moveTo(0,-8),o.lineTo(5,8),o.lineTo(0,2),o.lineTo(-5,8),o.lineTo(0,-8),o.endFill(),o.rotation=r.position.radians,o.position.x=r.position.x,o.position.y=r.position.y,this.renderSegmentLegs(r,i)}renderSegmentLegs(r,i){r.legs.left.forEach(s=>this.renderLeg(s,i==="left")),r.legs.right.forEach(s=>this.renderLeg(s,i==="right"))}renderLeg(r,i){let s=r[0],n=r.length>=2?r[1]:null,o=r.length>=2?r[2]:r[1],a=new V;this.legsGfx.addChild(a),a.lineStyle({width:1,color:14544639}),a.moveTo(s.x,s.y),n!=null&&a.lineTo(n.x,n.y),a.lineTo(o.x,o.y),a.lineStyle({width:0}),a.beginFill(14544639),a.drawCircle(o.x,o.y,i?2:1),a.endFill()}};var Te=xt(Mt());var Sa=class extends yt{constructor(r){super(r);this.segmentsGfx=new V;this.legsGfx=new V;this.targetColor=8952234,this.bug=new _t({stageRect:{x:0,y:0,width:r.view.width,height:r.view.height},segments:[{position:new Te.Point,legs:{left:[[new Te.Point(-5,0),new Te.Point(-68,-55)],[new Te.Point(-5,2),new Te.Point(-80,-2)],[new Te.Point(-5,4),new Te.Point(-66,58)]],right:[[new Te.Point(5,0),new Te.Point(68,-55)],[new Te.Point(5,2),new Te.Point(80,-2)],[new Te.Point(5,4),new Te.Point(66,58)]]}}],millisecondsPerStep:600,maxStepPx:16,maxDistractionPx:72,maxJigglePx:0}),this.grid=new nr(this.app),this.grid.render(),this.app.stage.addChild(this.targetGfx),this.app.stage.addChild(this.legsGfx),this.app.stage.addChild(this.segmentsGfx),this.updateTargetPattern()}render(r=0){let i=this.bug.tick({deltaMs:r,stageRect:{x:5,y:5,width:this.app.view.width-5,height:this.app.view.height-5}});this.bug.on("targetReached",this.handleTargetReached),this.clearGfx(),this.renderTarget(i.target),this.renderSegment(i.segments[0],i.activeSide)}changeTarget(r){super.changeTarget(r),this.bug.updateTarget(r)}destroy(){super.destroy(),this.clearGfx()}clearGfx(){super.clearGfx(),this.segmentsGfx.clear(),this.segmentsGfx.removeChildren(),this.legsGfx.clear(),this.legsGfx.removeChildren()}renderSegment(r,i){let n=new V;this.segmentsGfx.addChild(n),n.lineStyle({width:1,color:14544639}),n.drawCircle(0,0,5),n.lineStyle({width:.5,color:8952234}),n.moveTo(-1,-4),n.bezierCurveTo(-3,-40,-9,-50,-32,-60),n.moveTo(1,-4),n.bezierCurveTo(3,-40,9,-50,32,-60),n.lineStyle({width:0}),n.beginFill(14544639),n.drawCircle(-3,-4,2),n.drawCircle(3,-4,2),n.endFill(),n.rotation=r.position.radians,n.position.x=r.position.x,n.position.y=r.position.y,this.renderSegmentLegs(r,i)}renderSegmentLegs(r,i){r.legs.left.forEach(s=>this.renderLeg(s,i==="left")),r.legs.right.forEach(s=>this.renderLeg(s,i==="right"))}renderLeg(r,i){let s=r[0],n=r.length>=2?r[1]:null,o=r.length>=2?r[2]:r[1],a=new V;this.legsGfx.addChild(a);let h=i?11189196:8952234;a.lineStyle({width:1,color:h}),a.moveTo(s.x,s.y),n!=null?(a.lineTo(n.x,n.y),a.lineStyle({width:0}),a.beginFill(h),a.drawPolygon(n.x-1.5,n.y,n.x+1.5,n.y,o.x,o.y),a.endFill()):(a.lineTo(o.x,o.y),a.lineStyle({width:0}))}};var or=xt(Mt());var Aa=class extends yt{constructor(r){super(r);this.segmentsGfx=new V;this.legsGfx=new V;this.targetColor=8952234,this.bug=new _t({stageRect:{x:0,y:0,width:r.view.width,height:r.view.height},segments:[{position:new or.Point,legs:{left:[[new or.Point(-5,2),new or.Point(-80,-2)]],right:[[new or.Point(5,0),new or.Point(18,-25)],[new or.Point(5,2),new or.Point(28,-2)],[new or.Point(5,4),new or.Point(16,28)]]}}],millisecondsPerStep:400,maxStepPx:16,maxDistractionPx:24,maxJigglePx:1}),this.grid=new nr(this.app),this.grid.render(),this.app.stage.addChild(this.targetGfx),this.app.stage.addChild(this.legsGfx),this.app.stage.addChild(this.segmentsGfx),this.updateTargetPattern()}render(r=0){let i=this.bug.tick({deltaMs:r,stageRect:{x:5,y:5,width:this.app.view.width-5,height:this.app.view.height-5}});this.bug.on("targetReached",this.handleTargetReached),this.clearGfx(),this.renderTarget(i.target),this.renderSegment(i.segments[0],i.activeSide)}changeTarget(r){super.changeTarget(r),this.bug.updateTarget(r)}destroy(){super.destroy(),this.clearGfx()}clearGfx(){super.clearGfx(),this.segmentsGfx.clear(),this.segmentsGfx.removeChildren(),this.legsGfx.clear(),this.legsGfx.removeChildren()}renderSegment(r,i){let n=new V;this.segmentsGfx.addChild(n),n.lineStyle({width:1,color:14544639}),n.drawCircle(0,0,5),n.lineStyle({width:.5,color:8952234}),n.moveTo(-1,-4),n.bezierCurveTo(-3,-24,-18,-42,-48,-48),n.moveTo(1,-4),n.bezierCurveTo(3,-40,9,-60,32,-90),n.lineStyle({width:0}),n.beginFill(14544639),n.drawCircle(-4,-5,3),n.drawCircle(3,-4,2),n.endFill(),n.rotation=r.position.radians,n.position.x=r.position.x,n.position.y=r.position.y,this.renderSegmentLegs(r,i)}renderSegmentLegs(r,i){r.legs.left.forEach(s=>this.renderLeg(s,i==="left")),r.legs.right.forEach(s=>this.renderLeg(s,i==="right"))}renderLeg(r,i){let s=r[0],n=r.length>=2?r[1]:null,o=r.length>=2?r[2]:r[1],a=new V;this.legsGfx.addChild(a);let h=i?11189196:8952234;a.lineStyle({width:1,color:h}),a.moveTo(s.x,s.y),n!=null?(a.lineTo(n.x,n.y),a.lineStyle({width:0}),a.beginFill(h),a.drawPolygon(n.x-1.5,n.y,n.x+1.5,n.y,o.x,o.y),a.endFill()):(a.lineTo(o.x,o.y),a.lineStyle({width:0}))}};var pe=xt(Mt());var Pa=class extends yt{constructor(r){super(r);this.segmentsGfx=new V;this.legsGfx=new V;this.targetColor=8952234,this.bug=new _t({stageRect:{x:0,y:0,width:r.view.width,height:r.view.height},segments:[{position:new pe.Point(0,-12)},{position:new pe.Point(0,10),legs:{left:[[new pe.Point(-5,0),new pe.Point(-22,-29)],[new pe.Point(-5,2),new pe.Point(-28,-2)],[new pe.Point(-5,4),new pe.Point(-21,18)]],right:[[new pe.Point(5,0),new pe.Point(22,-29)],[new pe.Point(5,2),new pe.Point(28,-2)],[new pe.Point(5,4),new pe.Point(21,18)]]}}],millisecondsPerStep:150,maxStepPx:12,maxDistractionPx:24,maxJigglePx:1}),this.grid=new nr(this.app),this.grid.render(),this.app.stage.addChild(this.targetGfx),this.app.stage.addChild(this.legsGfx),this.app.stage.addChild(this.segmentsGfx),this.updateTargetPattern()}render(r=0){let i=this.bug.tick({deltaMs:r,stageRect:{x:5,y:5,width:this.app.view.width-5,height:this.app.view.height-5}});this.bug.on("targetReached",this.handleTargetReached),this.clearGfx(),this.renderTarget(i.target),this.renderAllSegments(i)}changeTarget(r){super.changeTarget(r),this.bug.updateTarget(r)}destroy(){super.destroy(),this.clearGfx()}clearGfx(){super.clearGfx(),this.segmentsGfx.clear(),this.segmentsGfx.removeChildren(),this.legsGfx.clear(),this.legsGfx.removeChildren()}renderAllSegments(r){for(let i=r.segments.length-1;i>=0;i--)i===0?this.renderHead(r.segments[i]):this.renderSegment(r.segments[i],r.activeSide)}renderHead(r){let s=this.renderSegmentBase(r);s.beginFill(14544639),s.drawCircle(0,0,3),s.endFill(),s.lineStyle({width:.5,color:8952234}),s.moveTo(-1,-4),s.bezierCurveTo(0,-4,-1,-18,-9,-36),s.moveTo(1,-4),s.bezierCurveTo(0,-4,1,-18,9,-36),s.lineStyle({width:1,color:14544639}),s.drawCircle(-4,-5,3),s.drawCircle(4,-5,3)}renderSegment(r,i){let n=this.renderSegmentBase(r);n.beginFill(14544639),n.drawCircle(0,0,7),n.drawPolygon(-2,5,2,5,0,18),n.endFill(),this.renderSegmentLegs(r,i)}renderSegmentBase(r){let i=new V;return this.segmentsGfx.addChild(i),i.rotation=r.position.radians,i.position.x=r.position.x,i.position.y=r.position.y,i}renderSegmentLegs(r,i){r.legs.left.forEach(s=>this.renderLeg(s,i==="left")),r.legs.right.forEach(s=>this.renderLeg(s,i==="right"))}renderLeg(r,i){let s=r[0],n=r.length>=2?r[1]:null,o=r.length>=2?r[2]:r[1],a=new V;this.legsGfx.addChild(a);let h=i?11189196:8952234;a.lineStyle({width:1,color:h}),a.moveTo(s.x,s.y),n!=null?(a.lineTo(n.x,n.y),a.lineStyle({width:0}),a.beginFill(h),a.drawPolygon(n.x-1.5,n.y,n.x+1.5,n.y,o.x,o.y),a.endFill()):(a.lineTo(o.x,o.y),a.lineStyle({width:0}))}};var kt=xt(Mt());var Xn=10040064,Ia=class extends yt{constructor(r){super(r);this.segmentsGfx=new V;this.legsGfx=new V;this.targetColor=6697728,this.bug=new _t({stageRect:{x:0,y:0,width:r.view.width,height:r.view.height},segments:[{position:new kt.Point(0,-12)},{position:new kt.Point(0,10),legs:{left:[[new kt.Point(-7,-2),new kt.Point(-22,-29)],[new kt.Point(-7,0),new kt.Point(-32,-12)],[new kt.Point(-7,2),new kt.Point(-32,2)],[new kt.Point(-7,4),new kt.Point(-21,18)]],right:[[new kt.Point(7,-2),new kt.Point(22,-29)],[new kt.Point(7,0),new kt.Point(32,-12)],[new kt.Point(7,2),new kt.Point(32,2)],[new kt.Point(7,4),new kt.Point(21,18)]]}}],millisecondsPerStep:250,maxStepPx:16,maxDistractionPx:24,maxJigglePx:1}),this.background=new $t(this.app,3342336),this.background.render(),this.app.stage.addChild(this.targetGfx),this.app.stage.addChild(this.legsGfx),this.app.stage.addChild(this.segmentsGfx),this.updateTargetPattern()}render(r=0){let i=this.bug.tick({deltaMs:r,stageRect:{x:5,y:5,width:this.app.view.width-5,height:this.app.view.height-5}});this.bug.on("targetReached",this.handleTargetReached),this.clearGfx(),this.renderTarget(i.target),this.renderAllSegments(i)}changeTarget(r){super.changeTarget(r),this.bug.updateTarget(r)}destroy(){super.destroy(),this.clearGfx()}clearGfx(){super.clearGfx(),this.segmentsGfx.clear(),this.segmentsGfx.removeChildren(),this.legsGfx.clear(),this.legsGfx.removeChildren()}renderAllSegments(r){for(let i=r.segments.length-1;i>=0;i--)i===0?this.renderHead(r.segments[i]):this.renderSegment(r.segments[i],r.activeSide)}renderHead(r){let i=this.renderSegmentBase(r);i.beginFill(Xn),i.drawCircle(0,0,3),i.endFill(),i.lineStyle({width:.5,color:Xn}),i.moveTo(-1,-4),i.bezierCurveTo(0,-4,-1,-18,-9,-36),i.moveTo(1,-4),i.bezierCurveTo(0,-4,1,-18,9,-36),i.lineStyle({width:0}),i.beginFill(Xn),i.drawCircle(-3,-2,3),i.drawCircle(3,-2,3),i.endFill()}renderSegment(r,i){let s=this.renderSegmentBase(r);s.beginFill(Xn),s.drawCircle(0,0,9),s.drawPolygon(-2,9,2,9,0,24),s.endFill(),this.renderSegmentLegs(r,i)}renderSegmentBase(r){let i=new V;return this.segmentsGfx.addChild(i),i.rotation=r.position.radians,i.position.x=r.position.x,i.position.y=r.position.y,i}renderSegmentLegs(r,i){r.legs.left.forEach(s=>this.renderLeg(s,i==="left")),r.legs.right.forEach(s=>this.renderLeg(s,i==="right"))}renderLeg(r,i){let s=r[0],n=r.length>=2?r[1]:null,o=r.length>=2?r[2]:r[1],a=new V;this.legsGfx.addChild(a);let h=Xn;a.lineStyle({width:1,color:h}),a.moveTo(s.x,s.y),n!=null?(a.lineTo(n.x,n.y),a.lineStyle({width:0}),a.beginFill(h),a.drawPolygon(n.x-1.5,n.y,n.x+1.5,n.y,o.x,o.y),a.endFill()):(a.lineTo(o.x,o.y),a.lineStyle({width:0}))}};var jt=xt(Mt());var Ra=11188992,Ca=class extends yt{constructor(r){super(r);this.segmentsGfx=new V;this.legsGfx=new V;this.targetColor=10061824,this.bug=new _t({stageRect:{x:0,y:0,width:r.view.width,height:r.view.height},segments:[{position:new jt.Point(0,30),legs:{left:[[new jt.Point(-7,-2),new jt.Point(-42,-49)],[new jt.Point(-7,0),new jt.Point(-52,-18)],[new jt.Point(-7,2),new jt.Point(-42,18)],[new jt.Point(-7,4),new jt.Point(-41,48)]],right:[[new jt.Point(7,-2),new jt.Point(42,-49)],[new jt.Point(7,0),new jt.Point(52,-18)],[new jt.Point(7,2),new jt.Point(42,18)],[new jt.Point(7,4),new jt.Point(41,48)]]}}],millisecondsPerStep:1e3,maxStepPx:24,maxDistractionPx:18,maxJigglePx:1,timingFunction:"easeOutBack"}),this.background=new $t(this.app,4469504),this.background.render(),this.app.stage.addChild(this.targetGfx),this.app.stage.addChild(this.legsGfx),this.app.stage.addChild(this.segmentsGfx),this.updateTargetPattern()}render(r=0){let i=this.bug.tick({deltaMs:r,stageRect:{x:5,y:5,width:this.app.view.width-5,height:this.app.view.height-5}});this.bug.on("targetReached",this.handleTargetReached),this.clearGfx(),this.renderTarget(i.target),this.renderSegment(i.segments[0],i.activeSide)}changeTarget(r){super.changeTarget(r),this.bug.updateTarget(r)}destroy(){super.destroy(),this.clearGfx()}clearGfx(){super.clearGfx(),this.segmentsGfx.clear(),this.segmentsGfx.removeChildren(),this.legsGfx.clear(),this.legsGfx.removeChildren()}renderSegment(r,i){let s=this.renderSegmentBase(r);s.beginFill(Ra),s.drawCircle(0,0,7),s.drawPolygon(-2,7,2,7,0,14),s.drawPolygon(-1,-9,-5,-17,-3,-21),s.drawPolygon(1,-9,5,-17,3,-21),s.endFill(),s.lineStyle({width:1,color:Ra}),s.drawCircle(-3,-7,5),s.drawCircle(3,-7,5),this.renderSegmentLegs(r,i)}renderSegmentBase(r){let i=new V;return this.segmentsGfx.addChild(i),i.rotation=r.position.radians,i.position.x=r.position.x,i.position.y=r.position.y,i}renderSegmentLegs(r,i){r.legs.left.forEach(s=>this.renderLeg(s,i==="left")),r.legs.right.forEach(s=>this.renderLeg(s,i==="right"))}renderLeg(r,i){let s=r[0],n=r.length>=2?r[1]:null,o=r.length>=2?r[2]:r[1],a=new V;this.legsGfx.addChild(a);let h=Ra;a.lineStyle({width:.5,color:h}),n!=null&&(a.beginFill(Ra),a.drawPolygon(n.x-1,n.y-1,n.x+1,n.y+1,s.x,s.y),a.endFill(),a.moveTo(n.x,n.y)),a.lineTo(o.x,o.y),a.lineStyle({width:0})}};var Yt=xt(Mt());var Ma=7837952,Ba=class extends yt{constructor(r){super(r);this.segmentsGfx=new V;this.legsGfx=new V;this.targetColor=8952064,this.bug=new _t({stageRect:{x:0,y:0,width:r.view.width,height:r.view.height},segments:[{position:new Yt.Point(0,30),legs:{left:[[new Yt.Point(-7,-2),new Yt.Point(-28,-28)],[new Yt.Point(-7,0),new Yt.Point(-36,-10)],[new Yt.Point(-7,2),new Yt.Point(-32,10)],[new Yt.Point(-7,4),new Yt.Point(-22,24)]],right:[[new Yt.Point(7,-2),new Yt.Point(28,-28)],[new Yt.Point(7,0),new Yt.Point(36,-10)],[new Yt.Point(7,2),new Yt.Point(32,10)],[new Yt.Point(7,4),new Yt.Point(22,24)]]}}],millisecondsPerStep:150,maxStepPx:16,maxDistractionPx:24,maxJigglePx:0}),this.background=new $t(this.app,2241280),this.background.render(),this.app.stage.addChild(this.targetGfx),this.app.stage.addChild(this.legsGfx),this.app.stage.addChild(this.segmentsGfx),this.updateTargetPattern()}render(r=0){let i=this.bug.tick({deltaMs:r,stageRect:{x:5,y:5,width:this.app.view.width-5,height:this.app.view.height-5}});this.bug.on("targetReached",this.handleTargetReached),this.clearGfx(),this.renderTarget(i.target),this.renderSegment(i.segments[0],i.activeSide)}changeTarget(r){super.changeTarget(r),this.bug.updateTarget(r)}destroy(){super.destroy(),this.clearGfx()}clearGfx(){super.clearGfx(),this.segmentsGfx.clear(),this.segmentsGfx.removeChildren(),this.legsGfx.clear(),this.legsGfx.removeChildren()}renderSegment(r,i){let s=this.renderSegmentBase(r);s.beginFill(Ma),s.drawCircle(0,0,7),s.drawPolygon(-2,7,2,7,0,14),s.drawPolygon(-1,-9,-5,-13,-3,-17),s.drawPolygon(1,-9,5,-13,3,-17),s.endFill(),s.lineStyle({width:1,color:Ma}),s.drawCircle(-3,-7,5),s.drawCircle(3,-7,5),this.renderSegmentLegs(r,i)}renderSegmentBase(r){let i=new V;return this.segmentsGfx.addChild(i),i.rotation=r.position.radians,i.position.x=r.position.x,i.position.y=r.position.y,i}renderSegmentLegs(r,i){r.legs.left.forEach(s=>this.renderLeg(s,i==="left")),r.legs.right.forEach(s=>this.renderLeg(s,i==="right"))}renderLeg(r,i){let s=r[0],n=r.length>=2?r[1]:null,o=r.length>=2?r[2]:r[1],a=new V;this.legsGfx.addChild(a);let h=Ma;a.lineStyle({width:1,color:h}),n!=null&&(a.beginFill(Ma),a.drawPolygon(n.x,n.y,n.x+2,n.y+2,s.x,s.y),a.endFill(),a.moveTo(n.x,n.y)),a.lineTo(o.x,o.y),a.lineStyle({width:0})}};var Ye=xt(Mt());var np=532544,F_=6724027,ws=2648184,Da=class extends yt{constructor(r){super(r);this.segmentsGfx=new V;this.legsGfx=new V;this.targetColor=F_,this.bug=new _t({stageRect:{x:0,y:0,width:r.view.width,height:r.view.height},segments:[{position:new Ye.Point(0,0)},{position:new Ye.Point(0,10),legs:{left:[[new Ye.Point(-7,-2),new Ye.Point(-18,-28)],[new Ye.Point(7,0),new Ye.Point(56,0)],[new Ye.Point(-7,4),new Ye.Point(-22,12)]],right:[[new Ye.Point(-7,0),new Ye.Point(-26,-10)]]}}],millisecondsPerStep:350,maxStepPx:16,maxDistractionPx:24,maxJigglePx:3}),this.background=new $t(this.app,np),this.background.render(),this.app.stage.addChild(this.targetGfx),this.app.stage.addChild(this.legsGfx),this.app.stage.addChild(this.segmentsGfx),this.updateTargetPattern()}render(r=0){let i=this.bug.tick({deltaMs:r,stageRect:{x:5,y:5,width:this.app.view.width-5,height:this.app.view.height-5}});this.bug.on("targetReached",this.handleTargetReached),this.clearGfx(),this.renderTarget(i.target),this.renderAllSegments(i)}changeTarget(r){super.changeTarget(r),this.bug.updateTarget(r)}destroy(){super.destroy(),this.clearGfx()}clearGfx(){super.clearGfx(),this.segmentsGfx.clear(),this.segmentsGfx.removeChildren(),this.legsGfx.clear(),this.legsGfx.removeChildren()}renderAllSegments(r){for(let i=r.segments.length-1;i>=0;i--)i===0?this.renderHead(r.segments[i]):this.renderSegment(r.segments[i],r.activeSide)}renderHead(r){let i=this.renderSegmentBase(r);i.beginFill(ws),i.drawCircle(3,2,5),i.endFill(),i.lineStyle({width:.5,color:ws}),i.moveTo(2,-10),i.bezierCurveTo(-8,-41,0,-41,-16,-41),i.moveTo(2,-10),i.bezierCurveTo(42,-37,0,-37,42,-37),i.beginFill(np),i.lineStyle({width:2,color:ws}),i.drawCircle(0,-7,3),i.drawCircle(5,-5,3),i.endFill()}renderSegment(r,i){let s=this.renderSegmentBase(r);s.beginFill(ws),s.drawCircle(0,0,7),s.drawPolygon(2,3,-2,3,-5,13,5,17,-2,13),s.endFill(),this.renderSegmentLegs(r,i)}renderSegmentBase(r){let i=new V;return this.segmentsGfx.addChild(i),i.rotation=r.position.radians,i.position.x=r.position.x,i.position.y=r.position.y,i}renderSegmentLegs(r,i){r.legs.left.forEach(s=>this.renderLeg(s,i==="left")),r.legs.right.forEach(s=>this.renderLeg(s,i==="right"))}renderLeg(r,i){let s=r[0],n=r.length>=2?r[1]:null,o=r.length>=2?r[2]:r[1],a=new V;this.legsGfx.addChild(a);let h=ws,l=i?4:2;a.lineStyle({width:1,color:h}),a.moveTo(s.x,s.y),n!=null?(a.lineTo(n.x,n.y),a.beginFill(ws),a.drawPolygon(n.x,n.y,n.x+l,n.y+l,o.x,o.y),a.endFill()):a.lineTo(o.x,o.y)}};var Ot=xt(Mt());var Vn=9445520,L_=3149872,N_=7348336,op=[5,10,9,10,8,9,11];function zn(){return{left:[[new Ot.Point(-7,-2),new Ot.Point(-24,-14)],[new Ot.Point(-7,2),new Ot.Point(-24,3)]],right:[[new Ot.Point(7,-2),new Ot.Point(24,-14)],[new Ot.Point(7,2),new Ot.Point(24,3)]]}}var Oa=class extends yt{constructor(r){super(r);this.segmentsGfx=new V;this.legsGfx=new V;this.targetColor=N_,this.bug=new _t({stageRect:{x:0,y:0,width:r.view.width,height:r.view.height},segments:[{position:new Ot.Point(0,0)},{position:new Ot.Point(0,15),legs:zn()},{position:new Ot.Point(0,15),legs:zn()},{position:new Ot.Point(0,15),legs:zn()},{position:new Ot.Point(0,15),legs:zn()},{position:new Ot.Point(0,15),legs:zn()},{position:new Ot.Point(0,15)},{position:new Ot.Point(0,12)},{position:new Ot.Point(0,9)},{position:new Ot.Point(0,6)},{position:new Ot.Point(0,3)}],millisecondsPerStep:180,maxStepPx:16,maxDistractionPx:12,maxJigglePx:2}),this.background=new $t(this.app,L_),this.background.render(),this.app.stage.addChild(this.targetGfx),this.app.stage.addChild(this.legsGfx),this.app.stage.addChild(this.segmentsGfx),this.updateTargetPattern()}render(r=0){let i=this.bug.tick({deltaMs:r,stageRect:{x:5,y:5,width:this.app.view.width-5,height:this.app.view.height-5}});this.bug.on("targetReached",this.handleTargetReached),this.clearGfx(),this.renderTarget(i.target),this.renderAllSegments(i)}changeTarget(r){super.changeTarget(r),this.bug.updateTarget(r)}destroy(){super.destroy(),this.clearGfx()}clearGfx(){super.clearGfx(),this.segmentsGfx.clear(),this.segmentsGfx.removeChildren(),this.legsGfx.clear(),this.legsGfx.removeChildren()}renderAllSegments(r){for(let i=r.segments.length-1;i>=0;i--)this.renderSegment(r.segments[i],r.activeSide,i)}renderHead(r,i){r.beginFill(Vn),r.drawCircle(0,-2,5),r.endFill(),r.lineStyle({width:.5,color:Vn}),r.moveTo(-1,-7),r.bezierCurveTo(0,-7,-5,-56,-39,-66),r.moveTo(1,-7),r.bezierCurveTo(0,-7,5,-56,39,-66),r.lineStyle({width:1,color:Vn}),r.drawCircle(-3,-7,5),r.drawCircle(3,-7,5)}renderSegment(r,i,s){let n=this.renderSegmentBase(r);if(n.beginFill(Vn),s===0)this.renderHead(n,r);else if(s<6)n.drawEllipse(0,0,op[s],op[s]*1.5),this.renderSegmentLegs(r,i);else if(s>=6){let o=(15-(s-6)*3)*.5;n.drawPolygon(-(o-1),-o,o-1,-o,o-1.5,o,-(o-1.5),o)}n.endFill()}renderSegmentBase(r){let i=new V;return this.segmentsGfx.addChild(i),i.rotation=r.position.radians,i.position.x=r.position.x,i.position.y=r.position.y,i}renderSegmentLegs(r,i){r.legs.left.forEach(s=>this.renderLeg(s,i==="left")),r.legs.right.forEach(s=>this.renderLeg(s,i==="right"))}renderLeg(r,i){let s=r[0],n=r.length>=2?r[1]:null,o=r.length>=2?r[2]:r[1],a=new V;this.legsGfx.addChild(a);let h=Vn;a.lineStyle({width:1,color:h}),a.moveTo(s.x,s.y),n!=null?(a.lineTo(n.x,n.y),a.lineStyle({width:0}),a.beginFill(h),a.drawPolygon(n.x-1.5,n.y,n.x+1.5,n.y,o.x,o.y),a.endFill()):(a.lineTo(o.x,o.y),a.lineStyle({width:0}))}};var Ft=xt(Mt());var Wn=3149872,U_=9445520,G_=3149872,ap=[5,10,9,10,8,9,11];function $n(){return{left:[[new Ft.Point(-7,-2),new Ft.Point(-24,-14)],[new Ft.Point(-7,2),new Ft.Point(-24,3)]],right:[[new Ft.Point(7,-2),new Ft.Point(24,-14)],[new Ft.Point(7,2),new Ft.Point(24,3)]]}}var Fa=class extends yt{constructor(r){super(r);this.segmentsGfx=new V;this.legsGfx=new V;this.targetColor=G_,this.bug=new _t({stageRect:{x:0,y:0,width:r.view.width,height:r.view.height},segments:[{position:new Ft.Point(0,0)},{position:new Ft.Point(0,15),legs:$n()},{position:new Ft.Point(0,15),legs:$n()},{position:new Ft.Point(0,15),legs:$n()},{position:new Ft.Point(0,15),legs:$n()},{position:new Ft.Point(0,15),legs:$n()},{position:new Ft.Point(0,15)},{position:new Ft.Point(0,12)},{position:new Ft.Point(0,9)},{position:new Ft.Point(0,6)},{position:new Ft.Point(0,3)}],millisecondsPerStep:180,maxStepPx:16,maxDistractionPx:12,maxJigglePx:2}),this.background=new $t(this.app,U_),this.background.render(),this.app.stage.addChild(this.targetGfx),this.app.stage.addChild(this.legsGfx),this.app.stage.addChild(this.segmentsGfx),this.updateTargetPattern()}render(r=0){let i=this.bug.tick({deltaMs:r,stageRect:{x:5,y:5,width:this.app.view.width-5,height:this.app.view.height-5}});this.bug.on("targetReached",this.handleTargetReached),this.clearGfx(),this.renderTarget(i.target),this.renderAllSegments(i)}changeTarget(r){super.changeTarget(r),this.bug.updateTarget(r)}destroy(){super.destroy(),this.clearGfx()}clearGfx(){super.clearGfx(),this.segmentsGfx.clear(),this.segmentsGfx.removeChildren(),this.legsGfx.clear(),this.legsGfx.removeChildren()}renderAllSegments(r){for(let i=r.segments.length-1;i>=0;i--)this.renderSegment(r.segments[i],r.activeSide,i)}renderHead(r){r.lineStyle({width:1,color:Wn}),r.drawCircle(0,-2,5),r.lineStyle({width:.5,color:Wn}),r.moveTo(-1,-7),r.bezierCurveTo(0,-7,-5,-56,-39,-66),r.moveTo(1,-7),r.bezierCurveTo(0,-7,5,-56,39,-66),r.lineStyle({width:1,color:Wn}),r.drawCircle(-3,-7,5),r.drawCircle(3,-7,5)}renderSegment(r,i,s){let n=this.renderSegmentBase(r);if(n.lineStyle({width:1,color:Wn}),s===0)this.renderHead(n);else if(s<6)n.drawEllipse(0,0,ap[s],ap[s]*1.5),this.renderSegmentLegs(r,i);else if(s>=6){let o=(15-(s-6)*3)*.5;n.drawPolygon(-(o-1),-o,o-1,-o,o-1.5,o,-(o-1.5),o)}}renderSegmentBase(r){let i=new V;return this.segmentsGfx.addChild(i),i.rotation=r.position.radians,i.position.x=r.position.x,i.position.y=r.position.y,i}renderSegmentLegs(r,i){r.legs.left.forEach(s=>this.renderLeg(s,i==="left")),r.legs.right.forEach(s=>this.renderLeg(s,i==="right"))}renderLeg(r,i){let s=r[0],n=r.length>=2?r[1]:null,o=r.length>=2?r[2]:r[1],a=new V;this.legsGfx.addChild(a);let h=Wn;a.lineStyle({width:1,color:h}),a.moveTo(s.x,s.y),n!=null?(a.lineTo(n.x,n.y),a.lineStyle({width:0}),a.beginFill(h),a.drawPolygon(n.x-1.5,n.y,n.x+1.5,n.y,o.x,o.y),a.endFill()):(a.lineTo(o.x,o.y),a.lineStyle({width:0}))}};var Lt=xt(Mt());var k_=532544,H_=6724027,jn=2648184,qr=[5,10,9,10,8,9,11];function Yn(){return{left:[[new Lt.Point(-7,-2),new Lt.Point(-24,-14)],[new Lt.Point(-7,2),new Lt.Point(-24,3)]],right:[[new Lt.Point(7,-2),new Lt.Point(24,-14)],[new Lt.Point(7,2),new Lt.Point(24,3)]]}}var La=class extends yt{constructor(r){super(r);this.segmentsGfx=new V;this.legsGfx=new V;this.targetColor=H_,this.bug=new _t({stageRect:{x:0,y:0,width:r.view.width,height:r.view.height},segments:[{position:new Lt.Point(0,0)},{position:new Lt.Point(0,15),legs:Yn()},{position:new Lt.Point(0,15),legs:Yn()},{position:new Lt.Point(0,15),legs:Yn()},{position:new Lt.Point(0,15),legs:Yn()},{position:new Lt.Point(0,15),legs:Yn()},{position:new Lt.Point(0,15)},{position:new Lt.Point(0,12)},{position:new Lt.Point(0,9)},{position:new Lt.Point(0,6)},{position:new Lt.Point(0,3)}],millisecondsPerStep:180,maxStepPx:16,maxDistractionPx:12,maxJigglePx:2}),this.background=new $t(this.app,k_),this.background.render(),this.app.stage.addChild(this.targetGfx),this.app.stage.addChild(this.legsGfx),this.app.stage.addChild(this.segmentsGfx),this.updateTargetPattern()}render(r=0){let i=this.bug.tick({deltaMs:r,stageRect:{x:5,y:5,width:this.app.view.width-5,height:this.app.view.height-5}});this.bug.on("targetReached",this.handleTargetReached),this.clearGfx(),this.renderTarget(i.target),this.renderAllSegments(i)}changeTarget(r){super.changeTarget(r),this.bug.updateTarget(r)}destroy(){super.destroy(),this.clearGfx()}clearGfx(){super.clearGfx(),this.segmentsGfx.clear(),this.segmentsGfx.removeChildren(),this.legsGfx.clear(),this.legsGfx.removeChildren()}renderAllSegments(r){for(let i=r.segments.length-1;i>=0;i--)this.renderSegment(r.segments[i],r.activeSide,i)}renderHead(r){r.lineStyle({width:1,color:jn}),r.moveTo(-4,-6),r.lineTo(4,6),r.moveTo(4,-6),r.lineTo(-4,6),r.lineStyle({width:.5,color:jn}),r.moveTo(2,-13),r.lineTo(-19,-56),r.lineTo(-39,-66),r.moveTo(-2,-13),r.lineTo(19,-56),r.lineTo(39,-66),r.lineStyle({width:0}),r.beginFill(jn),r.drawCircle(-6,-10,5),r.drawCircle(6,-10,5),r.endFill()}renderSegment(r,i,s){let n=this.renderSegmentBase(r);if(n.lineStyle({width:1,color:jn}),s===0)this.renderHead(n);else if(s<6)n.moveTo(-qr[s],-qr[s]),n.lineTo(qr[s],qr[s]),n.moveTo(qr[s],-qr[s]),n.lineTo(-qr[s],qr[s]),this.renderSegmentLegs(r,i);else if(s>=6){let o=(15-(s-6)*3)*.5;n.moveTo(-o,-o),n.lineTo(o,o),n.moveTo(o,-o),n.lineTo(-o,o)}}renderSegmentBase(r){let i=new V;return this.segmentsGfx.addChild(i),i.rotation=r.position.radians,i.position.x=r.position.x,i.position.y=r.position.y,i}renderSegmentLegs(r,i){r.legs.left.forEach(s=>this.renderLeg(s,i==="left")),r.legs.right.forEach(s=>this.renderLeg(s,i==="right"))}renderLeg(r,i){let s=r[0],n=r.length>=2?r[1]:null,o=r.length>=2?r[2]:r[1],a=new V;this.legsGfx.addChild(a);let h=jn;a.lineStyle({width:1,color:h}),a.moveTo(s.x,s.y),n!=null?(a.lineTo(n.x,n.y),a.lineStyle({width:0}),a.beginFill(h),a.drawPolygon(n.x-1.5,n.y,n.x+1.5,n.y,o.x,o.y),a.endFill()):(a.lineTo(o.x,o.y),a.lineStyle({width:0}))}};var Na,Yl={demo:Ea,bug001:Sa,bug002:Aa,bug003:Pa,bug004:Ia,bug005:Ca,bug006:Ba,bug007:Da,bug008:Oa,bug009:Fa,bug010:La},ql=class{constructor(t){this.playing=!1;this.bugs=Object.keys(Yl).reverse();this.bug=this.bugs[0];this.liveBug=null;this.handlePrevClick=()=>{let t=this.bugs.findIndex(r=>r===this.bug);t!==-1?(t-=1,t<0&&(t=this.bugs.length-1),(0,Kr.default)(`#!${this.bugs[t]}`)):(0,Kr.default)(`#!${this.bugs[0]}`)};this.handleNextClick=()=>{let t=this.bugs.findIndex(r=>r===this.bug);t!==-1?(t+=1,t>=this.bugs.length&&(t=0),(0,Kr.default)(`#!${this.bugs[t]}`)):(0,Kr.default)(`#!${this.bugs[0]}`)};this.togglePlaying=()=>{this.playing=!this.playing,this.playing?this.app.start():this.app.stop()};let r=document.querySelector(t);if(r instanceof HTMLElement)this.containerElement=r;else throw new Error('Canvas element "#bugs-canvas" not found.');this.bugs=this.bugs.slice(0,this.bugs.length-1),this.app=new xn({width:360,height:480}),this.initializePage(),this.appendToDom(),this.start()}initializePage(){(0,Kr.default)({hashbang:!0,window}),(0,Kr.default)(":id",({params:i})=>this.updateBug(i.id)),(0,Kr.default)("*",()=>this.updateBug(this.bugs[0])),window.location.hash.startsWith("#!")?this.updateBug(window.location.hash.substring(2)):this.updateBug(this.bugs[0]);let t=document.querySelector(".bugs__btn-prev"),r=document.querySelector(".bugs__btn-next");t!=null&&t.addEventListener("click",this.handlePrevClick),r!=null&&r.addEventListener("click",this.handleNextClick)}appendToDom(){this.containerElement.replaceChildren(this.app.view),this.containerElement.addEventListener("dblclick",this.togglePlaying)}updateBug(t){this.bug=t in Yl||t==="demo"?t:this.bugs[0],this.restart()}restart(){this.liveBug!=null&&this.liveBug.destroy(),this.liveBug=new Yl[this.bug](this.app),this.liveBug.render(),this.playing||(this.playing=!0,this.app.start())}start(){this.app.ticker.add(()=>{this.liveBug!=null&&this.liveBug.render(this.app.ticker.deltaMS)})}};function hp(e){Na=Na!=null?Na:new ql(e)}hp(".bugs__content");})();
/*! Bundled license information:

punycode/punycode.js:
  (*! https://mths.be/punycode v1.4.1 by @mathias *)
*/
//# sourceMappingURL=bugs.min.js.map
